<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title>memo</title>
  
  <link rel="stylesheet" href="asset/bootstrap-3.1.1-dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="asset/bootstrap-3.1.1-dist/css/bootstrap-theme.min.css">

  <link rel="stylesheet" href="./css/memo.css">

  <link  href="asset/vis/dist/vis.css" rel="stylesheet" type="text/css" />
  <script src="asset/vis/dist/vis.js"></script>
  <style type="text/css">
div.sourceLine, a.sourceLine { display: inline-block; min-height: 1.25em; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; }
@media print {
code.sourceCode { white-space: pre-wrap; }
div.sourceLine, a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource div.sourceLine, .numberSource a.sourceLine
  { position: relative; }
pre.numberSource div.sourceLine::before, .numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em; }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; color: #aaaaaa;  padding-left: 4px; }
@media screen {
a.sourceLine::before { text-decoration: underline; color: initial; }
}
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.bn { color: #40a070; } /* BaseN */
code span.fl { color: #40a070; } /* Float */
code span.ch { color: #4070a0; } /* Char */
code span.st { color: #4070a0; } /* String */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.ot { color: #007020; } /* Other */
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.fu { color: #06287e; } /* Function */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code span.cn { color: #880000; } /* Constant */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.ss { color: #bb6688; } /* SpecialString */
code span.im { } /* Import */
code span.va { color: #19177c; } /* Variable */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.op { color: #666666; } /* Operator */
code span.bu { } /* BuiltIn */
code span.ex { } /* Extension */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.at { color: #7d9029; } /* Attribute */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
</head>
<body>
<template id=varin>
<div class="form-group">
<label class="control-label col-xs-6">{{ label }}</label>
<div class="col-xs-6">
<p>&lt;input :id=label class=“form-control” :value=“value” v-on:input=“onInput” onClick=“this.select();” type=“text” /&gt;</p>
</div>
</div>
<p></template></p>
<ul class="nav flex-column menu">
<li class="nav-item" v-for="title in titles">
<a class="nav-link active" v-bind:href="'#'+title.href">{{ title.title }}</a>
</li>
</ul>
<h1 id="rust">Rust</h1>
<h2 id="cross-compile">cross compile</h2>
<h3 id="win64">win64</h3>
<h4 id="yum">yum</h4>
<pre class="sourceCode sh" id="cb1"><code class="sourceCode bash"><div class="sourceLine" id="cb1-1" data-line-number="1"><span class="fu">sudo</span> yum install -y mingw64-gcc</div>
<div class="sourceLine" id="cb1-2" data-line-number="2"><span class="fu">sudo</span> yum install -y mingw64-winpthreads-static</div>
<div class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># ??? sudo yum install -y glibc-static</span></div></code></pre>
<h4 id="cargoconfig">~/.cargo/config</h4>
<pre class="sourceCode sh" id="cb2"><code class="sourceCode bash"><div class="sourceLine" id="cb2-1" data-line-number="1">[<span class="ex">target.x86_64-pc-windows-gnu</span>]</div>
<div class="sourceLine" id="cb2-2" data-line-number="2"><span class="ex">linker</span> = <span class="st">&quot;/usr/bin/x86_64-w64-mingw32-gcc&quot;</span></div></code></pre>
<h4 id="add-target">ADD TARGET</h4>
<pre class="sourceCode sh" id="cb3"><code class="sourceCode bash"><div class="sourceLine" id="cb3-1" data-line-number="1"><span class="ex">rustup</span> target add x86_64-pc-windows-gnu</div></code></pre>
<h4 id="build">BUILD</h4>
<pre class="sourceCode sh" id="cb4"><code class="sourceCode bash"><div class="sourceLine" id="cb4-1" data-line-number="1"><span class="ex">cargo</span> build --target x86_64-pc-windows-gnu</div></code></pre>
<h1 id="appium">Appium</h1>
<h2 id="windows-application-driver">Windows Application Driver</h2>
<h3 id="install">Install</h3>
<pre class="sourceCode sh" id="cb5"><code class="sourceCode bash"><div class="sourceLine" id="cb5-1" data-line-number="1"><span class="ex">msiexec</span> /i WindowsApplicationDriver.msi /q</div>
<div class="sourceLine" id="cb5-2" data-line-number="2"><span class="ex">setx</span> /M PATH <span class="st">&quot;%PATH%;C:\Program Files (x86)\Windows Application Driver&quot;</span></div></code></pre>
<h3 id="run">Run</h3>
<p>Settings &gt; Update &amp; Security &gt; For Developers</p>
<h4 id="new-prompt">New Prompt</h4>
<pre class="sourceCode sh" id="cb6"><code class="sourceCode bash"><div class="sourceLine" id="cb6-1" data-line-number="1"><span class="ex">WinAppDriver.exe</span></div></code></pre>
<h2 id="appium-python-client">Appium-Python-Client</h2>
<h3 id="install-1">Install</h3>
<pre class="sourceCode sh" id="cb7"><code class="sourceCode bash"><div class="sourceLine" id="cb7-1" data-line-number="1"><span class="ex">python-3.6.2-amd64.exe</span> /install /quiet</div>
<div class="sourceLine" id="cb7-2" data-line-number="2"><span class="ex">setx</span> /M PATH <span class="st">&quot;%PATH%;C:\Users\IEUser\AppData\Local\Programs\Python\Python36\Scripts</span><span class="dt">\&quot;</span></div>
<div class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">setx /M PATH &quot;</span>%PATH%<span class="kw">;</span><span class="ex">C</span>:\Users\IEUser\AppData\Local\Programs\Python\Python36<span class="dt">\&quot;</span></div></code></pre>
<h4 id="new-prompt-1">New Prompt</h4>
<pre class="sourceCode sh" id="cb8"><code class="sourceCode bash"><div class="sourceLine" id="cb8-1" data-line-number="1"><span class="ex">pip</span> install Appium-Python-Client</div></code></pre>
<h2 id="test">TEST</h2>
<h3 id="notepad.exe">notepad.exe</h3>
<pre class="sourceCode py" id="cb9"><code class="sourceCode python"><div class="sourceLine" id="cb9-1" data-line-number="1"><span class="im">import</span> unittest</div>
<div class="sourceLine" id="cb9-2" data-line-number="2"><span class="im">from</span> appium <span class="im">import</span> webdriver</div>
<div class="sourceLine" id="cb9-3" data-line-number="3"><span class="im">from</span> selenium.webdriver.common.keys <span class="im">import</span> Keys</div>
<div class="sourceLine" id="cb9-4" data-line-number="4"></div>
<div class="sourceLine" id="cb9-5" data-line-number="5"></div>
<div class="sourceLine" id="cb9-6" data-line-number="6"><span class="kw">class</span> NotepadTests(unittest.TestCase):</div>
<div class="sourceLine" id="cb9-7" data-line-number="7"></div>
<div class="sourceLine" id="cb9-8" data-line-number="8">    <span class="kw">def</span> setUp(<span class="va">self</span>):</div>
<div class="sourceLine" id="cb9-9" data-line-number="9">        desired_caps <span class="op">=</span> {}</div>
<div class="sourceLine" id="cb9-10" data-line-number="10">        desired_caps[<span class="st">&quot;app&quot;</span>] <span class="op">=</span> <span class="st">&quot;C:</span><span class="ch">\\</span><span class="st">Windows</span><span class="ch">\\</span><span class="st">System32</span><span class="ch">\\</span><span class="st">notepad.exe&quot;</span></div>
<div class="sourceLine" id="cb9-11" data-line-number="11">        <span class="va">self</span>.driver <span class="op">=</span> webdriver.Remote(command_executor<span class="op">=</span><span class="st">&#39;http://127.0.0.1:4723&#39;</span>, desired_capabilities<span class="op">=</span>desired_caps)</div>
<div class="sourceLine" id="cb9-12" data-line-number="12">        <span class="va">self</span>.driver.find_element_by_name(<span class="st">&#39;Maximize&#39;</span>).click()</div>
<div class="sourceLine" id="cb9-13" data-line-number="13"></div>
<div class="sourceLine" id="cb9-14" data-line-number="14">    <span class="kw">def</span> tearDown(<span class="va">self</span>):</div>
<div class="sourceLine" id="cb9-15" data-line-number="15">        <span class="va">self</span>.driver.quit()</div>
<div class="sourceLine" id="cb9-16" data-line-number="16"></div>
<div class="sourceLine" id="cb9-17" data-line-number="17">    <span class="kw">def</span> test_01_01_01_helpmenu(<span class="va">self</span>):</div>
<div class="sourceLine" id="cb9-18" data-line-number="18">        <span class="va">self</span>.driver.find_element_by_name(<span class="st">&quot;Help&quot;</span>).click()</div>
<div class="sourceLine" id="cb9-19" data-line-number="19">        <span class="va">self</span>.driver.find_element_by_name(<span class="st">&quot;About Notepad&quot;</span>).click()</div>
<div class="sourceLine" id="cb9-20" data-line-number="20">        <span class="va">self</span>.driver.save_screenshot(<span class="st">&quot;evi/about.png&quot;</span>)</div>
<div class="sourceLine" id="cb9-21" data-line-number="21">        <span class="va">self</span>.driver.find_element_by_name(<span class="st">&quot;OK&quot;</span>).click()</div>
<div class="sourceLine" id="cb9-22" data-line-number="22"></div>
<div class="sourceLine" id="cb9-23" data-line-number="23">    <span class="kw">def</span> test_01_02_01_textinput(<span class="va">self</span>):</div>
<div class="sourceLine" id="cb9-24" data-line-number="24">        inputdata <span class="op">=</span> <span class="st">&#39;hello automation&#39;</span></div>
<div class="sourceLine" id="cb9-25" data-line-number="25">        <span class="va">self</span>.driver.find_element_by_name(<span class="st">&#39;Text Editor&#39;</span>).send_keys(inputdata)</div>
<div class="sourceLine" id="cb9-26" data-line-number="26">        <span class="va">self</span>.driver.save_screenshot(<span class="st">&quot;evi/type.png&quot;</span>)</div>
<div class="sourceLine" id="cb9-27" data-line-number="27">        result <span class="op">=</span> <span class="bu">str</span>(<span class="va">self</span>.driver.find_element_by_name(<span class="st">&#39;Text Editor&#39;</span>).get_attribute(<span class="st">&#39;Value.Value&#39;</span>))</div>
<div class="sourceLine" id="cb9-28" data-line-number="28">        <span class="va">self</span>.driver.find_element_by_name(<span class="st">&#39;Text Editor&#39;</span>).clear()</div>
<div class="sourceLine" id="cb9-29" data-line-number="29">        <span class="va">self</span>.assertEqual(result, inputdata)</div>
<div class="sourceLine" id="cb9-30" data-line-number="30"></div>
<div class="sourceLine" id="cb9-31" data-line-number="31"></div>
<div class="sourceLine" id="cb9-32" data-line-number="32"><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&#39;__main__&#39;</span>:</div>
<div class="sourceLine" id="cb9-33" data-line-number="33">    suite <span class="op">=</span> unittest.TestLoader().loadTestsFromTestCase(NotepadTests)</div>
<div class="sourceLine" id="cb9-34" data-line-number="34">    unittest.TextTestRunner(verbosity<span class="op">=</span><span class="dv">2</span>).run(suite)</div></code></pre>
<h1 id="selenium">selenium</h1>
<h2 id="install-2">install</h2>
<h3 id="selenium-1">selenium</h3>
<pre class="sourceCode sh" id="cb10"><code class="sourceCode bash"><div class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># pip</span></div>
<div class="sourceLine" id="cb10-2" data-line-number="2"><span class="fu">sudo</span> apt-get install python-pip</div>
<div class="sourceLine" id="cb10-3" data-line-number="3"><span class="co"># selenium</span></div>
<div class="sourceLine" id="cb10-4" data-line-number="4"><span class="fu">sudo</span> pip install selenium</div></code></pre>
<h3 id="webdriver">WebDriver</h3>
<p>ブラウザごとに実行環境に合うものをダウンロードして、$PATH にコピーする。</p>
<h2 id="hello-world">hello world</h2>
<pre class="sourceCode py" id="cb11"><code class="sourceCode python"><div class="sourceLine" id="cb11-1" data-line-number="1"><span class="co">#!/usr/bin/env python</span></div>
<div class="sourceLine" id="cb11-2" data-line-number="2"></div>
<div class="sourceLine" id="cb11-3" data-line-number="3"><span class="im">from</span> selenium <span class="im">import</span> webdriver</div>
<div class="sourceLine" id="cb11-4" data-line-number="4"></div>
<div class="sourceLine" id="cb11-5" data-line-number="5">browser <span class="op">=</span> webdriver.Firefox()</div>
<div class="sourceLine" id="cb11-6" data-line-number="6">browser.get(<span class="st">&#39;http://www.ubuntu.com/&#39;</span>)</div></code></pre>
<h1 id="clamav">CLAMAV</h1>
<h2 id="hand-scan">hand scan</h2>
<pre class="sourceCode sh" id="cb12"><code class="sourceCode bash"><div class="sourceLine" id="cb12-1" data-line-number="1"><span class="fu">sudo</span> clamscan --infected --remove --recursive ./</div></code></pre>
<h1 id="vsrx">vSRX</h1>
<pre class="sourceCode sh" id="cb13"><code class="sourceCode bash"><div class="sourceLine" id="cb13-1" data-line-number="1"><span class="ex">vagrant</span> plugin install vagrant-junos</div>
<div class="sourceLine" id="cb13-2" data-line-number="2"><span class="ex">vagrant</span> plugin install vagrant-host-shell</div></code></pre>
<p>ffi のコンパイルがどうのと出たら</p>
<pre class="sourceCode sh" id="cb14"><code class="sourceCode bash"><div class="sourceLine" id="cb14-1" data-line-number="1"><span class="fu">sudo</span> apt-get install ruby-dev</div></code></pre>
<h4 id="vagrantfile">Vagrantfile</h4>
<pre class="sourceCode ruby" id="cb15"><code class="sourceCode ruby"><div class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># -*- mode: ruby -*-</span></div>
<div class="sourceLine" id="cb15-2" data-line-number="2"><span class="co"># vi: set ft=ruby :</span></div>
<div class="sourceLine" id="cb15-3" data-line-number="3"><span class="dt">Vagrant</span>.configure(<span class="st">&quot;2&quot;</span>) <span class="kw">do</span> |config|</div>
<div class="sourceLine" id="cb15-4" data-line-number="4">  config.vm.box = <span class="st">&quot;juniper/vqfx10k-re&quot;</span></div>
<div class="sourceLine" id="cb15-5" data-line-number="5">  config.vm.box_check_update = <span class="dv">false</span></div>
<div class="sourceLine" id="cb15-6" data-line-number="6">  config.ssh.insert_key = <span class="dv">false</span></div>
<div class="sourceLine" id="cb15-7" data-line-number="7"><span class="kw">end</span></div></code></pre>
<h1 id="raid">RAID</h1>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-raid',data:{label:''
,hdd1: '/dev/sdd'
,hdd2: '/dev/sde'
,mdx:  '/dev/md1'
}});})</script>
<div id="app-raid">
<form class="form-horizontal">
<varin label="HDD-1"  v-model="hdd1"></varin> <varin label="HDD-2"  v-model="hdd2"></varin> <varin label="md no." v-model="mdx"></varin>
</form>
<h2 id="hdd-setup">HDD SETUP</h2>
<h3 id="parted">parted</h3>
<h4 id="hdd1">{{hdd1}}</h4>
<pre class="sourceCode sh" id="cb16"><code class="sourceCode bash"><div class="sourceLine" id="cb16-1" data-line-number="1"><span class="ex">parted</span> -s <span class="dt">{{hdd1}}</span> <span class="st">&quot;mklabel gpt&quot;</span></div>
<div class="sourceLine" id="cb16-2" data-line-number="2"><span class="ex">parted</span> -s <span class="dt">{{hdd1}}</span> <span class="st">&quot;mkpart primary 0% 100%&quot;</span></div>
<div class="sourceLine" id="cb16-3" data-line-number="3"><span class="ex">parted</span> -s <span class="dt">{{hdd1}}</span> <span class="st">&quot;set 1 raid on&quot;</span></div></code></pre>
<h4 id="hdd2">{{hdd2}}</h4>
<pre class="sourceCode sh" id="cb17"><code class="sourceCode bash"><div class="sourceLine" id="cb17-1" data-line-number="1"><span class="ex">parted</span> -s <span class="dt">{{hdd2}}</span> <span class="st">&quot;mklabel gpt&quot;</span></div>
<div class="sourceLine" id="cb17-2" data-line-number="2"><span class="ex">parted</span> -s <span class="dt">{{hdd2}}</span> <span class="st">&quot;mkpart primary 0% 100%&quot;</span></div>
<div class="sourceLine" id="cb17-3" data-line-number="3"><span class="ex">parted</span> -s <span class="dt">{{hdd2}}</span> <span class="st">&quot;set 1 raid on&quot;</span></div></code></pre>
<h2 id="make-raid">MAKE RAID</h2>
<h4 id="raid-1">RAID-1</h4>
<pre class="sourceCode sh" id="cb18"><code class="sourceCode bash"><div class="sourceLine" id="cb18-1" data-line-number="1"><span class="ex">mdadm</span> --create <span class="dt">{{mdx}}</span> --level=raid1 --raid-devices=2 <span class="dt">{{hdd1}}</span> <span class="dt">{{hdd2}}</span></div></code></pre>
<p>[y], [RET]</p>
<h2 id="check">CHECK</h2>
<pre class="sourceCode sh" id="cb19"><code class="sourceCode bash"><div class="sourceLine" id="cb19-1" data-line-number="1"><span class="ex">watch</span> -d -n 2 cat /proc/mdstat</div></code></pre>
<p>[UU] is OK</p>
</div>
<h1 id="vuecomponent">VueComponent</h1>
<script>window.addEventListener('load', function () {
new Vue({el:'#app1',data:{label:''
,input1: '$input1'
,input2: '$input2'
}});})</script>
<div id="app1">
<form class="form-horizontal">
<varin label="input1" v-model="input1"></varin> <varin label="input2" v-model="input2"></varin>
</form>
<h2 id="h2">h2</h2>
<pre><code>L1 is {{ input1 }}
L2 is {{ input2 }}</code></pre>
</div>
<h1 id="checksum">Checksum</h1>
<script>window.addEventListener('load', function () {
new Vue({el:'#Checksum', data: {label:''
,filename:'$FILENAME'
}});})</script>
<div id="Checksum">
<form class="form-horizontal">
<varin label="TARGET FILE NAME" v-model="filename"></varin>
</form>
<h4 id="on-windows">on Windows</h4>
<p>Apprication Control に手動追加するときに必要。</p>
<pre class="sourceCode bash" id="cb21"><code class="sourceCode bash"><div class="sourceLine" id="cb21-1" data-line-number="1"><span class="ex">certutil</span> -hashfile {{ filename }} <span class="ex">SHA1</span></div></code></pre>
<h4 id="on-linux">on Linux</h4>
<pre class="sourceCode bash" id="cb22"><code class="sourceCode bash"><div class="sourceLine" id="cb22-1" data-line-number="1"><span class="ex">md5sum</span> {{ filename }}</div></code></pre>
</div>
<h1 id="neo4j">neo4j</h1>
<pre class="sourceCode sql" id="cb23"><code class="sourceCode sql"><div class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">create</span> (a_san<span class="ch">:Person</span> { name:<span class="ot">&quot;Aさん&quot;</span>, 所属:<span class="ot">&quot;開発部&quot;</span>})</div>
<div class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw">create</span> (b_san<span class="ch">:Person</span> { name:<span class="ot">&quot;Bさん&quot;</span>, 所属:<span class="ot">&quot;経理部&quot;</span>})</div>
<div class="sourceLine" id="cb23-3" data-line-number="3"></div>
<div class="sourceLine" id="cb23-4" data-line-number="4"><span class="kw">create</span> (a_san)-[r:知ってる]-&gt;(b_san)</div>
<div class="sourceLine" id="cb23-5" data-line-number="5"></div>
<div class="sourceLine" id="cb23-6" data-line-number="6">match (a_san<span class="ch">:Person</span>),(b_san<span class="ch">:Person</span>)</div>
<div class="sourceLine" id="cb23-7" data-line-number="7"><span class="kw">where</span> a_san.name=<span class="ot">&quot;Aさん&quot;</span> <span class="kw">and</span> b_san.name=<span class="ot">&quot;Bさん&quot;</span></div>
<div class="sourceLine" id="cb23-8" data-line-number="8"><span class="kw">create</span> (a_san)-[r:知ってる]-&gt;(b_san)</div>
<div class="sourceLine" id="cb23-9" data-line-number="9"><span class="kw">return</span> r;</div></code></pre>
<h2 id="misk">misk</h2>
<p>いらんイメージ消して、docker 再起動したらいけた。謎。</p>
<pre><code>ERROR: for neo4j  Cannot start service neo4j: oci runtime error: process_linux.go:330: running prestart hook 0 caused &quot;fork/exec /usr/bin/dockerd (deleted): no such file or directory: &quot;</code></pre>
<h1 id="hecate">hecate</h1>
<pre class="sourceCode bash" id="cb25"><code class="sourceCode bash"><div class="sourceLine" id="cb25-1" data-line-number="1"><span class="ex">go</span> get -u github.com/evanmiller/hecate</div></code></pre>
<h1 id="postgres">POSTGRES</h1>
<h2 id="client">CLIENT</h2>
<h3 id="connect">CONNECT</h3>
<pre class="sourceCode bash" id="cb26"><code class="sourceCode bash"><div class="sourceLine" id="cb26-1" data-line-number="1"><span class="ex">psql</span> -h <span class="dt">{PG_SRV_ADDRESS}</span> -U <span class="dt">{PG_USER}</span></div></code></pre>
<h2 id="database">Database</h2>
<h3 id="list">list</h3>
<pre class="sourceCode sql" id="cb27"><code class="sourceCode sql"><div class="sourceLine" id="cb27-1" data-line-number="1">\l;</div></code></pre>
<h2 id="table">Table</h2>
<h3 id="list-1">list</h3>
<pre class="sourceCode sql" id="cb28"><code class="sourceCode sql"><div class="sourceLine" id="cb28-1" data-line-number="1">\dt;</div></code></pre>
<pre class="sourceCode sql" id="cb29"><code class="sourceCode sql"><div class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">select</span> table_name <span class="kw">from</span> INFORMATION_SCHEMA.tables;</div></code></pre>
<h2 id="view">View</h2>
<h3 id="list-2">list</h3>
<pre class="sourceCode sql" id="cb30"><code class="sourceCode sql"><div class="sourceLine" id="cb30-1" data-line-number="1">\dv;</div></code></pre>
<pre class="sourceCode sql" id="cb31"><code class="sourceCode sql"><div class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">select</span> table_name <span class="kw">from</span> INFORMATION_SCHEMA.views;</div></code></pre>
<h2 id="column-list">Column List</h2>
<pre class="sourceCode sql" id="cb32"><code class="sourceCode sql"><div class="sourceLine" id="cb32-1" data-line-number="1">\d {TABLENAME}</div></code></pre>
<h2 id="batch-file">Batch File</h2>
<pre class="sourceCode sql" id="cb33"><code class="sourceCode sql"><div class="sourceLine" id="cb33-1" data-line-number="1">\i {FILENAME.sql}</div></code></pre>
<h2 id="log">Log</h2>
<h4 id="varlibpostgresqldata">/var/lib/postgresql/data</h4>
<pre class="sourceCode sh" id="cb34"><code class="sourceCode bash"><div class="sourceLine" id="cb34-1" data-line-number="1"><span class="ex">log_statement</span> = <span class="st">&#39;all&#39;</span></div></code></pre>
<h1 id="syslog">SYSLOG</h1>
<pre class="sourceCode bash" id="cb35"><code class="sourceCode bash"><div class="sourceLine" id="cb35-1" data-line-number="1"><span class="dt">{COMMAND}</span> <span class="op">2&gt;&amp;1</span> <span class="kw">|</span> <span class="fu">tee</span> <span class="op">&gt;(</span><span class="ex">logger</span> -i -t <span class="st">&quot;{TAG}&quot;</span><span class="op">)</span></div></code></pre>
<h1 id="load">Load</h1>
<h2 id="cpu">CPU</h2>
<pre class="sourceCode bash" id="cb36"><code class="sourceCode bash"><div class="sourceLine" id="cb36-1" data-line-number="1"><span class="fu">yes</span> <span class="op">&gt;</span> /dev/null</div></code></pre>
<h2 id="disk">DISK</h2>
<pre class="sourceCode bash" id="cb37"><code class="sourceCode bash"><div class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">while</span> <span class="fu">true</span><span class="kw">;</span> <span class="kw">do</span> <span class="fu">dd</span> if=/dev/zero of=./tmpfile bs=1M count=1000<span class="kw">;</span> <span class="kw">done</span>; <span class="fu">rm</span> ./tmpfile</div></code></pre>
<h1 id="mozc">MOZC</h1>
<p>よくわからんが日本語入力できなくなったとき。</p>
<pre class="sourceCode bash" id="cb38"><code class="sourceCode bash"><div class="sourceLine" id="cb38-1" data-line-number="1"><span class="ex">/usr/lib/mozc/mozc_renderer</span> <span class="kw">&amp;</span></div></code></pre>
<h1 id="ufw">ufw</h1>
<h2 id="basics">BASICS</h2>
<p>デフォルトは無効 (ubuntu server 16.10) 。</p>
<p>有効化すると下記の状態となるため、クライアント運用は可能。</p>
<ul>
<li>deny (incoming) — 入力 NG</li>
<li>allow (outgoing) — 出力 OK</li>
<li>disabled (routed) — 転送 NG</li>
</ul>
<h3 id="su">su</h3>
<pre class="sourceCode bash" id="cb39"><code class="sourceCode bash"><div class="sourceLine" id="cb39-1" data-line-number="1"><span class="fu">sudo</span> su -</div></code></pre>
<h3 id="display-status">Display STATUS</h3>
<pre class="sourceCode bash" id="cb40"><code class="sourceCode bash"><div class="sourceLine" id="cb40-1" data-line-number="1"><span class="ex">ufw</span> status verbose</div></code></pre>
<h3 id="enabledisable">ENABLE/DISABLE</h3>
<pre class="sourceCode bash" id="cb41"><code class="sourceCode bash"><div class="sourceLine" id="cb41-1" data-line-number="1"><span class="ex">ufw</span> enable</div></code></pre>
<pre class="sourceCode bash" id="cb42"><code class="sourceCode bash"><div class="sourceLine" id="cb42-1" data-line-number="1"><span class="ex">ufw</span> disable</div></code></pre>
<h1 id="xmonad">XMONAD</h1>
<h2 id="mod-key-change">MOD Key Change</h2>
<h4 id="xmonad-1">.xmonad</h4>
<p>MOD to <a href="#windows-3">WINDOWS</a></p>
<pre class="sourceCode hs" id="cb43"><code class="sourceCode haskell"><div class="sourceLine" id="cb43-1" data-line-number="1">modMask <span class="fu">=</span> myModMask</div></code></pre>
<h4 id="xmodmap">.Xmodmap</h4>
<pre><code>! [caps]=[Windows] に
clear Lock
keycode  66 = Super_L</code></pre>
<pre class="sourceCode bash" id="cb45"><code class="sourceCode bash"><div class="sourceLine" id="cb45-1" data-line-number="1"><span class="fu">xmodmap</span> -e <span class="st">&quot;clear Lock&quot;</span></div>
<div class="sourceLine" id="cb45-2" data-line-number="2"><span class="fu">xmodmap</span> -e <span class="st">&quot;keycode  66 = Super_L&quot;</span></div></code></pre>
<h4 id="xinitrc">.xinitrc</h4>
<pre><code>xmodmap $HOME/.Xmodmap</code></pre>
<h2 id="dmenuランチャ">dmenu(ランチャ)</h2>
<h3 id="install-run">install &amp; run</h3>
<pre class="sourceCode bash" id="cb47"><code class="sourceCode bash"><div class="sourceLine" id="cb47-1" data-line-number="1"><span class="fu">sudo</span> apt-get search dmenu</div></code></pre>
<p>MOD + [P]</p>
<h2 id="設定更新">設定更新</h2>
<pre class="sourceCode bash" id="cb48"><code class="sourceCode bash"><div class="sourceLine" id="cb48-1" data-line-number="1"><span class="ex">xmonad</span> --recompile <span class="kw">&amp;&amp;</span> <span class="ex">xmonad</span> --restart</div></code></pre>
<h2 id="キーバインド">キーバインド</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">キーバインド</th>
<th style="text-align: center;">働き</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MOD + SHIFT + RET</td>
<td style="text-align: center;">新しいタイルにターミナルを開く</td>
</tr>
<tr class="even">
<td style="text-align: left;">MOD + [J]/[K]</td>
<td style="text-align: center;">タイルフォーカスを移動</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MOD + SHIFT + [J]/[K]</td>
<td style="text-align: center;">フォーカスタイルと隣接タイルと入れ替える</td>
</tr>
<tr class="even">
<td style="text-align: left;">MOD + [1]/…/[9]</td>
<td style="text-align: center;">仮想デスクトップを切り替える</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MOD + SPC</td>
<td style="text-align: center;">タイルのレイアウト方法を切り替える</td>
</tr>
</tbody>
</table>
<h1 id="github">github</h1>
<h2 id="command-graph">COMMAND GRAPH</h2>
<div id="gitgraph" style="width: 100%; height: 300px; border: 1px solid lightgray;">
<div id="graph-navigation_wrapper" style="position: absolute; width: 100%; height: 300px;">
<pre><code>&lt;div id=&quot;graph-navigation_zoomExtends&quot; class=&quot;graph-navigation zoomExtends&quot;&gt;
&lt;/div&gt;</code></pre>
</div>
<div class="graph-frame" style="position: relative; overflow: hidden; width: 100%; height: 100%;">
<pre><code>&lt;canvas style=&quot;position: relative; -webkit-user-select: none; -webkit-user-drag: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); width: 100%; height: 100%&quot;&gt;&lt;/canvas&gt;</code></pre>
</div>
</div>
<script type="text/javascript">
var gitcontainer = document.getElementById('gitgraph');
var gitdata = {dot: 'digraph { \
\
WORKING  [shape=box,   fontColor=black,color=orange]; \
STAGING  [shape=box,   fontColor=white,color=blue]; \
LOCAL    [shape=box,   fontColor=white,color=red]; \
REMORT   [shape=box,   fontColor=white,color=red]; \
\
WORKING -> ADD          -> STAGING ; \
STAGING -> COMMIT       -> LOCAL   ; \
LOCAL   -> PUSH         -> REMORT  ; \
LOCAL   -> RESET_COMMIT -> WORKING ; \
REMORT  -> FETCH        -> LOCAL   ; \
REMORT  -> PULL         -> LOCAL   ; \
           PULL         -> WORKING ; \
\
}'};
var gitgraph = new vis.Graph(gitcontainer, gitdata);
</script>
<h2 id="公開鍵を登録">公開鍵を登録</h2>
<p>テスト</p>
<pre class="sourceCode bash" id="cb51"><code class="sourceCode bash"><div class="sourceLine" id="cb51-1" data-line-number="1"><span class="fu">ssh</span> -T git@github.com</div>
<div class="sourceLine" id="cb51-2" data-line-number="2"><span class="ex">Hi</span> <span class="dt">{USERNAME}</span>! You<span class="st">&#39;ve successfully authenticated, but GitHub does not provide shell access.</span></div></code></pre>
<h2 id="remote-url-を変更">remote URL を変更</h2>
<p>変更方法</p>
<pre class="sourceCode bash" id="cb52"><code class="sourceCode bash"><div class="sourceLine" id="cb52-1" data-line-number="1"><span class="fu">git</span> remote set-url origin git@github.com:<span class="dt">{USER}:{REPOS.}</span></div></code></pre>
<p>確認方法</p>
<pre><code>git remote -v</code></pre>
<h2 id="remote-との比較">remote との比較</h2>
<pre class="sourceCode bash" id="cb54"><code class="sourceCode bash"><div class="sourceLine" id="cb54-1" data-line-number="1"><span class="fu">git</span> fetch origin <span class="kw">&amp;&amp;</span> <span class="fu">git</span> diff origin/master</div></code></pre>
<h2 id="マスター競合pull忘れ">マスター競合(PULL忘れ)</h2>
<p>単純マージ</p>
<pre class="sourceCode bash" id="cb55"><code class="sourceCode bash"><div class="sourceLine" id="cb55-1" data-line-number="1"><span class="fu">git</span> fetch <span class="kw">&amp;&amp;</span> <span class="fu">git</span> merge origin/master</div></code></pre>
<h2 id="最終コミットまで戻す">最終コミットまで戻す</h2>
<pre class="sourceCode sh" id="cb56"><code class="sourceCode bash"><div class="sourceLine" id="cb56-1" data-line-number="1"><span class="fu">git</span> reset --hard HEAD</div></code></pre>
<h1 id="ntp">ntp</h1>
<h3 id="同期状況">同期状況</h3>
<pre class="sourceCode bash" id="cb57"><code class="sourceCode bash"><div class="sourceLine" id="cb57-1" data-line-number="1"><span class="ex">/usr/sbin/ntpq</span> -p</div></code></pre>
<pre><code>     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
*196.2.33.10     LOCAL(0)         6 u  503 1024  377    1.656   -0.089   0.048
 196.2.34.10     .INIT.          16 u    - 1024    0    0.000    0.000   0.000
 196.3.33.10     .INIT.          16 u    - 1024    0    0.000    0.000   0.000
 196.3.34.10     .INIT.          16 u    - 1024    0    0.000    0.000   0.000</code></pre>
<h4 id="windows">Windows</h4>
<p>管理者コマンド</p>
<pre class="sourceCode bash" id="cb59"><code class="sourceCode bash"><div class="sourceLine" id="cb59-1" data-line-number="1"><span class="ex">w32tm</span> /query /peers</div></code></pre>
<h3 id="強制同期">強制同期</h3>
<pre class="sourceCode bash" id="cb60"><code class="sourceCode bash"><div class="sourceLine" id="cb60-1" data-line-number="1"><span class="fu">sudo</span> service ntpd restart</div></code></pre>
<h4 id="windows-1">Windows</h4>
<p>管理者コマンド</p>
<pre class="sourceCode bash" id="cb61"><code class="sourceCode bash"><div class="sourceLine" id="cb61-1" data-line-number="1"><span class="ex">w32tm</span> /resync /nowait</div></code></pre>
<h3 id="windows-2">Windows</h3>
<p>gpedit.msc で以下を実施</p>
<ul>
<li>ntp クライアントの有効化</li>
<li>ntp サーバの設定(192.168.0.1,0x1)</li>
</ul>
<p>service.msc の Windows Time で以下を実施</p>
<ul>
<li>(再)起動</li>
<li>自動起動</li>
</ul>
<h1 id="centrecom-sh210x210">CentreCOM SH210(x210)</h1>
<h2 id="port-shutdown">PORT SHUTDOWN</h2>
<pre class="sourceCode bash" id="cb62"><code class="sourceCode bash"><div class="sourceLine" id="cb62-1" data-line-number="1"><span class="ex">show</span> interface status</div>
<div class="sourceLine" id="cb62-2" data-line-number="2"><span class="bu">enable</span></div>
<div class="sourceLine" id="cb62-3" data-line-number="3"><span class="ex">configure</span> terminal</div>
<div class="sourceLine" id="cb62-4" data-line-number="4"><span class="ex">interface</span> port1.0.8</div>
<div class="sourceLine" id="cb62-5" data-line-number="5"><span class="ex">shutdown</span></div>
<div class="sourceLine" id="cb62-6" data-line-number="6"><span class="bu">exit</span></div>
<div class="sourceLine" id="cb62-7" data-line-number="7"><span class="bu">exit</span></div>
<div class="sourceLine" id="cb62-8" data-line-number="8"><span class="fu">write</span> file</div>
<div class="sourceLine" id="cb62-9" data-line-number="9"><span class="ex">show</span> interface status</div></code></pre>
<h2 id="状況表示">状況表示</h2>
<h3 id="running-config">RUNNING-CONFIG</h3>
<pre class="sourceCode bash" id="cb63"><code class="sourceCode bash"><div class="sourceLine" id="cb63-1" data-line-number="1"><span class="bu">enable</span></div>
<div class="sourceLine" id="cb63-2" data-line-number="2"><span class="ex">show</span> running-config</div></code></pre>
<h3 id="mac-address-filter">MAC ADDRESS Filter</h3>
<p>???</p>
<pre class="sourceCode bash" id="cb64"><code class="sourceCode bash"><div class="sourceLine" id="cb64-1" data-line-number="1"><span class="ex">mac</span> address-table static</div></code></pre>
<h3 id="ポートの状態">ポートの状態</h3>
<pre class="sourceCode bash" id="cb65"><code class="sourceCode bash"><div class="sourceLine" id="cb65-1" data-line-number="1"><span class="ex">show</span> interface status</div></code></pre>
<p>表示例</p>
<pre class="sourceCode bash" id="cb66"><code class="sourceCode bash"><div class="sourceLine" id="cb66-1" data-line-number="1"><span class="ex">Port</span>       Name               Status            Vlan Duplex   Speed Type</div>
<div class="sourceLine" id="cb66-2" data-line-number="2"><span class="ex">port1.0.1</span>                     connected            1 a-full  a-1000 1000BASE-T</div>
<div class="sourceLine" id="cb66-3" data-line-number="3"><span class="ex">port1.0.2</span>                     connected            1 a-full  a-1000 1000BASE-T</div>
<div class="sourceLine" id="cb66-4" data-line-number="4"><span class="ex">port1.0.3</span>                     notconnect           1 auto      auto 1000BASE-T</div>
<div class="sourceLine" id="cb66-5" data-line-number="5"><span class="ex">port1.0.4</span>                     connected            1 a-full  a-1000 1000BASE-T</div>
<div class="sourceLine" id="cb66-6" data-line-number="6"><span class="ex">port1.0.5</span>                     notconnect           1 auto      auto 1000BASE-T</div>
<div class="sourceLine" id="cb66-7" data-line-number="7"><span class="ex">port1.0.6</span>                     connected            1 a-full   a-100 1000BASE-T</div>
<div class="sourceLine" id="cb66-8" data-line-number="8"><span class="ex">port1.0.7</span>                     connected            1 a-full  a-1000 1000BASE-T</div>
<div class="sourceLine" id="cb66-9" data-line-number="9"><span class="ex">port1.0.8</span>                     connected            1 a-full  a-1000 1000BASE-T</div>
<div class="sourceLine" id="cb66-10" data-line-number="10"><span class="ex">port1.0.9</span>                     notconnect           1 auto      auto not present</div></code></pre>
<h2 id="基本設定ip接続可能化">基本設定(IP接続可能化)</h2>
<h3 id="rs-232c-接続">RS-232C 接続</h3>
<p>USB to Serial ケーブルで接続、ドライバをインストールする。</p>
<h3 id="ip-addr-設定">IP ADDR 設定</h3>
<p>各モード(階層)プロンプト</p>
<pre class="sourceCode bash" id="cb67"><code class="sourceCode bash"><div class="sourceLine" id="cb67-1" data-line-number="1"><span class="op">&gt;</span></div>
<div class="sourceLine" id="cb67-2" data-line-number="2">    <span class="co">#</span></div>
<div class="sourceLine" id="cb67-3" data-line-number="3">        <span class="kw">(</span><span class="ex">config</span><span class="kw">)</span>#</div>
<div class="sourceLine" id="cb67-4" data-line-number="4">            <span class="kw">(</span><span class="ex">config-if</span><span class="kw">)</span>#</div></code></pre>
<pre class="sourceCode bash" id="cb68"><code class="sourceCode bash"><div class="sourceLine" id="cb68-1" data-line-number="1"><span class="bu">enable</span></div>
<div class="sourceLine" id="cb68-2" data-line-number="2">    <span class="ex">configure</span> terminal</div>
<div class="sourceLine" id="cb68-3" data-line-number="3">        <span class="ex">interface</span> vlan1</div>
<div class="sourceLine" id="cb68-4" data-line-number="4">            <span class="ex">ip</span> address 192.168.10.254/24</div>
<div class="sourceLine" id="cb68-5" data-line-number="5"></div>
<div class="sourceLine" id="cb68-6" data-line-number="6">        <span class="ex">ip</span> route 0.0.0.0/0 192.168.10.1</div>
<div class="sourceLine" id="cb68-7" data-line-number="7"></div>
<div class="sourceLine" id="cb68-8" data-line-number="8">    <span class="fu">write</span> file</div></code></pre>
<h3 id="sshsftp-の有効化">SSH(+SFTP) の有効化</h3>
<pre class="sourceCode bash" id="cb69"><code class="sourceCode bash"><div class="sourceLine" id="cb69-1" data-line-number="1"><span class="op">&gt;</span></div>
<div class="sourceLine" id="cb69-2" data-line-number="2">    <span class="co">#</span></div>
<div class="sourceLine" id="cb69-3" data-line-number="3">        <span class="kw">(</span><span class="ex">config</span><span class="kw">)</span>#</div>
<div class="sourceLine" id="cb69-4" data-line-number="4">            <span class="kw">(</span><span class="ex">config-if</span><span class="kw">)</span>#</div></code></pre>
<pre class="sourceCode bash" id="cb70"><code class="sourceCode bash"><div class="sourceLine" id="cb70-1" data-line-number="1"><span class="ex">awplus</span><span class="op">&gt;</span> enable</div>
<div class="sourceLine" id="cb70-2" data-line-number="2"></div>
<div class="sourceLine" id="cb70-3" data-line-number="3"><span class="ex">awplus</span># configure terminal</div>
<div class="sourceLine" id="cb70-4" data-line-number="4"><span class="ex">Enter</span> configuration commands, one per line.  End with CNTL/Z.</div>
<div class="sourceLine" id="cb70-5" data-line-number="5"></div>
<div class="sourceLine" id="cb70-6" data-line-number="6"><span class="ex">awplus</span>(config)#<span class="ex">crypto</span> key generate hostkey dsa</div>
<div class="sourceLine" id="cb70-7" data-line-number="7"></div>
<div class="sourceLine" id="cb70-8" data-line-number="8"><span class="ex">Generating</span> host key (1024 bits dsa)</div>
<div class="sourceLine" id="cb70-9" data-line-number="9"><span class="ex">This</span> may take a while. Please wait ... Done</div>
<div class="sourceLine" id="cb70-10" data-line-number="10"></div>
<div class="sourceLine" id="cb70-11" data-line-number="11"><span class="ex">WARNING</span>: The SSH server must now be enabled with <span class="st">&quot;service ssh&quot;</span></div>
<div class="sourceLine" id="cb70-12" data-line-number="12"></div>
<div class="sourceLine" id="cb70-13" data-line-number="13"><span class="ex">awplus</span>(config)# <span class="ex">crypto</span> key generate hostkey rsa</div>
<div class="sourceLine" id="cb70-14" data-line-number="14"></div>
<div class="sourceLine" id="cb70-15" data-line-number="15"><span class="ex">Generating</span> host key (1024 bits rsa)</div>
<div class="sourceLine" id="cb70-16" data-line-number="16"><span class="ex">This</span> may take a while. Please wait ... Done</div>
<div class="sourceLine" id="cb70-17" data-line-number="17"></div>
<div class="sourceLine" id="cb70-18" data-line-number="18"><span class="ex">WARNING</span>: The SSH server must now be enabled with <span class="st">&quot;service ssh&quot;</span></div>
<div class="sourceLine" id="cb70-19" data-line-number="19"></div>
<div class="sourceLine" id="cb70-20" data-line-number="20"><span class="ex">awplus</span>(config)# <span class="ex">crypto</span> key generate hostkey rsa1</div>
<div class="sourceLine" id="cb70-21" data-line-number="21"></div>
<div class="sourceLine" id="cb70-22" data-line-number="22"><span class="ex">Generating</span> host key (1024 bits rsa1)</div>
<div class="sourceLine" id="cb70-23" data-line-number="23"><span class="ex">This</span> may take a while. Please wait ... Done</div>
<div class="sourceLine" id="cb70-24" data-line-number="24"></div>
<div class="sourceLine" id="cb70-25" data-line-number="25"><span class="ex">WARNING</span>: The SSH server must now be enabled with <span class="st">&quot;service ssh&quot;</span></div>
<div class="sourceLine" id="cb70-26" data-line-number="26"></div>
<div class="sourceLine" id="cb70-27" data-line-number="27"><span class="ex">awplus</span>(config)# <span class="fu">ssh</span> server allow-users *</div>
<div class="sourceLine" id="cb70-28" data-line-number="28"><span class="ex">awplus</span>(config)# <span class="fu">ssh</span> server session-timeout 3600</div>
<div class="sourceLine" id="cb70-29" data-line-number="29"><span class="ex">awplus</span>(config)# <span class="ex">service</span> ssh</div>
<div class="sourceLine" id="cb70-30" data-line-number="30"><span class="ex">awplus</span>(config)# ^<span class="ex">D</span></div>
<div class="sourceLine" id="cb70-31" data-line-number="31"><span class="ex">awplus</span># write file</div>
<div class="sourceLine" id="cb70-32" data-line-number="32"></div>
<div class="sourceLine" id="cb70-33" data-line-number="33"><span class="ex">Building</span> configuration...</div>
<div class="sourceLine" id="cb70-34" data-line-number="34">[<span class="ex">OK</span>]</div></code></pre>
<h3 id="ポート速度設定">ポート速度設定</h3>
<pre class="sourceCode bash" id="cb71"><code class="sourceCode bash"><div class="sourceLine" id="cb71-1" data-line-number="1"><span class="ex">awplus</span><span class="op">&gt;</span> enable</div>
<div class="sourceLine" id="cb71-2" data-line-number="2"><span class="ex">awplus</span># configure terminal</div>
<div class="sourceLine" id="cb71-3" data-line-number="3"><span class="ex">awplus</span>(config)# <span class="ex">interface</span> port1.0.1</div>
<div class="sourceLine" id="cb71-4" data-line-number="4"><span class="ex">awplus</span>(config-if)# <span class="ex">speed</span> 10</div>
<div class="sourceLine" id="cb71-5" data-line-number="5"><span class="ex">awplus</span>(config-if)# <span class="ex">duplex</span> full</div></code></pre>
<h1 id="visual-studio-code">Visual Studio Code</h1>
<h2 id="gnome">GNOME</h2>
<p>マルチカーソル(Alt)が効かない場合</p>
<pre class="sourceCode bash" id="cb72"><code class="sourceCode bash"><div class="sourceLine" id="cb72-1" data-line-number="1"><span class="ex">gsettings</span> set org.gnome.desktop.wm.preferences mouse-button-modifier <span class="st">&quot;&lt;Super&gt;&quot;</span></div></code></pre>
<h2 id="基本操作">基本操作</h2>
<h3 id="コマンドラインから起動">コマンドラインから起動</h3>
<pre class="sourceCode bash" id="cb73"><code class="sourceCode bash"><div class="sourceLine" id="cb73-1" data-line-number="1"><span class="ex">code</span> .</div></code></pre>
<h3 id="コマンドパレットの呼出し">コマンドパレットの呼出し</h3>
<table>
<tbody>
<tr class="odd">
<td style="text-align: center;">通常</td>
<td style="text-align: center;">Command + P</td>
</tr>
<tr class="even">
<td style="text-align: center;">拡張</td>
<td style="text-align: center;">Command + Shift + P</td>
</tr>
</tbody>
</table>
<h2 id="エディタ操作">エディタ操作</h2>
<h3 id="カーソル移動">カーソル移動</h3>
<p>to top,bottom: Command + UP, DOWN</p>
<h2 id="英語モード">英語モード</h2>
<ul>
<li>コマンドまで日本語…</li>
<li>メニューバーに(F)…</li>
</ul>
<h3 id="locale.json-を開く">locale.json を開く</h3>
<pre><code>&gt;言語を構成する</code></pre>
<h3 id="内容を以下にする">内容を以下にする</h3>
<pre class="sourceCode bash" id="cb75"><code class="sourceCode bash"><div class="sourceLine" id="cb75-1" data-line-number="1"><span class="st">&quot;locale&quot;</span>:<span class="st">&quot;en-US&quot;</span></div></code></pre>
<h3 id="再起動する">再起動する</h3>
<h1 id="handsontable">Handsontable</h1>
<h2 id="css">CSS</h2>
<h3 id="shadow">SHADOW</h3>
<h4 id="handsontable-mastersrccsshandsontable.css">handsontable-master/src/css/handsontable.css</h4>
<pre class="sourceCode css" id="cb76"><code class="sourceCode css"><div class="sourceLine" id="cb76-1" data-line-number="1"><span class="fu">.handsontable</span> <span class="fu">.handsontable</span> table {</div>
<div class="sourceLine" id="cb76-2" data-line-number="2">  <span class="kw">-webkit-box-shadow</span>: <span class="dv">1px</span> <span class="dv">2px</span> <span class="dv">5px</span> <span class="fu">rgba</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0.4</span>);</div>
<div class="sourceLine" id="cb76-3" data-line-number="3">  <span class="kw">box-shadow</span>: <span class="dv">1px</span> <span class="dv">2px</span> <span class="dv">5px</span> <span class="fu">rgba</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0.4</span>);</div>
<div class="sourceLine" id="cb76-4" data-line-number="4">}</div></code></pre>
<h1 id="network-manager">NETWORK MANAGER</h1>
<h2 id="connection">CONNECTION</h2>
<h3 id="add">ADD</h3>
<pre class="sourceCode bash" id="cb77"><code class="sourceCode bash"><div class="sourceLine" id="cb77-1" data-line-number="1"><span class="ex">nmcli</span> connection add \</div>
<div class="sourceLine" id="cb77-2" data-line-number="2">      type ethernet \</div>
<div class="sourceLine" id="cb77-3" data-line-number="3">      ifname eno1 \</div>
<div class="sourceLine" id="cb77-4" data-line-number="4">      con-name eno1-1 \</div>
<div class="sourceLine" id="cb77-5" data-line-number="5">      autoconnect yes \</div>
<div class="sourceLine" id="cb77-6" data-line-number="6">      save yes \</div>
<div class="sourceLine" id="cb77-7" data-line-number="7">      ip4 <span class="st">&quot;10.0.0.10/24&quot;</span> \</div>
<div class="sourceLine" id="cb77-8" data-line-number="8">      gw4 <span class="st">&quot;0.0.0.0&quot;</span></div>
<div class="sourceLine" id="cb77-9" data-line-number="9"></div>
<div class="sourceLine" id="cb77-10" data-line-number="10"><span class="ex">nmcli</span> connection mod ipv4.method manual ipv4.addresses <span class="st">&quot;192.168.0.100/24&quot;</span></div></code></pre>
<h3 id="del">DEL</h3>
<pre class="sourceCode bash" id="cb78"><code class="sourceCode bash"><div class="sourceLine" id="cb78-1" data-line-number="1"><span class="ex">nmcli</span> connection delete eno1-1</div></code></pre>
<h1 id="selinux">selinux</h1>
<h2 id="off">OFF</h2>
<pre class="sourceCode bash" id="cb79"><code class="sourceCode bash"><div class="sourceLine" id="cb79-1" data-line-number="1"><span class="bu">echo</span> <span class="st">&#39;SELINUX=disabled&#39;</span> <span class="op">&gt;</span> /etc/selinux/config</div></code></pre>
<pre class="sourceCode bash" id="cb80"><code class="sourceCode bash"><div class="sourceLine" id="cb80-1" data-line-number="1"><span class="ex">reboot</span></div></code></pre>
<h1 id="ll-basics">LL BASICS</h1>
<h2 id="repl">REPL</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">PYTHON</th>
<th>RUBY</th>
<th>JAVASCRIPT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">python</td>
<td>irb</td>
<td>node</td>
</tr>
</tbody>
</table>
<h2 id="lib">LIB</h2>
<h3 id="include">INCLUDE</h3>
<h4 id="python">python</h4>
<pre class="sourceCode python" id="cb81"><code class="sourceCode python"><div class="sourceLine" id="cb81-1" data-line-number="1">sys.path.append(os.path.join(os.path.dirname(<span class="va">__file__</span>),<span class="st">&#39;</span><span class="sc">{{</span><span class="st">LIBDIR</span><span class="sc">}}</span><span class="st">&#39;</span>))</div></code></pre>
<h2 id="listarray">LIST(ARRAY)</h2>
<h3 id="join">JOIN</h3>
<h4 id="python-1">PYTHON</h4>
<pre class="sourceCode python" id="cb82"><code class="sourceCode python"><div class="sourceLine" id="cb82-1" data-line-number="1"><span class="co">&#39;&#39;</span>.join([<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>])  <span class="co"># ab</span></div>
<div class="sourceLine" id="cb82-2" data-line-number="2"><span class="co">&#39;,&#39;</span>.join([<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>]) <span class="co"># a,b</span></div></code></pre>
<h4 id="ruby">RUBY</h4>
<pre class="sourceCode ruby" id="cb83"><code class="sourceCode ruby"><div class="sourceLine" id="cb83-1" data-line-number="1">[<span class="ch">&#39;a&#39;</span>,<span class="ch">&#39;b&#39;</span>].join(<span class="st">&#39;&#39;</span>)  <span class="co"># ab</span></div>
<div class="sourceLine" id="cb83-2" data-line-number="2">[<span class="ch">&#39;a&#39;</span>,<span class="ch">&#39;b&#39;</span>].join(<span class="ch">&#39;,&#39;</span>) <span class="co"># a,b</span></div></code></pre>
<h4 id="javascript">JAVASCRIPT</h4>
<pre class="sourceCode javascript" id="cb84"><code class="sourceCode javascript"><div class="sourceLine" id="cb84-1" data-line-number="1">[<span class="st">&#39;a&#39;</span><span class="op">,</span><span class="st">&#39;b&#39;</span>].<span class="at">join</span>(<span class="st">&#39;&#39;</span>)  <span class="co">// ab</span></div>
<div class="sourceLine" id="cb84-2" data-line-number="2">[<span class="st">&#39;a&#39;</span><span class="op">,</span><span class="st">&#39;b&#39;</span>].<span class="at">join</span>(<span class="st">&#39;,&#39;</span>) <span class="co">// a,b</span></div></code></pre>
<h3 id="reverse">REVERSE</h3>
<h4 id="python-2">PYTHON</h4>
<pre class="sourceCode python" id="cb85"><code class="sourceCode python"><div class="sourceLine" id="cb85-1" data-line-number="1">[<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>][::<span class="op">-</span><span class="dv">1</span>] <span class="co"># [&#39;b&#39;, &#39;a&#39;]</span></div></code></pre>
<h2 id="date">DATE</h2>
<h3 id="serialint-to-str">SERIAL(INT) to STR</h3>
<h4 id="python-3">PYTHON</h4>
<pre class="sourceCode python" id="cb86"><code class="sourceCode python"><div class="sourceLine" id="cb86-1" data-line-number="1"><span class="im">import</span> time</div>
<div class="sourceLine" id="cb86-2" data-line-number="2">time.strftime(<span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S&quot;</span>,time.localtime(<span class="dv">963920001</span>)) <span class="co"># &#39;2000-07-18 12:33:21&#39;</span></div>
<div class="sourceLine" id="cb86-3" data-line-number="3">time.strftime(<span class="st">&quot;%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S&quot;</span>,time.gmtime(<span class="dv">963920001</span>))    <span class="co"># &#39;2000-07-18 11:33:21&#39;</span></div></code></pre>
<h1 id="bash">BASH</h1>
<h2 id="str-cut">STR CUT</h2>
<pre class="sourceCode bash" id="cb87"><code class="sourceCode bash"><div class="sourceLine" id="cb87-1" data-line-number="1"><span class="va">a=</span>ABC</div>
<div class="sourceLine" id="cb87-2" data-line-number="2"><span class="bu">echo</span> <span class="va">${a:1:1}</span> <span class="co"># B</span></div></code></pre>
<h2 id="history">history</h2>
<h3 id="add-time">add time</h3>
<pre class="sourceCode bash" id="cb88"><code class="sourceCode bash"><div class="sourceLine" id="cb88-1" data-line-number="1"><span class="va">HISTTIMEFORMAT=</span><span class="st">&#39;%Y-%m-%d %T &#39;</span></div></code></pre>
<h2 id="brace-expansion">brace expansion</h2>
<h3 id="add-seq">add seq</h3>
<pre class="sourceCode bash" id="cb89"><code class="sourceCode bash"><div class="sourceLine" id="cb89-1" data-line-number="1"><span class="bu">echo</span> A-<span class="dt">{{1..3},5}</span>  # A-1 A-2 A-3 A-5</div>
<div class="sourceLine" id="cb89-2" data-line-number="2"><span class="bu">echo</span> A-<span class="dt">{a..c}</span>      # A-a A-b A-c</div></code></pre>
<h3 id="cp-date">cp + date</h3>
<pre class="sourceCode bash" id="cb90"><code class="sourceCode bash"><div class="sourceLine" id="cb90-1" data-line-number="1"><span class="fu">cp</span> filename{,<span class="kw">`</span><span class="fu">date</span> +<span class="st">&#39;__%Y-%m-%d_%H-%M-%S&#39;</span><span class="kw">`</span>}<span class="ex">.tgz</span></div>
<div class="sourceLine" id="cb90-2" data-line-number="2"><span class="co"># cp filename.tgz filename__2015-01-23_23-05-58.tgz</span></div></code></pre>
<h1 id="virtual-box">VIRTUAL BOX</h1>
<h2 id="disk-1">DISK</h2>
<h3 id="create-shareable">create shareable</h3>
<pre class="sourceCode bash" id="cb91"><code class="sourceCode bash"><div class="sourceLine" id="cb91-1" data-line-number="1"><span class="ex">vboxmanage</span> createhd --size 1000 --variant Fixed --filename disk1.vdi</div>
<div class="sourceLine" id="cb91-2" data-line-number="2"><span class="ex">vboxmanage</span> modifyhd --type shareable disk1.vdi</div></code></pre>
<h2 id="serial-port">Serial Port</h2>
<h3 id="linux-host-win-guest">Linux Host &amp; Win Guest</h3>
<h4 id="linuxhost">Linux(Host)</h4>
<pre class="sourceCode bash" id="cb92"><code class="sourceCode bash"><div class="sourceLine" id="cb92-1" data-line-number="1"><span class="fu">su</span></div>
<div class="sourceLine" id="cb92-2" data-line-number="2"><span class="fu">chmod</span> 666 /dev/ttyS0</div>
<div class="sourceLine" id="cb92-3" data-line-number="3"><span class="ex">ll</span> /dev/ttyS0</div>
<div class="sourceLine" id="cb92-4" data-line-number="4"><span class="ex">crw-rw-rw-</span> 1 root dialout 4, 64  1月 21 20:12 2015 ttyS0</div></code></pre>
<p>この設定は再起動時にリセットされる。 恒久的に使う場合は、/etc/udev/… に、…</p>
<h4 id="winvbox-guest-settingserial-port">Win(VBox Guest Setting:Serial Port)</h4>
<ul>
<li>[ON] “Serial Port Enable”</li>
<li>COM1</li>
<li>Host Device</li>
<li><a href="#off">OFF</a> “Make PIPE”</li>
<li>/dev/ttyS0</li>
</ul>
<h1 id="allied-telesis-centrecom">Allied Telesis CentreCOM</h1>
<h2 id="conn-to-serial-port">Conn to Serial Port</h2>
<h3 id="serial-port-settings">Serial Port Settings</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">sets</th>
<th style="text-align: left;">val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bit/sec</td>
<td style="text-align: left;">9600</td>
</tr>
<tr class="even">
<td style="text-align: left;">data bit</td>
<td style="text-align: left;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">parity</td>
<td style="text-align: left;">none</td>
</tr>
<tr class="even">
<td style="text-align: left;">stop bit</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">flow cont</td>
<td style="text-align: left;">none</td>
</tr>
</tbody>
</table>
<h3 id="userpassword">User/Password</h3>
<p>manager/friend</p>
<h3 id="add-ip">ADD IP</h3>
<pre class="sourceCode bash" id="cb93"><code class="sourceCode bash"><div class="sourceLine" id="cb93-1" data-line-number="1"><span class="ex">add</span> ip IPADDRESS=202.46.51.254 MASK=255.255.255.0 GATEWAY=0.0.0.0</div></code></pre>
<pre class="sourceCode bash" id="cb94"><code class="sourceCode bash"><div class="sourceLine" id="cb94-1" data-line-number="1"><span class="ex">show</span> ip</div>
<div class="sourceLine" id="cb94-2" data-line-number="2"></div>
<div class="sourceLine" id="cb94-3" data-line-number="3"><span class="ex">IP</span> Address Information</div>
<div class="sourceLine" id="cb94-4" data-line-number="4"><span class="ex">--------------------------------------------</span></div>
<div class="sourceLine" id="cb94-5" data-line-number="5"> <span class="ex">Type</span> ....................... Static</div>
<div class="sourceLine" id="cb94-6" data-line-number="6"> <span class="ex">Interface</span> .................. default</div>
<div class="sourceLine" id="cb94-7" data-line-number="7"> <span class="ex">IP</span> address ................. 202.46.51.254</div>
<div class="sourceLine" id="cb94-8" data-line-number="8"> <span class="ex">Subnet</span> mask ................ 255.255.255.0</div>
<div class="sourceLine" id="cb94-9" data-line-number="9"> <span class="ex">Gateway</span> address ............ 0.0.0.0</div>
<div class="sourceLine" id="cb94-10" data-line-number="10"> <span class="ex">MTU</span> ........................ 1500</div>
<div class="sourceLine" id="cb94-11" data-line-number="11"> <span class="ex">DHCP</span> Client ................ Disabled</div>
<div class="sourceLine" id="cb94-12" data-line-number="12"> <span class="ex">Directed</span> broadcast ......... No</div>
<div class="sourceLine" id="cb94-13" data-line-number="13"><span class="ex">--------------------------------------------</span></div></code></pre>
<h3 id="enable-http-server">ENable Http server</h3>
<pre class="sourceCode bash" id="cb95"><code class="sourceCode bash"><div class="sourceLine" id="cb95-1" data-line-number="1"><span class="ex">ENable</span> Http server</div></code></pre>
<pre class="sourceCode bash" id="cb96"><code class="sourceCode bash"><div class="sourceLine" id="cb96-1" data-line-number="1"><span class="ex">SHow</span> Http server</div></code></pre>
<pre class="sourceCode bash" id="cb97"><code class="sourceCode bash"><div class="sourceLine" id="cb97-1" data-line-number="1"><span class="ex">HTTP</span> Server Module Configuration:</div>
<div class="sourceLine" id="cb97-2" data-line-number="2"><span class="ex">--------------------------------------</span></div>
<div class="sourceLine" id="cb97-3" data-line-number="3"><span class="ex">Status</span>                     : Enabled</div>
<div class="sourceLine" id="cb97-4" data-line-number="4"><span class="ex">HTTP</span> Server Listen Port    : 80</div>
<div class="sourceLine" id="cb97-5" data-line-number="5"><span class="ex">--------------------------------------</span></div></code></pre>
<h3 id="enable-telnet-server">ENable Telnet server</h3>
<pre class="sourceCode bash" id="cb98"><code class="sourceCode bash"><div class="sourceLine" id="cb98-1" data-line-number="1"><span class="ex">ENable</span> TELnet server</div></code></pre>
<pre class="sourceCode bash" id="cb99"><code class="sourceCode bash"><div class="sourceLine" id="cb99-1" data-line-number="1"><span class="ex">SHow</span> TElnet</div></code></pre>
<pre class="sourceCode bash" id="cb100"><code class="sourceCode bash"><div class="sourceLine" id="cb100-1" data-line-number="1"><span class="ex">TELNET</span> Module Configuration:</div>
<div class="sourceLine" id="cb100-2" data-line-number="2"><span class="ex">--------------------------------------</span></div>
<div class="sourceLine" id="cb100-3" data-line-number="3"> <span class="ex">TELNET</span> Server             : Enabled</div>
<div class="sourceLine" id="cb100-4" data-line-number="4"> <span class="ex">TELNET</span> Server Listen Port : 23</div>
<div class="sourceLine" id="cb100-5" data-line-number="5"> <span class="ex">TELNET</span> Connection Limit   : 4</div>
<div class="sourceLine" id="cb100-6" data-line-number="6"><span class="ex">--------------------------------------</span></div></code></pre>
<h1 id="fdisk">FDISK</h1>
<h2 id="list-all">LIST ALL</h2>
<pre class="sourceCode bash" id="cb101"><code class="sourceCode bash"><div class="sourceLine" id="cb101-1" data-line-number="1"><span class="ex">fdisk</span> -l</div></code></pre>
<h2 id="part">PART</h2>
<pre class="sourceCode bash" id="cb102"><code class="sourceCode bash"><div class="sourceLine" id="cb102-1" data-line-number="1"><span class="ex">fdisk</span> /dev/sdb</div></code></pre>
<ul>
<li>p: 領域テーブルを表示する</li>
<li>n: 新規</li>
<li>p: 基本パーティション</li>
<li>1: パーティション番号</li>
<li>RET,RET</li>
<li>p: 領域テーブルを表示する</li>
<li>w: テーブルをディスクに書き込み、終了する</li>
</ul>
<h2 id="formatmake-filesystem">FORMAT(make filesystem)</h2>
<pre class="sourceCode bash" id="cb103"><code class="sourceCode bash"><div class="sourceLine" id="cb103-1" data-line-number="1"><span class="ex">mke2fs</span> /dev/sdb1</div></code></pre>
<h1 id="dd">DD</h1>
<h2 id="make-dummyfile">MAKE DUMMYFILE</h2>
<pre class="sourceCode bash" id="cb104"><code class="sourceCode bash"><div class="sourceLine" id="cb104-1" data-line-number="1"><span class="fu">dd</span> if=/dev/zero of=./dummyfile bs=100M count=1</div>
<div class="sourceLine" id="cb104-2" data-line-number="2"><span class="fu">ls</span> -l ./dummyfile</div></code></pre>
<h1 id="systemd">SYSTEMD</h1>
<h2 id="service">SERVICE</h2>
<h3 id="files">FILES</h3>
<h4 id="usrlibsystemdcp.path">/usr/lib/systemd/cp.path</h4>
<pre class="sourceCode bash" id="cb105"><code class="sourceCode bash"><div class="sourceLine" id="cb105-1" data-line-number="1">[<span class="ex">Unit</span>]</div>
<div class="sourceLine" id="cb105-2" data-line-number="2"><span class="va">Description=</span>systemdtest</div>
<div class="sourceLine" id="cb105-3" data-line-number="3"></div>
<div class="sourceLine" id="cb105-4" data-line-number="4">[<span class="ex">Path</span>]</div>
<div class="sourceLine" id="cb105-5" data-line-number="5"><span class="va">PathChanged=</span>/home/vagrant/target1.txt</div>
<div class="sourceLine" id="cb105-6" data-line-number="6"></div>
<div class="sourceLine" id="cb105-7" data-line-number="7">[<span class="ex">Install</span>]</div>
<div class="sourceLine" id="cb105-8" data-line-number="8"><span class="va">WantedBy=</span>multi-user.target</div></code></pre>
<h4 id="usrlibsystemdcp.service">/usr/lib/systemd/cp.service</h4>
<p>下の2行がないと、enableでなんかゆわれる</p>
<pre class="sourceCode bash" id="cb106"><code class="sourceCode bash"><div class="sourceLine" id="cb106-1" data-line-number="1">[<span class="ex">Unit</span>]</div>
<div class="sourceLine" id="cb106-2" data-line-number="2"><span class="va">Description=</span>Copy <span class="fu">file</span></div>
<div class="sourceLine" id="cb106-3" data-line-number="3"></div>
<div class="sourceLine" id="cb106-4" data-line-number="4">[<span class="ex">Service</span>]</div>
<div class="sourceLine" id="cb106-5" data-line-number="5"><span class="va">Type=</span>oneshot</div>
<div class="sourceLine" id="cb106-6" data-line-number="6"><span class="va">ExecStart=</span>/usr/bin/cp <span class="ex">-f</span> /home/vagrant/target1.txt /home/vagrant/target2.txt</div>
<div class="sourceLine" id="cb106-7" data-line-number="7"></div>
<div class="sourceLine" id="cb106-8" data-line-number="8">[<span class="ex">Install</span>]</div>
<div class="sourceLine" id="cb106-9" data-line-number="9"><span class="va">WantedBy=</span>multi-user.target</div></code></pre>
<h3 id="install-3">INSTALL</h3>
<pre class="sourceCode bash" id="cb107"><code class="sourceCode bash"><div class="sourceLine" id="cb107-1" data-line-number="1"><span class="fu">sudo</span> ln -s /etc/systemd/system/cp.path    /etc/systemd/system/multi-user.target.wants/</div>
<div class="sourceLine" id="cb107-2" data-line-number="2"><span class="fu">sudo</span> ln -s /etc/systemd/system/cp.service /etc/systemd/system/multi-user.target.wants/</div></code></pre>
<h3 id="enable">ENABLE</h3>
<pre class="sourceCode bash" id="cb108"><code class="sourceCode bash"><div class="sourceLine" id="cb108-1" data-line-number="1"><span class="fu">sudo</span> systemctl enable cp.path</div>
<div class="sourceLine" id="cb108-2" data-line-number="2"><span class="fu">sudo</span> systemctl enable cp.service</div></code></pre>
<h3 id="start">START</h3>
<pre class="sourceCode bash" id="cb109"><code class="sourceCode bash"><div class="sourceLine" id="cb109-1" data-line-number="1"><span class="fu">sudo</span> systemctl start cp.path</div>
<div class="sourceLine" id="cb109-2" data-line-number="2"><span class="fu">sudo</span> systemctl start cp.service</div></code></pre>
<h3 id="status">STATUS</h3>
<pre class="sourceCode bash" id="cb110"><code class="sourceCode bash"><div class="sourceLine" id="cb110-1" data-line-number="1"><span class="ex">systemctl</span> status cp.path</div>
<div class="sourceLine" id="cb110-2" data-line-number="2"><span class="ex">systemctl</span> status cp.service</div></code></pre>
<h2 id="reload">RELOAD</h2>
<pre class="sourceCode bash" id="cb111"><code class="sourceCode bash"><div class="sourceLine" id="cb111-1" data-line-number="1"><span class="fu">sudo</span> systemctl --system daemon-reload</div></code></pre>
<h1 id="iconv">ICONV</h1>
<ul>
<li>Windows SJIS は、 SHIFT_JISX0213 とすべし。</li>
<li>Windows UTF-8 は BOM 付き。</li>
<li>-c でエラーストップしなくなる。</li>
</ul>
<h2 id="文字コード一覧表示">文字コード一覧表示</h2>
<pre class="sourceCode bash" id="cb112"><code class="sourceCode bash"><div class="sourceLine" id="cb112-1" data-line-number="1"><span class="ex">iconv</span> -l</div></code></pre>
<h2 id="euc---utf-8">EUC -&gt; UTF-8</h2>
<pre class="sourceCode bash" id="cb113"><code class="sourceCode bash"><div class="sourceLine" id="cb113-1" data-line-number="1"><span class="ex">iconv</span> -f EUC-JP -t UTF-8 FILE -o FILE.utf8</div></code></pre>
<h2 id="sjis---utf-8">SJIS -&gt; UTF-8</h2>
<pre class="sourceCode bash" id="cb114"><code class="sourceCode bash"><div class="sourceLine" id="cb114-1" data-line-number="1"><span class="ex">iconv</span> -f SHIFT_JISX0213 -t UTF-8 FILE -o FILE.utf8</div></code></pre>
<h2 id="bom-delete">BOM delete</h2>
<pre class="sourceCode bash" id="cb115"><code class="sourceCode bash"><div class="sourceLine" id="cb115-1" data-line-number="1"><span class="fu">tail</span> --bytes=+4 index.unix.txt</div></code></pre>
<h2 id="一括処理">一括処理</h2>
<h3 id="カレントディレクトリ以下">カレントディレクトリ以下</h3>
<pre class="sourceCode bash" id="cb116"><code class="sourceCode bash"><div class="sourceLine" id="cb116-1" data-line-number="1"><span class="fu">find</span> -type f <span class="kw">|</span> <span class="fu">xargs</span> file <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&quot;:.*text&quot;</span> <span class="kw">|</span> <span class="fu">cut</span> -d : -f1 <span class="kw">|</span> <span class="fu">xargs</span> -t -I<span class="dt">{}</span> iconv -f EUC-JP -t UTF-8 <span class="dt">{}</span> -o <span class="dt">{}</span>.utf8</div></code></pre>
<h1 id="awk">AWK</h1>
<h2 id="col-complete">COL COMPLETE</h2>
<pre class="sourceCode bash" id="cb117"><code class="sourceCode bash"><div class="sourceLine" id="cb117-1" data-line-number="1"><span class="kw">{</span></div>
<div class="sourceLine" id="cb117-2" data-line-number="2">  <span class="bu">echo</span> <span class="st">&#39;100 abc&#39;</span></div>
<div class="sourceLine" id="cb117-3" data-line-number="3">  <span class="bu">echo</span> <span class="st">&#39;bcd&#39;</span></div>
<div class="sourceLine" id="cb117-4" data-line-number="4">  <span class="bu">echo</span> <span class="st">&#39;200 def&#39;</span></div>
<div class="sourceLine" id="cb117-5" data-line-number="5"><span class="kw">}</span> <span class="op">&gt;</span> <span class="ex">file.txt</span></div>
<div class="sourceLine" id="cb117-6" data-line-number="6"><span class="fu">cat</span> file.txt</div>
<div class="sourceLine" id="cb117-7" data-line-number="7"><span class="fu">cat</span> file.txt <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;m=match($0,/^[0-9]+\ /){print $0;n=substr($0,RSTART,RLENGTH)};!m{print n $0}&#39;</span></div>
<div class="sourceLine" id="cb117-8" data-line-number="8"><span class="fu">rm</span> file.txt</div></code></pre>
<h1 id="tar">TAR</h1>
<h2 id="ls">LS</h2>
<pre class="sourceCode bash" id="cb118"><code class="sourceCode bash"><div class="sourceLine" id="cb118-1" data-line-number="1"><span class="fu">tar</span> zft AAA.tgz</div></code></pre>
<h2 id="matome">MATOME</h2>
<pre class="sourceCode bash" id="cb119"><code class="sourceCode bash"><div class="sourceLine" id="cb119-1" data-line-number="1"><span class="kw">for</span> <span class="ex">f</span> in ./*.tgz <span class="kw">;</span> <span class="kw">do</span> <span class="fu">tar</span> zxvf <span class="va">$f</span> <span class="kw">;</span> <span class="kw">done</span></div></code></pre>
<h1 id="netstat">NETSTAT</h1>
<h2 id="option">OPTION</h2>
<pre class="sourceCode bash" id="cb120"><code class="sourceCode bash"><div class="sourceLine" id="cb120-1" data-line-number="1"><span class="fu">netstat</span>  --inet -aenop</div></code></pre>
<ul>
<li>–inet: inet protocol</li>
<li>a: all status</li>
<li>e: extend(User&amp;Inode)</li>
<li>n: numeric</li>
<li>o: timers</li>
<li>p: pid,program</li>
</ul>
<h2 id="state">STATE</h2>
<h3 id="from-man">from man</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">NAME</th>
<th style="text-align: left;">WHAT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ESTABLISHED</td>
<td style="text-align: left;">ソケットは確立した接続状態にある。</td>
</tr>
<tr class="even">
<td style="text-align: left;">SYN_SENT</td>
<td style="text-align: left;">ソケットは接続を確立しようと試みている。</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SYN_RECV</td>
<td style="text-align: left;">接続要求をネットワークから受信している。</td>
</tr>
<tr class="even">
<td style="text-align: left;">FIN_WAIT1</td>
<td style="text-align: left;">ソケットはクローズされており、接続は切断中である。</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FIN_WAIT2</td>
<td style="text-align: left;">接続はクローズされ、ソケットはリモート側からの切断を待っている。</td>
</tr>
<tr class="even">
<td style="text-align: left;">TIME_WAIT</td>
<td style="text-align: left;">ソケットは、クローズ後にリモートからの切断が再送されるのを待っている。</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CLOSED</td>
<td style="text-align: left;">ソケットは使用されていない。</td>
</tr>
<tr class="even">
<td style="text-align: left;">CLOSE_WAIT</td>
<td style="text-align: left;">リモート側は既に切断され、ソケットがクローズされるのを待っている。</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LAST_ACK</td>
<td style="text-align: left;">リモート側は既に切断され、ソケットもクローズされている。 確認 (acknowledgement) を待っている。</td>
</tr>
<tr class="even">
<td style="text-align: left;">LISTEN</td>
<td style="text-align: left;">ソケットは接続待ち (listen) である。このようなソケットは、–listening (-l) または –all (-a) オプションを指定しない限り、出力には含まれない。</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CLOSING</td>
<td style="text-align: left;">両方のソケットが切断されているが、まだ全てのデータが送られていない。</td>
</tr>
<tr class="even">
<td style="text-align: left;">UNKNOWN</td>
<td style="text-align: left;">ソケットの状態は不明である。</td>
</tr>
</tbody>
</table>
<h1 id="mac-os-x">Mac OS X</h1>
<h2 id="network">NETWORK</h2>
<h3 id="listen-port">LISTEN PORT</h3>
<pre class="sourceCode bash" id="cb121"><code class="sourceCode bash"><div class="sourceLine" id="cb121-1" data-line-number="1"><span class="ex">lsof</span> -nP -iTCP -sTCP:LISTEN</div></code></pre>
<h1 id="yeoman">YEOMAN</h1>
<p>homebrew で入れてる場合は sudo 無し</p>
<p>can not load module は npm update -g</p>
<p>パーミッションぽいのは chmod -R <code>whoami</code> ~/.npm</p>
<h2 id="setup">setup</h2>
<pre class="sourceCode bash" id="cb122"><code class="sourceCode bash"><div class="sourceLine" id="cb122-1" data-line-number="1"><span class="ex">npm</span> install -g yo grunt grunt-cli bower</div></code></pre>
<h2 id="generator">generator</h2>
<h3 id="search">search</h3>
<p><a href="http://yeoman.io/generators/" class="uri">http://yeoman.io/generators/</a></p>
<h3 id="install-4">install</h3>
<pre class="sourceCode bash" id="cb123"><code class="sourceCode bash"><div class="sourceLine" id="cb123-1" data-line-number="1"><span class="ex">npm</span> install -g generator-webapp</div></code></pre>
<h2 id="generate-webapp">generate WEBAPP</h2>
<pre class="sourceCode bash" id="cb124"><code class="sourceCode bash"><div class="sourceLine" id="cb124-1" data-line-number="1"><span class="fu">mkdir</span> WEBAPPDIR <span class="kw">&amp;&amp;</span> <span class="bu">cd</span> WEBAPPDIR</div>
<div class="sourceLine" id="cb124-2" data-line-number="2"><span class="ex">yo</span> webapp</div></code></pre>
<h2 id="exec-webapp">exec WEBAPP</h2>
<pre class="sourceCode bash" id="cb125"><code class="sourceCode bash"><div class="sourceLine" id="cb125-1" data-line-number="1"><span class="ex">grunt</span> server</div></code></pre>
<h1 id="shell-script">SHELL SCRIPT</h1>
<h2 id="arg">ARG</h2>
<h3 id="arg-check">ARG CHECK</h3>
<pre class="sourceCode bash" id="cb126"><code class="sourceCode bash"><div class="sourceLine" id="cb126-1" data-line-number="1"><span class="co">#!/bin/env sh</span></div>
<div class="sourceLine" id="cb126-2" data-line-number="2"><span class="kw">if</span><span class="bu"> [</span> <span class="va">$#</span> <span class="ot">-ne</span> 2<span class="bu"> ]</span>; <span class="kw">then</span></div>
<div class="sourceLine" id="cb126-3" data-line-number="3">    <span class="bu">echo</span> usage: <span class="kw">`</span><span class="fu">basename</span> <span class="va">${0}</span><span class="kw">`</span> YYYY MO <span class="op">&gt;&amp;2</span></div>
<div class="sourceLine" id="cb126-4" data-line-number="4">    <span class="bu">exit</span> 1</div>
<div class="sourceLine" id="cb126-5" data-line-number="5"><span class="kw">fi</span></div>
<div class="sourceLine" id="cb126-6" data-line-number="6"><span class="va">ARG1=${1}</span></div>
<div class="sourceLine" id="cb126-7" data-line-number="7"><span class="va">ARG2=${2}</span></div></code></pre>
<h2 id="time">TIME</h2>
<h3 id="uptime-for-scriptbash">UPTIME for SCRIPT(bash)</h3>
<p>bash にはあらかじめ SECONDS ていう環境変数がある。</p>
<pre class="sourceCode bash" id="cb127"><code class="sourceCode bash"><div class="sourceLine" id="cb127-1" data-line-number="1"><span class="co">#!/bin/env bash</span></div>
<div class="sourceLine" id="cb127-2" data-line-number="2"><span class="va">SECONDS=</span>0</div>
<div class="sourceLine" id="cb127-3" data-line-number="3"><span class="fu">sleep</span> 3</div>
<div class="sourceLine" id="cb127-4" data-line-number="4"><span class="bu">echo</span> <span class="va">$SECONDS</span></div></code></pre>
<h2 id="quoteation">QUOTEATION</h2>
<pre class="sourceCode bash" id="cb128"><code class="sourceCode bash"><div class="sourceLine" id="cb128-1" data-line-number="1"><span class="va">AAA=</span>abc</div>
<div class="sourceLine" id="cb128-2" data-line-number="2"><span class="bu">echo</span> <span class="st">&quot;</span><span class="va">${AAA}</span><span class="st">&quot;</span> <span class="co"># 展開される</span></div>
<div class="sourceLine" id="cb128-3" data-line-number="3"><span class="bu">echo</span> <span class="st">&#39;${AAA}&#39;</span> <span class="co"># 展開されぬ</span></div></code></pre>
<h2 id="for">FOR</h2>
<h3 id="foreach">foreach</h3>
<pre class="sourceCode bash" id="cb129"><code class="sourceCode bash"><div class="sourceLine" id="cb129-1" data-line-number="1"><span class="kw">for</span> <span class="ex">num</span> in one two three<span class="kw">;</span> <span class="kw">do</span></div>
<div class="sourceLine" id="cb129-2" data-line-number="2">    <span class="bu">echo</span> <span class="va">${num}</span></div>
<div class="sourceLine" id="cb129-3" data-line-number="3"><span class="kw">done</span></div></code></pre>
<pre class="sourceCode bash" id="cb130"><code class="sourceCode bash"><div class="sourceLine" id="cb130-1" data-line-number="1"><span class="va">nums=</span><span class="st">&quot;one two three&quot;</span></div>
<div class="sourceLine" id="cb130-2" data-line-number="2"><span class="kw">for</span> <span class="ex">num</span> in <span class="va">${nums}</span><span class="kw">;</span> <span class="kw">do</span></div>
<div class="sourceLine" id="cb130-3" data-line-number="3">    <span class="bu">echo</span> <span class="va">${num}</span></div>
<div class="sourceLine" id="cb130-4" data-line-number="4"><span class="kw">done</span></div></code></pre>
<h3 id="range1..10">range(1..10)</h3>
<pre class="sourceCode bash" id="cb131"><code class="sourceCode bash"><div class="sourceLine" id="cb131-1" data-line-number="1"><span class="kw">for</span> <span class="ex">x</span> in <span class="kw">`</span><span class="fu">seq</span> 1 10<span class="kw">`;</span> <span class="kw">do</span></div>
<div class="sourceLine" id="cb131-2" data-line-number="2">    <span class="bu">echo</span> <span class="va">${x}</span></div>
<div class="sourceLine" id="cb131-3" data-line-number="3"><span class="kw">done</span></div></code></pre>
<h2 id="if">IF</h2>
<h3 id="file-not-exists">FILE NOT EXISTS</h3>
<pre class="sourceCode bash" id="cb132"><code class="sourceCode bash"><div class="sourceLine" id="cb132-1" data-line-number="1"><span class="kw">if</span><span class="bu"> [</span> <span class="ot">!</span> <span class="ot">-e</span> FILE<span class="bu"> ]</span>; <span class="kw">then</span></div>
<div class="sourceLine" id="cb132-2" data-line-number="2">   <span class="bu">echo</span> <span class="st">&#39;file not found&#39;</span></div>
<div class="sourceLine" id="cb132-3" data-line-number="3"><span class="kw">fi</span></div></code></pre>
<h3 id="string">STRING</h3>
<pre class="sourceCode bash" id="cb133"><code class="sourceCode bash"><div class="sourceLine" id="cb133-1" data-line-number="1"><span class="va">a=</span>aaa</div>
<div class="sourceLine" id="cb133-2" data-line-number="2"><span class="bu">[</span> <span class="va">$a</span> <span class="ot">==</span> <span class="st">&#39;aaa&#39;</span><span class="bu"> ]</span> ; <span class="bu">echo</span> <span class="va">$?</span>  # 0</div>
<div class="sourceLine" id="cb133-3" data-line-number="3"><span class="bu">[</span> <span class="va">$a</span> <span class="ot">!=</span> <span class="st">&#39;aaa&#39;</span><span class="bu"> ]</span> ; <span class="bu">echo</span> <span class="va">$?</span>  # 1</div></code></pre>
<h1 id="elastic-search">ELASTIC SEARCH</h1>
<script>window.addEventListener('load', function () {
new Vue({el:'#vesearch',data:{label:'',
host:'localhost:9200',
index:'myindex',
type:'mytype'
}});})</script>
<div id="vesearch">
<form class="form-horizontal">
<varin label="SERVICE HOST:PORT" v-model="host"></varin> <varin label="INDEX NAME"        v-model="index"></varin> <varin label="TYPE NAME"         v-model="type"></varin>
</form>
<h2 id="setup-1">Setup</h2>
<h4 id="ubuntu">ubuntu</h4>
<pre class="sourceCode bash" id="cb134"><code class="sourceCode bash"><div class="sourceLine" id="cb134-1" data-line-number="1"><span class="ex">sysctl</span> vm.max_map_count</div>
<div class="sourceLine" id="cb134-2" data-line-number="2"><span class="fu">sudo</span> sysctl -w vm.max_map_count=262144</div>
<div class="sourceLine" id="cb134-3" data-line-number="3"><span class="ex">sysctl</span> vm.max_map_count</div></code></pre>
<h2 id="metricbeat">Metricbeat</h2>
<h3 id="start-1">Start</h3>
<h4 id="ubuntu-1">ubuntu</h4>
<pre class="sourceCode bash" id="cb135"><code class="sourceCode bash"><div class="sourceLine" id="cb135-1" data-line-number="1"><span class="fu">sudo</span> ./metricbeat -e -c metricbeat.yml</div></code></pre>
<h4 id="macos">macOS</h4>
<pre class="sourceCode bash" id="cb136"><code class="sourceCode bash"><div class="sourceLine" id="cb136-1" data-line-number="1"><span class="fu">sudo</span> ./metricbeat -e -c metricbeat.yml -d <span class="st">&quot;publish&quot;</span></div></code></pre>
<h3 id="template">Template?</h3>
<pre class="sourceCode bash" id="cb137"><code class="sourceCode bash"><div class="sourceLine" id="cb137-1" data-line-number="1"><span class="ex">curl</span> -XPUT <span class="st">&#39;http://{{ host }}/_template/metricbeat&#39;</span> -d@/etc/metricbeat/metricbeat.template.json</div></code></pre>
<h3 id="kibana">Kibana</h3>
<h4 id="discover-index">Discover Index</h4>
<pre><code>metricbeat-*</code></pre>
<h4 id="create-dushbord">Create Dushbord</h4>
<h4 id="tar.gz">tar.gz</h4>
<pre class="sourceCode bash" id="cb139"><code class="sourceCode bash"><div class="sourceLine" id="cb139-1" data-line-number="1"><span class="ex">./scripts/import_dashboards</span></div></code></pre>
<h4 id="deb">deb</h4>
<pre class="sourceCode bash" id="cb140"><code class="sourceCode bash"><div class="sourceLine" id="cb140-1" data-line-number="1"><span class="ex">/usr/share/metricbeat/scripts</span></div></code></pre>
<h2 id="index">INDEX</h2>
<h3 id="list-3">List</h3>
<pre class="sourceCode bash" id="cb141"><code class="sourceCode bash"><div class="sourceLine" id="cb141-1" data-line-number="1"><span class="ex">curl</span> -XGET {{ host }}<span class="ex">/_aliases?pretty</span></div></code></pre>
<h3 id="create">create</h3>
<pre class="sourceCode bash" id="cb142"><code class="sourceCode bash"><div class="sourceLine" id="cb142-1" data-line-number="1"><span class="ex">curl</span> -XPUT <span class="st">&#39;http://{{ host }}/{{ index }}&#39;</span></div></code></pre>
<h3 id="look">look</h3>
<pre class="sourceCode bash" id="cb143"><code class="sourceCode bash"><div class="sourceLine" id="cb143-1" data-line-number="1"><span class="ex">curl</span> -XGET <span class="st">&#39;http://{{ host }}/{{ index }}?pretty=true&#39;</span></div></code></pre>
<h3 id="delete">delete</h3>
<pre class="sourceCode bash" id="cb144"><code class="sourceCode bash"><div class="sourceLine" id="cb144-1" data-line-number="1"><span class="ex">curl</span> -XDELETE <span class="st">&#39;http://{{ host }}/{{ index }}&#39;</span></div></code></pre>
<h2 id="type">TYPE</h2>
<h3 id="create-1">create</h3>
<pre class="sourceCode bash" id="cb145"><code class="sourceCode bash"><div class="sourceLine" id="cb145-1" data-line-number="1"><span class="ex">curl</span> -XPUT <span class="st">&#39;http://{{ host }}/{{ index }}/{{ type }}/_mapping&#39;</span>  -d @{{ type }}<span class="ex">.json</span></div></code></pre>
<h4 id="type-.json">{{ type }}.json</h4>
<pre class="sourceCode json" id="cb146"><code class="sourceCode json"><div class="sourceLine" id="cb146-1" data-line-number="1"><span class="fu">{</span></div>
<div class="sourceLine" id="cb146-2" data-line-number="2">    <span class="dt">&quot;{{ type }}&quot;</span><span class="fu">:{</span></div>
<div class="sourceLine" id="cb146-3" data-line-number="3">        <span class="dt">&quot;properties&quot;</span><span class="fu">:{</span></div>
<div class="sourceLine" id="cb146-4" data-line-number="4">            <span class="dt">&quot;@timestamp&quot;</span><span class="fu">:{</span></div>
<div class="sourceLine" id="cb146-5" data-line-number="5">                <span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;date&quot;</span></div>
<div class="sourceLine" id="cb146-6" data-line-number="6">                <span class="fu">,</span><span class="dt">&quot;format&quot;</span><span class="fu">:</span><span class="st">&quot;yyyy-MM-dd HH:mm:ss&quot;</span></div>
<div class="sourceLine" id="cb146-7" data-line-number="7">            <span class="fu">}</span></div>
<div class="sourceLine" id="cb146-8" data-line-number="8">            <span class="fu">,</span><span class="dt">&quot;srv&quot;</span>     <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">,</span> <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="st">&quot;not_analyzed&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-9" data-line-number="9">            <span class="fu">,</span><span class="dt">&quot;pid&quot;</span>     <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;integer&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-10" data-line-number="10">            <span class="fu">,</span><span class="dt">&quot;user&quot;</span>    <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">,</span> <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="st">&quot;not_analyzed&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-11" data-line-number="11">            <span class="fu">,</span><span class="dt">&quot;pr&quot;</span>      <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">,</span> <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="st">&quot;not_analyzed&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-12" data-line-number="12">            <span class="fu">,</span><span class="dt">&quot;ni&quot;</span>      <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;integer&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-13" data-line-number="13">            <span class="fu">,</span><span class="dt">&quot;virt&quot;</span>    <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;integer&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-14" data-line-number="14">            <span class="fu">,</span><span class="dt">&quot;res&quot;</span>     <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;integer&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-15" data-line-number="15">            <span class="fu">,</span><span class="dt">&quot;shr&quot;</span>     <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;integer&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-16" data-line-number="16">            <span class="fu">,</span><span class="dt">&quot;s&quot;</span>       <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">,</span> <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="st">&quot;not_analyzed&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-17" data-line-number="17">            <span class="fu">,</span><span class="dt">&quot;cpu&quot;</span>     <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;float&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-18" data-line-number="18">            <span class="fu">,</span><span class="dt">&quot;mem&quot;</span>     <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;float&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-19" data-line-number="19">            <span class="fu">,</span><span class="dt">&quot;times&quot;</span>   <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-20" data-line-number="20">            <span class="fu">,</span><span class="dt">&quot;cmd0&quot;</span>    <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">,</span> <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="st">&quot;not_analyzed&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-21" data-line-number="21">            <span class="fu">,</span><span class="dt">&quot;cmd&quot;</span>     <span class="fu">:{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">,</span> <span class="dt">&quot;index&quot;</span><span class="fu">:</span> <span class="st">&quot;not_analyzed&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb146-22" data-line-number="22">        <span class="fu">}</span></div>
<div class="sourceLine" id="cb146-23" data-line-number="23">    <span class="fu">}</span></div>
<div class="sourceLine" id="cb146-24" data-line-number="24"><span class="fu">}</span></div></code></pre>
<h3 id="look-1">look</h3>
<pre class="sourceCode bash" id="cb147"><code class="sourceCode bash"><div class="sourceLine" id="cb147-1" data-line-number="1"><span class="ex">curl</span> -XGET <span class="st">&#39;http://{{ host }}/{{ index }}/{{ type }}/_mapping?pretty=true&#39;</span></div></code></pre>
<h3 id="delete-1">delete</h3>
<pre class="sourceCode bash" id="cb148"><code class="sourceCode bash"><div class="sourceLine" id="cb148-1" data-line-number="1"><span class="ex">curl</span> -XGET <span class="st">&#39;http://{{ host }}/{{ index }}/{{ type }}&#39;</span></div></code></pre>
<h2 id="bulk-import">BULK IMPORT</h2>
<h4 id="importdatafile.json"><span class="citation" data-cites="IMPORTDATAFILE.json">@IMPORTDATAFILE.json</span></h4>
<pre class="sourceCode json" id="cb149"><code class="sourceCode json"><div class="sourceLine" id="cb149-1" data-line-number="1"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:{}}</span></div>
<div class="sourceLine" id="cb149-2" data-line-number="2"><span class="fu">{</span><span class="dt">&quot;@timestamp&quot;</span><span class="fu">:</span><span class="st">&quot;2014-11-01 00:01:01&quot;</span><span class="fu">,</span><span class="dt">&quot;srv&quot;</span><span class="fu">:</span><span class="st">&quot;srv_A&quot;</span><span class="fu">,</span><span class="dt">&quot;pid&quot;</span><span class="fu">:</span><span class="dv">2884</span><span class="fu">,</span><span class="dt">&quot;user&quot;</span><span class="fu">:</span><span class="st">&quot;oracle&quot;</span><span class="fu">,</span><span class="dt">&quot;pr&quot;</span><span class="fu">:</span><span class="st">&quot;15&quot;</span><span class="fu">,</span><span class="dt">&quot;ni&quot;</span><span class="fu">:</span><span class="st">&quot;0&quot;</span><span class="fu">,</span><span class="dt">&quot;virt&quot;</span><span class="fu">:</span><span class="dv">1589000</span><span class="fu">,</span><span class="dt">&quot;res&quot;</span><span class="fu">:</span><span class="dv">496000</span><span class="fu">,</span><span class="dt">&quot;shr&quot;</span><span class="fu">:</span><span class="dv">489000</span><span class="fu">,</span><span class="dt">&quot;s&quot;</span><span class="fu">:</span><span class="st">&quot;S&quot;</span><span class="fu">,</span><span class="dt">&quot;cpu&quot;</span><span class="fu">:</span><span class="fl">15.4</span><span class="fu">,</span><span class="dt">&quot;mem&quot;</span><span class="fu">:</span><span class="fl">10.0</span><span class="fu">,</span><span class="dt">&quot;times&quot;</span><span class="fu">:</span><span class="st">&quot;0:03.45&quot;</span><span class="fu">,</span><span class="dt">&quot;cmd0&quot;</span><span class="fu">:</span><span class="st">&quot;oracle&quot;</span><span class="fu">,</span><span class="dt">&quot;cmd&quot;</span><span class="fu">:</span><span class="st">&quot;oracle (LOCAL=NO)&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb149-3" data-line-number="3"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:{}}</span></div>
<div class="sourceLine" id="cb149-4" data-line-number="4"><span class="fu">{</span><span class="dt">&quot;@timestamp&quot;</span><span class="fu">:</span><span class="st">&quot;2014-11-01 00:01:01&quot;</span><span class="fu">,</span><span class="dt">&quot;srv&quot;</span><span class="fu">:</span><span class="st">&quot;srv_A&quot;</span><span class="fu">,</span><span class="dt">&quot;pid&quot;</span><span class="fu">:</span><span class="dv">10680</span><span class="fu">,</span><span class="dt">&quot;user&quot;</span><span class="fu">:</span><span class="st">&quot;oracle&quot;</span><span class="fu">,</span><span class="dt">&quot;pr&quot;</span><span class="fu">:</span><span class="st">&quot;16&quot;</span><span class="fu">,</span><span class="dt">&quot;ni&quot;</span><span class="fu">:</span><span class="st">&quot;0&quot;</span><span class="fu">,</span><span class="dt">&quot;virt&quot;</span><span class="fu">:</span><span class="dv">1603000</span><span class="fu">,</span><span class="dt">&quot;res&quot;</span><span class="fu">:</span><span class="dv">1000000</span><span class="fu">,</span><span class="dt">&quot;shr&quot;</span><span class="fu">:</span><span class="dv">1000000</span><span class="fu">,</span><span class="dt">&quot;s&quot;</span><span class="fu">:</span><span class="st">&quot;S&quot;</span><span class="fu">,</span><span class="dt">&quot;cpu&quot;</span><span class="fu">:</span><span class="fl">3.9</span><span class="fu">,</span><span class="dt">&quot;mem&quot;</span><span class="fu">:</span><span class="fl">27.4</span><span class="fu">,</span><span class="dt">&quot;times&quot;</span><span class="fu">:</span><span class="st">&quot;400:19.45&quot;</span><span class="fu">,</span><span class="dt">&quot;cmd0&quot;</span><span class="fu">:</span><span class="st">&quot;ora_j000&quot;</span><span class="fu">,</span><span class="dt">&quot;cmd&quot;</span><span class="fu">:</span><span class="st">&quot;ora_j000&quot;</span><span class="fu">}</span></div>
<div class="sourceLine" id="cb149-5" data-line-number="5"><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:{}}</span></div>
<div class="sourceLine" id="cb149-6" data-line-number="6"><span class="fu">{</span><span class="dt">&quot;@timestamp&quot;</span><span class="fu">:</span><span class="st">&quot;2014-11-01 00:01:01&quot;</span><span class="fu">,</span><span class="dt">&quot;srv&quot;</span><span class="fu">:</span><span class="st">&quot;srv_A&quot;</span><span class="fu">,</span><span class="dt">&quot;pid&quot;</span><span class="fu">:</span><span class="dv">4645</span><span class="fu">,</span><span class="dt">&quot;user&quot;</span><span class="fu">:</span><span class="st">&quot;root&quot;</span><span class="fu">,</span><span class="dt">&quot;pr&quot;</span><span class="fu">:</span><span class="st">&quot;15&quot;</span><span class="fu">,</span><span class="dt">&quot;ni&quot;</span><span class="fu">:</span><span class="st">&quot;0&quot;</span><span class="fu">,</span><span class="dt">&quot;virt&quot;</span><span class="fu">:</span><span class="dv">6276</span><span class="fu">,</span><span class="dt">&quot;res&quot;</span><span class="fu">:</span><span class="dv">948</span><span class="fu">,</span><span class="dt">&quot;shr&quot;</span><span class="fu">:</span><span class="dv">668</span><span class="fu">,</span><span class="dt">&quot;s&quot;</span><span class="fu">:</span><span class="st">&quot;R&quot;</span><span class="fu">,</span><span class="dt">&quot;cpu&quot;</span><span class="fu">:</span><span class="fl">1.9</span><span class="fu">,</span><span class="dt">&quot;mem&quot;</span><span class="fu">:</span><span class="fl">0.0</span><span class="fu">,</span><span class="dt">&quot;times&quot;</span><span class="fu">:</span><span class="st">&quot;0:00.01&quot;</span><span class="fu">,</span><span class="dt">&quot;cmd0&quot;</span><span class="fu">:</span><span class="st">&quot;top&quot;</span><span class="fu">,</span><span class="dt">&quot;cmd&quot;</span><span class="fu">:</span><span class="st">&quot;top -b -n 1 -c&quot;</span><span class="fu">}</span></div></code></pre>
<h3 id="normal-size">NORMAL SIZE</h3>
<pre class="sourceCode bash" id="cb150"><code class="sourceCode bash"><div class="sourceLine" id="cb150-1" data-line-number="1"><span class="ex">curl</span> -XPOST <span class="st">&#39;http://{{ host }}/{{ index }}/{{ type }}/_bulk&#39;</span> --data-binary @IMPORTDATAFILE.json  <span class="op">&gt;</span> /dev/null</div></code></pre>
<h3 id="laerge-sizesplit">LAERGE SIZE(SPLIT)</h3>
<pre class="sourceCode bash" id="cb151"><code class="sourceCode bash"><div class="sourceLine" id="cb151-1" data-line-number="1"><span class="fu">split</span> IMPORTDATAFILE.json -l 100000</div>
<div class="sourceLine" id="cb151-2" data-line-number="2"><span class="bu">time</span> for f in x??<span class="kw">;</span> <span class="kw">do</span> <span class="ex">curl</span> -XPOST <span class="st">&#39;http://{{ host }}/{{ index }}/{{ type }}/_bulk&#39;</span> --data-binary @<span class="va">$f</span> <span class="op">&gt;</span> /dev/null<span class="kw">;</span> <span class="kw">done</span></div>
<div class="sourceLine" id="cb151-3" data-line-number="3"><span class="fu">rm</span> -f x??</div></code></pre>
<h2 id="search-1">SEARCH</h2>
<pre class="sourceCode bash" id="cb152"><code class="sourceCode bash"><div class="sourceLine" id="cb152-1" data-line-number="1"><span class="ex">curl</span> -XGET <span class="st">&#39;http://{{ host }}/{{ index }}/{{ type }}/_search&#39;</span></div></code></pre>
</div>
<h1 id="bz2">BZ2</h1>
<h3 id="extract">EXTRACT</h3>
<pre class="sourceCode bash" id="cb153"><code class="sourceCode bash"><div class="sourceLine" id="cb153-1" data-line-number="1"><span class="fu">tar</span> jxvf FILE.tar.bz2</div></code></pre>
<h1 id="node">NODE</h1>
<h2 id="npm">npm</h2>
<h3 id="order-package">order PACKAGE</h3>
<h4 id="package.json">package.json</h4>
<p>dependencies に追加していく</p>
<pre class="sourceCode json" id="cb154"><code class="sourceCode json"><div class="sourceLine" id="cb154-1" data-line-number="1"><span class="fu">{</span></div>
<div class="sourceLine" id="cb154-2" data-line-number="2">  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;tw&quot;</span><span class="fu">,</span></div>
<div class="sourceLine" id="cb154-3" data-line-number="3">  <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="st">&quot;1.0.0&quot;</span><span class="fu">,</span></div>
<div class="sourceLine" id="cb154-4" data-line-number="4">  <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;&quot;</span><span class="fu">,</span></div>
<div class="sourceLine" id="cb154-5" data-line-number="5">  <span class="dt">&quot;main&quot;</span><span class="fu">:</span> <span class="st">&quot;index.js&quot;</span><span class="fu">,</span></div>
<div class="sourceLine" id="cb154-6" data-line-number="6">  <span class="dt">&quot;scripts&quot;</span><span class="fu">:</span> <span class="fu">{</span></div>
<div class="sourceLine" id="cb154-7" data-line-number="7">    <span class="dt">&quot;test&quot;</span><span class="fu">:</span> <span class="st">&quot;echo </span><span class="ch">\&quot;</span><span class="st">Error: no test specified</span><span class="ch">\&quot;</span><span class="st"> &amp;&amp; exit 1&quot;</span></div>
<div class="sourceLine" id="cb154-8" data-line-number="8">  <span class="fu">},</span></div>
<div class="sourceLine" id="cb154-9" data-line-number="9">  <span class="dt">&quot;author&quot;</span><span class="fu">:</span> <span class="st">&quot;&quot;</span><span class="fu">,</span></div>
<div class="sourceLine" id="cb154-10" data-line-number="10">  <span class="dt">&quot;license&quot;</span><span class="fu">:</span> <span class="st">&quot;ISC&quot;</span><span class="fu">,</span></div>
<div class="sourceLine" id="cb154-11" data-line-number="11">  <span class="dt">&quot;dependencies&quot;</span><span class="fu">:</span> <span class="fu">{</span></div>
<div class="sourceLine" id="cb154-12" data-line-number="12">    <span class="dt">&quot;ntwitter&quot;</span><span class="fu">:</span> <span class="st">&quot;~0.5.0&quot;</span></div>
<div class="sourceLine" id="cb154-13" data-line-number="13">  <span class="fu">}</span></div>
<div class="sourceLine" id="cb154-14" data-line-number="14"><span class="fu">}</span></div></code></pre>
<h3 id="package-install">PACKAGE INSTALL</h3>
<p>bundler と違ってデフォルトでローカル ./node_modules/ にダウンロードされる</p>
<pre class="sourceCode bash" id="cb155"><code class="sourceCode bash"><div class="sourceLine" id="cb155-1" data-line-number="1"><span class="ex">npm</span> install</div></code></pre>
<h1 id="cassandra">CASSANDRA</h1>
<h2 id="cqlsh">CQLSH</h2>
<h3 id="exec-cql-file">exec CQL file</h3>
<pre class="sourceCode bash" id="cb156"><code class="sourceCode bash"><div class="sourceLine" id="cb156-1" data-line-number="1"><span class="ex">cqlsh</span> HOSTNAME -f FILENAME</div></code></pre>
<h3 id="cluster-status">CLUSTER STATUS</h3>
<pre class="sourceCode bash" id="cb157"><code class="sourceCode bash"><div class="sourceLine" id="cb157-1" data-line-number="1"><span class="ex">nodetool</span> status KEYSPACE</div></code></pre>
<h1 id="tcpdump">TCPDUMP</h1>
<pre class="sourceCode bash" id="cb158"><code class="sourceCode bash"><div class="sourceLine" id="cb158-1" data-line-number="1"><span class="ex">tcpdump</span> -Xs 256 -n -i eth1 dst port 50012</div></code></pre>
<h1 id="scheme">SCHEME</h1>
<h2 id="list-4">LIST</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">OPE</th>
<th style="text-align: center;">内容</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(car LIST)</td>
<td style="text-align: center;">リストの先頭要素を返す</td>
</tr>
<tr class="even">
<td style="text-align: left;">(cdr LIST)</td>
<td style="text-align: center;">リストの先頭要素を除いた要素を返す</td>
</tr>
</tbody>
</table>
<h1 id="closure">CLOSURE</h1>
<h2 id="what">What</h2>
<p>関数そのものに値を保持する仕組み。これが無いと大域汚染を伴うクラスやグローバル変数を使うことになる。この大域汚染は、特に複数のサードパーティライブラリを組み合わせる際に問題となる。</p>
<p>なので、データセットのダーティフラグとかしょうもない用事には CLOSURE を使う。</p>
<h3 id="examplejavascript">example:javascript</h3>
<pre class="sourceCode javascript" id="cb159"><code class="sourceCode javascript"><div class="sourceLine" id="cb159-1" data-line-number="1"><span class="co">#!/bin/env node</span></div>
<div class="sourceLine" id="cb159-2" data-line-number="2"></div>
<div class="sourceLine" id="cb159-3" data-line-number="3"><span class="kw">function</span> <span class="at">outer</span>(n) <span class="op">{</span></div>
<div class="sourceLine" id="cb159-4" data-line-number="4">    <span class="kw">var</span> x <span class="op">=</span> n<span class="op">;</span></div>
<div class="sourceLine" id="cb159-5" data-line-number="5">    <span class="cf">return</span> <span class="kw">function</span>() <span class="op">{</span></div>
<div class="sourceLine" id="cb159-6" data-line-number="6">        <span class="va">console</span>.<span class="at">log</span>(x)<span class="op">;</span></div>
<div class="sourceLine" id="cb159-7" data-line-number="7">        x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></div>
<div class="sourceLine" id="cb159-8" data-line-number="8">    <span class="op">};</span></div>
<div class="sourceLine" id="cb159-9" data-line-number="9"><span class="op">}</span></div>
<div class="sourceLine" id="cb159-10" data-line-number="10"></div>
<div class="sourceLine" id="cb159-11" data-line-number="11"><span class="kw">var</span> f1 <span class="op">=</span> <span class="at">outer</span>(<span class="dv">1</span>)<span class="op">;</span></div>
<div class="sourceLine" id="cb159-12" data-line-number="12"><span class="kw">var</span> f2 <span class="op">=</span> <span class="at">outer</span>(<span class="dv">11</span>)<span class="op">;</span></div>
<div class="sourceLine" id="cb159-13" data-line-number="13"></div>
<div class="sourceLine" id="cb159-14" data-line-number="14"><span class="at">f1</span>()<span class="op">;</span></div>
<div class="sourceLine" id="cb159-15" data-line-number="15"><span class="at">f1</span>()<span class="op">;</span></div>
<div class="sourceLine" id="cb159-16" data-line-number="16"><span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;---&quot;</span>)</div>
<div class="sourceLine" id="cb159-17" data-line-number="17"><span class="at">f2</span>()<span class="op">;</span></div>
<div class="sourceLine" id="cb159-18" data-line-number="18"><span class="at">f2</span>()<span class="op">;</span></div>
<div class="sourceLine" id="cb159-19" data-line-number="19"><span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;---&quot;</span>)</div>
<div class="sourceLine" id="cb159-20" data-line-number="20"><span class="at">f1</span>()<span class="op">;</span></div>
<div class="sourceLine" id="cb159-21" data-line-number="21"><span class="at">f1</span>()<span class="op">;</span></div></code></pre>
<pre class="sourceCode bash" id="cb160"><code class="sourceCode bash"><div class="sourceLine" id="cb160-1" data-line-number="1">$ <span class="ex">node</span> ./closure.js</div>
<div class="sourceLine" id="cb160-2" data-line-number="2"><span class="ex">1</span></div>
<div class="sourceLine" id="cb160-3" data-line-number="3"><span class="ex">2</span></div>
<div class="sourceLine" id="cb160-4" data-line-number="4"><span class="ex">---</span></div>
<div class="sourceLine" id="cb160-5" data-line-number="5"><span class="ex">11</span></div>
<div class="sourceLine" id="cb160-6" data-line-number="6"><span class="ex">12</span></div>
<div class="sourceLine" id="cb160-7" data-line-number="7"><span class="ex">---</span></div>
<div class="sourceLine" id="cb160-8" data-line-number="8"><span class="ex">3</span></div>
<div class="sourceLine" id="cb160-9" data-line-number="9"><span class="ex">4</span></div></code></pre>
<h1 id="python-4">PYTHON</h1>
<h2 id="httpd">HTTPD</h2>
<pre class="sourceCode bash" id="cb161"><code class="sourceCode bash"><div class="sourceLine" id="cb161-1" data-line-number="1"><span class="ex">python</span> -m SimpleHTTPServer 12345</div></code></pre>
<h2 id="date-time">DATE &amp; TIME</h2>
<h3 id="what-time-now">what time now</h3>
<pre class="sourceCode python" id="cb162"><code class="sourceCode python"><div class="sourceLine" id="cb162-1" data-line-number="1"><span class="im">import</span> datetime</div>
<div class="sourceLine" id="cb162-2" data-line-number="2">datetime.datetime.today().strftime(<span class="st">&#39;%Y-%m-</span><span class="sc">%d</span><span class="st">_%H-%M-%S&#39;</span>)</div></code></pre>
<h1 id="crudsqlrest">CRUD/SQL/REST</h1>
<h2 id="basics-1">BASICs</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">OPE</th>
<th style="text-align: left;">CRUD</th>
<th style="text-align: left;">SQL</th>
<th style="text-align: left;">REST</th>
<th style="text-align: left;">$http</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">追加</td>
<td style="text-align: left;">Create</td>
<td style="text-align: left;">insert</td>
<td style="text-align: left;">post</td>
<td style="text-align: left;">BODY</td>
</tr>
<tr class="even">
<td style="text-align: left;">取得</td>
<td style="text-align: left;">Read</td>
<td style="text-align: left;">select</td>
<td style="text-align: left;">get</td>
<td style="text-align: left;">URI</td>
</tr>
<tr class="odd">
<td style="text-align: left;">更新</td>
<td style="text-align: left;">Update</td>
<td style="text-align: left;">update</td>
<td style="text-align: left;">put</td>
<td style="text-align: left;">BODY</td>
</tr>
<tr class="even">
<td style="text-align: left;">削除</td>
<td style="text-align: left;">Delete</td>
<td style="text-align: left;">delete</td>
<td style="text-align: left;">delete</td>
<td style="text-align: left;">URI</td>
</tr>
</tbody>
</table>
<h1 id="nkf">NKF</h1>
<h3 id="改行変換">改行変換</h3>
<h4 id="from-win">from Win</h4>
<pre class="sourceCode bash" id="cb163"><code class="sourceCode bash"><div class="sourceLine" id="cb163-1" data-line-number="1"><span class="fu">perl</span> -pe <span class="st">&#39;s/\r//&#39;</span> Win.txt <span class="op">&gt;</span> UNIX.txt</div></code></pre>
<pre class="sourceCode bash" id="cb164"><code class="sourceCode bash"><div class="sourceLine" id="cb164-1" data-line-number="1"><span class="ex">nkf</span> -Lu AAA.txt</div></code></pre>
<h4 id="from-unix">from UNIX</h4>
<pre class="sourceCode bash" id="cb165"><code class="sourceCode bash"><div class="sourceLine" id="cb165-1" data-line-number="1"><span class="fu">perl</span> -pe <span class="st">&#39;s/\n/\r\n/&#39;</span> UNIX.txt <span class="op">&gt;</span> Win.txt</div></code></pre>
<h1 id="wget">WGET</h1>
<h2 id="ftp">FTP</h2>
<h3 id="ftp-get">FTP GET</h3>
<script>window.addEventListener('load', function () {
new Vue({el:'#vwgetftp',data:{label:''
,ftpserver : 'ftpserver'
,ftpuser   : 'user'
,ftppass   : 'passwd'
,fname     : 'getfilename'
}});})</script>
<div id="vwgetftp">
<form class="form-horizontal">
<varin label="ftp server" v-model="ftpserver"></varin> <varin label="ftp user" v-model="ftpuser"></varin> <varin label="ftp pass" v-model="ftppass"></varin> <varin label="file name" v-model="fname"></varin>
</form>
<pre class="sourceCode bash" id="cb166"><code class="sourceCode bash"><div class="sourceLine" id="cb166-1" data-line-number="1"><span class="fu">wget</span> --ftp-user=<span class="dt">{{ftpuser}}</span> --ftp-password=<span class="dt">{{ftppass}}</span> ftp://<span class="dt">{{ftpserver}}/{{fname}}</span></div></code></pre>
</div>
<h1 id="sqlite3">SQLITE3</h1>
<script>window.addEventListener('load', function () {
new Vue({el:'#vsqlite',data:{label:''
,SQLITE_DB_NAME : 'MYDB'
,SQLITE_TAB_NAME: 'MYTAB'
,SQLITE_SQL_FILE: 'MYFILE'
}});})</script>
<div id="vsqlite">
<form class="form-horizontal">
<varin label="DATABASE NAME" v-model="SQLITE_DB_NAME"></varin> <varin label="TABLE NAME" v-model="SQLITE_TAB_NAME"></varin> <varin label="SQL-FILE NAME" v-model="SQLITE_SQL_FILE"></varin>
</form>
<h2 id="database-1">DATABASE</h2>
<h3 id="createconnect-database">create/connect DATABASE</h3>
<pre class="sourceCode bash" id="cb167"><code class="sourceCode bash"><div class="sourceLine" id="cb167-1" data-line-number="1"><span class="ex">sqlite3</span> <span class="dt">{{SQLITE_DB_NAME}}</span>.sqlite3</div></code></pre>
<pre class="sourceCode sql" id="cb168"><code class="sourceCode sql"><div class="sourceLine" id="cb168-1" data-line-number="1">.databases</div></code></pre>
<h2 id="table-1">TABLE</h2>
<h3 id="csv-data-import">CSV DATA IMPORT</h3>
<pre class="sourceCode sql" id="cb169"><code class="sourceCode sql"><div class="sourceLine" id="cb169-1" data-line-number="1">.separator ,</div>
<div class="sourceLine" id="cb169-2" data-line-number="2">.import <span class="kw">FILE</span> TAB</div></code></pre>
<h3 id="list-5">LIST</h3>
<pre class="sourceCode sql" id="cb170"><code class="sourceCode sql"><div class="sourceLine" id="cb170-1" data-line-number="1">.tables</div></code></pre>
<pre class="sourceCode sql" id="cb171"><code class="sourceCode sql"><div class="sourceLine" id="cb171-1" data-line-number="1"><span class="kw">select</span> name <span class="kw">from</span> sqlite_master <span class="kw">where</span> type=<span class="st">&#39;table&#39;</span> <span class="kw">order</span> <span class="kw">by</span> name;</div></code></pre>
<pre class="sourceCode sql" id="cb172"><code class="sourceCode sql"><div class="sourceLine" id="cb172-1" data-line-number="1"><span class="kw">select</span> <span class="st">&#39;.import ./csv/&#39;</span> || name || <span class="st">&#39;.csv &#39;</span> || name <span class="kw">from</span> sqlite_master <span class="kw">where</span> type=<span class="st">&#39;table&#39;</span> <span class="kw">order</span> <span class="kw">by</span> name;</div></code></pre>
<h3 id="sql-from-file">SQL from FILE</h3>
<pre class="sourceCode sql" id="cb173"><code class="sourceCode sql"><div class="sourceLine" id="cb173-1" data-line-number="1">.read {{SQLITE_SQL_FILE}}</div></code></pre>
<pre class="sourceCode sql" id="cb174"><code class="sourceCode sql"><div class="sourceLine" id="cb174-1" data-line-number="1">sqlite3 {{SQLITE_DB_NAME}} &lt; {{SQLITE_SQL_FILE}}</div></code></pre>
<h3 id="create-2">CREATE</h3>
<pre class="sourceCode sql" id="cb175"><code class="sourceCode sql"><div class="sourceLine" id="cb175-1" data-line-number="1"><span class="kw">create</span> <span class="kw">table</span> {{SQLITE_TAB_NAME}} (</div>
<div class="sourceLine" id="cb175-2" data-line-number="2">    <span class="kw">id</span> <span class="dt">integer</span> <span class="kw">not</span> <span class="kw">null</span> <span class="kw">primary</span> <span class="kw">key</span></div>
<div class="sourceLine" id="cb175-3" data-line-number="3">  , name text</div>
<div class="sourceLine" id="cb175-4" data-line-number="4">  , notype</div>
<div class="sourceLine" id="cb175-5" data-line-number="5">  , ts <span class="dt">timestamp</span> <span class="kw">default</span> (datetime(<span class="st">&#39;now&#39;</span>, <span class="st">&#39;localtaime&#39;</span>))</div>
<div class="sourceLine" id="cb175-6" data-line-number="6">);</div></code></pre>
<h3 id="drop">DROP</h3>
<pre class="sourceCode sql" id="cb176"><code class="sourceCode sql"><div class="sourceLine" id="cb176-1" data-line-number="1"><span class="kw">create</span> <span class="kw">table</span> {{SQLITE_TAB_NAME}};</div></code></pre>
<h3 id="source">SOURCE</h3>
<pre class="sourceCode sql" id="cb177"><code class="sourceCode sql"><div class="sourceLine" id="cb177-1" data-line-number="1">.schema {{SQLITE_TAB_NAME}}</div></code></pre>
</div>
<h1 id="emacs">EMACS</h1>
<h3 id="replace-cr">REPLACE &amp; CR</h3>
<p>M-% するときに、C-q C-j で改行挿入</p>
<h3 id="rect">RECT</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">key</th>
<th style="text-align: center;">move</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">C-x r k</td>
<td style="text-align: center;">矩形領域カット</td>
</tr>
<tr class="even">
<td style="text-align: center;">C-x r y</td>
<td style="text-align: center;">矩形領域ペースト</td>
</tr>
</tbody>
</table>
<h3 id="packeage">PACKEAGE</h3>
<p>M-x packeage-list-packeage</p>
<h1 id="ruby-1">RUBY</h1>
<h2 id="rbenv">rbenv</h2>
<h3 id="install-5">install</h3>
<p>git clone</p>
<h3 id="available-versions">available versions</h3>
<pre class="sourceCode bash" id="cb178"><code class="sourceCode bash"><div class="sourceLine" id="cb178-1" data-line-number="1"><span class="ex">rbenv</span> install --list</div></code></pre>
<h3 id="install-6">install</h3>
<pre class="sourceCode bash" id="cb179"><code class="sourceCode bash"><div class="sourceLine" id="cb179-1" data-line-number="1"><span class="ex">rbenv</span> install 2.1.2</div></code></pre>
<h3 id="init">init</h3>
<pre class="sourceCode bash" id="cb180"><code class="sourceCode bash"><div class="sourceLine" id="cb180-1" data-line-number="1"><span class="ex">rbenv</span> global 2.1.2</div></code></pre>
<h2 id="ruby-build">ruby-build</h2>
<h3 id="install-7">install</h3>
<pre class="sourceCode bash" id="cb181"><code class="sourceCode bash"><div class="sourceLine" id="cb181-1" data-line-number="1"><span class="fu">git</span> clone https://github.com/sstephenson/ruby-build.git .ruby-build</div>
<div class="sourceLine" id="cb181-2" data-line-number="2"><span class="ex">.ruby-build/install.sh</span></div></code></pre>
<pre class="sourceCode bash" id="cb182"><code class="sourceCode bash"><div class="sourceLine" id="cb182-1" data-line-number="1"><span class="fu">rm</span> -fr .ruby-build</div></code></pre>
<h3 id="install-version">install version</h3>
<pre class="sourceCode bash" id="cb183"><code class="sourceCode bash"><div class="sourceLine" id="cb183-1" data-line-number="1"><span class="ex">ruby-build</span> 2.1.2 /usr/local</div></code></pre>
<h3 id="bundler">BUNDLER</h3>
<h4 id="init-1">init</h4>
<pre class="sourceCode bash" id="cb184"><code class="sourceCode bash"><div class="sourceLine" id="cb184-1" data-line-number="1"><span class="ex">bundle</span> init</div></code></pre>
<h4 id="install-gems">install GEMS</h4>
<pre class="sourceCode bash" id="cb185"><code class="sourceCode bash"><div class="sourceLine" id="cb185-1" data-line-number="1"><span class="ex">bundle</span> install --path=vendor/bundle</div></code></pre>
<h4 id="exec">exec</h4>
<pre class="sourceCode bash" id="cb186"><code class="sourceCode bash"><div class="sourceLine" id="cb186-1" data-line-number="1"><span class="ex">bundle</span> exec ruby app.rb</div></code></pre>
<h2 id="json">JSON</h2>
<p>パースするとき no ASCII とかいわれたら。</p>
<pre class="sourceCode bash" id="cb187"><code class="sourceCode bash"><div class="sourceLine" id="cb187-1" data-line-number="1"><span class="bu">export</span> <span class="va">LANG=</span>en_US.UTF8</div>
<div class="sourceLine" id="cb187-2" data-line-number="2"><span class="ex">locale</span></div></code></pre>
<p>ssh はログイン元の環境変数(LANG)を引継ぐため、意図せず “ja_JP.UTF-8” になってしまう。</p>
<h1 id="linux">LINUX</h1>
<h2 id="use-disc-media">USE DISC MEDIA</h2>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-diskimage',data:{label:''
,ISO_FILEPATH: 'medianame.iso'
,ISO_MOUNTPOINT: '/mnt/dvd'
}});})</script>
<div id="app-diskimage">
<form class="form-horizontal">
<varin label="ISO FILE NAME" v-model="ISO_FILEPATH"></varin> <varin label="MOUNT POINT" v-model="ISO_MOUNTPOINT"></varin>
</form>
<h4 id="iso-to-dvd">ISO to DVD</h4>
<pre class="sourceCode bash" id="cb188"><code class="sourceCode bash"><div class="sourceLine" id="cb188-1" data-line-number="1"><span class="ex">growisofs</span> -dvd-compat -Z /dev/dvdrw=<span class="dt">{{ISO_FILEPATH}}</span></div></code></pre>
<h4 id="dir-to-iso">dir to iso</h4>
<pre class="sourceCode bash" id="cb189"><code class="sourceCode bash"><div class="sourceLine" id="cb189-1" data-line-number="1"><span class="ex">genisoimage</span> -allow-limited-size -o DIRNAME.iso DIRNAME</div></code></pre>
<h4 id="disc-to-iso-file">DISC to ISO FILE</h4>
<pre class="sourceCode bash" id="cb190"><code class="sourceCode bash"><div class="sourceLine" id="cb190-1" data-line-number="1"><span class="fu">dd</span> if=/dev/sr0 of=<span class="dt">{{ISO_FILEPATH}}</span></div></code></pre>
<h4 id="mount-iso-file">MOUNT ISO FILE</h4>
<pre class="sourceCode bash" id="cb191"><code class="sourceCode bash"><div class="sourceLine" id="cb191-1" data-line-number="1"><span class="fu">mkdir</span> -p <span class="dt">{{ISO_MOUNTPOINT}}</span></div>
<div class="sourceLine" id="cb191-2" data-line-number="2"><span class="fu">mount</span> -t iso9660 -o loop <span class="dt">{{ISO_FILEPATH}}</span> <span class="dt">{{ISO_MOUNTPOINT}}</span></div></code></pre>
<p>umount</p>
<pre class="sourceCode bash" id="cb192"><code class="sourceCode bash"><div class="sourceLine" id="cb192-1" data-line-number="1"><span class="fu">umount</span> <span class="dt">{{ISO_MOUNTPOINT}}</span></div></code></pre>
<p>永続化</p>
<h6 id="etcfstab">/etc/fstab</h6>
<pre class="sourceCode bash" id="cb193"><code class="sourceCode bash"><div class="sourceLine" id="cb193-1" data-line-number="1"><span class="bu">echo</span> <span class="st">&quot;{{ISO_FILEPATH}} {{ISO_MOUNTPOINT}} iso9660 loop,ro,auto 0 0&quot;</span> <span class="op">&gt;&gt;</span> /etc/fstab</div>
<div class="sourceLine" id="cb193-2" data-line-number="2"><span class="fu">cat</span> /etc/fstab</div>
<div class="sourceLine" id="cb193-3" data-line-number="3"><span class="fu">mount</span> -a</div></code></pre>
</div>
<h2 id="lock-tray">LOCK TRAY?</h2>
<p>VirtualBox やらの VM が邪魔してる場合あり。とめよ。</p>
<h2 id="make-swap">MAKE SWAP</h2>
<h3 id="on-file">on FILE</h3>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-make-swap',data:{label:''
,LINUX_SWAP_FILE: '/swapfile'
}});})</script>
<div id="app-make-swap">
<form class="form-horizontal">
<varin label="FILE NAME" v-model="LINUX_SWAP_FILE"></varin>
</form>
<p>example 255MB(4096x65536)</p>
<pre class="sourceCode bash" id="cb194"><code class="sourceCode bash"><div class="sourceLine" id="cb194-1" data-line-number="1"><span class="fu">dd</span> if=/dev/zero  of=<span class="dt">{{LINUX_SWAP_FILE}}</span> bs=4096 count=65536</div>
<div class="sourceLine" id="cb194-2" data-line-number="2"><span class="va">mkswap=</span><span class="dt">{{LINUX_SWAP_FILE}}</span></div>
<div class="sourceLine" id="cb194-3" data-line-number="3"><span class="fu">chmod</span> 600 <span class="dt">{{LINUX_SWAP_FILE}}</span></div>
<div class="sourceLine" id="cb194-4" data-line-number="4"><span class="ex">swapon</span> <span class="dt">{{LINUX_SWAP_FILE}}</span></div></code></pre>
<h4 id="etcfstab-1">/etc/fstab</h4>
<pre class="sourceCode bash" id="cb195"><code class="sourceCode bash"><div class="sourceLine" id="cb195-1" data-line-number="1"><span class="dt">{{LINUX_SWAP_FILE}}</span> <span class="ex">swap</span> swap defaults</div></code></pre>
</div>
<h1 id="p2v">P2V</h1>
<h2 id="physical-drive-to-image-file">physical drive to image file</h2>
<h3 id="physical-drive-のセクタサイズを調べる">physical drive のセクタサイズを調べる</h3>
<pre class="sourceCode bash" id="cb196"><code class="sourceCode bash"><div class="sourceLine" id="cb196-1" data-line-number="1"><span class="fu">sudo</span> fdisk -l /dev/sda</div></code></pre>
<h4 id="出力例">出力例</h4>
<pre class="sourceCode bash" id="cb197"><code class="sourceCode bash"><div class="sourceLine" id="cb197-1" data-line-number="1">ディスク <span class="ex">/dev</span>/sda: <span class="ex">500.1</span> GB, 500107862016 バイト</div>
<div class="sourceLine" id="cb197-2" data-line-number="2">ヘッド <span class="ex">255</span>, セクタ 63, シリンダ 60801</div>
<div class="sourceLine" id="cb197-3" data-line-number="3"><span class="ex">Units</span> = シリンダ数 of 16065 * 512 = 8225280 バイト</div>
<div class="sourceLine" id="cb197-4" data-line-number="4">セクタサイズ <span class="kw">(</span>論理 <span class="ex">/</span> 物理<span class="kw">)</span><span class="bu">:</span> 512 バイト / 512 バイト</div>
<div class="sourceLine" id="cb197-5" data-line-number="5"><span class="ex">I/O</span> size (minimum/optimal)<span class="bu">:</span> 512 bytes / 512 bytes</div>
<div class="sourceLine" id="cb197-6" data-line-number="6">ディスク識別子: <span class="ex">0x6f16023a</span></div>
<div class="sourceLine" id="cb197-7" data-line-number="7"></div>
<div class="sourceLine" id="cb197-8" data-line-number="8">デバイス ブート      始点        終点     ブロック   <span class="ex">Id</span>  システム</div>
<div class="sourceLine" id="cb197-9" data-line-number="9"><span class="ex">/dev/sda1</span>   *           1          64      512000   83  Linux</div>
<div class="sourceLine" id="cb197-10" data-line-number="10">パーティション <span class="ex">1</span> は、シリンダ境界で終わっていません。</div>
<div class="sourceLine" id="cb197-11" data-line-number="11"><span class="ex">/dev/sda2</span>              64      121602   976254976   8e  Linux LVM</div></code></pre>
<h3 id="dd-コマンドでイメージファイル化">dd コマンドでイメージファイル化</h3>
<pre class="sourceCode bash" id="cb198"><code class="sourceCode bash"><div class="sourceLine" id="cb198-1" data-line-number="1"><span class="fu">dd</span> bs=セクタサイズ if=/dev/sda of=sda.dd conv=sync,noerror</div></code></pre>
<pre class="sourceCode bash" id="cb199"><code class="sourceCode bash"><div class="sourceLine" id="cb199-1" data-line-number="1"><span class="fu">dd</span> bs=セクタサイズ if=/dev/sda conv=sync,noerror <span class="kw">|</span> <span class="fu">gzip</span> -c9 <span class="op">&gt;</span> sda.dd.gz</div></code></pre>
<h5 id="dd-の進捗表示">dd の進捗表示</h5>
<pre class="sourceCode bash" id="cb200"><code class="sourceCode bash"><div class="sourceLine" id="cb200-1" data-line-number="1"><span class="fu">sudo</span> watch -n 60 <span class="st">&quot;pkill -USER1 dd&quot;</span></div></code></pre>
<h4 id="イメージファイルの中身確認">イメージファイルの中身確認</h4>
<h5 id="パーティションテーブル">パーティションテーブル</h5>
<pre class="sourceCode bash" id="cb201"><code class="sourceCode bash"><div class="sourceLine" id="cb201-1" data-line-number="1"><span class="ex">fdisk</span> -l sda.dd</div></code></pre>
<h5 id="マウントしてみる">マウントしてみる</h5>
<h2 id="image-file-to-vdi">image file to VDI</h2>
<p>自動的に圧縮（最小化ではない）される。</p>
<pre class="sourceCode bash" id="cb202"><code class="sourceCode bash"><div class="sourceLine" id="cb202-1" data-line-number="1"><span class="ex">vboxmanage</span> convertfromraw sda.dd sda.vdi</div></code></pre>
<h2 id="参考情報">参考情報</h2>
<h3 id="fsck-とかで起動しない場合">fsck とかで起動しない場合</h3>
<pre class="sourceCode bash" id="cb203"><code class="sourceCode bash"><div class="sourceLine" id="cb203-1" data-line-number="1"><span class="fu">mount</span> -o remount,rw</div></code></pre>
<h3 id="ゼロ埋め">ゼロ埋め</h3>
<p>対象ドライブに cd して、</p>
<pre class="sourceCode bash" id="cb204"><code class="sourceCode bash"><div class="sourceLine" id="cb204-1" data-line-number="1"><span class="fu">dd</span> if=/dev/zero of=zero bs=4k<span class="kw">;</span> \<span class="fu">rm</span> zero</div></code></pre>
<h3 id="圧縮">圧縮</h3>
<pre class="sourceCode bash" id="cb205"><code class="sourceCode bash"><div class="sourceLine" id="cb205-1" data-line-number="1"><span class="ex">vboxmanage</span> modifyhd sda.vdi --compact</div></code></pre>
<h1 id="tmux">TMUX</h1>
<h2 id="config">Config</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Triger(Ctr+[b]…)</th>
<th style="text-align: left;">Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">:source-file ~/.tmux.conf</td>
<td style="text-align: left;">設定反映</td>
</tr>
</tbody>
</table>
<h2 id="session">Session</h2>
<p>プロジェクト単位に作成、アタッチする。</p>
<pre class="sourceCode bash" id="cb206"><code class="sourceCode bash"><div class="sourceLine" id="cb206-1" data-line-number="1"><span class="co">## 一覧表示</span></div>
<div class="sourceLine" id="cb206-2" data-line-number="2"><span class="ex">tmux</span> ls</div>
<div class="sourceLine" id="cb206-3" data-line-number="3"><span class="co">## 作成</span></div>
<div class="sourceLine" id="cb206-4" data-line-number="4"><span class="ex">tmux</span> new -s <span class="op">&lt;</span>session<span class="op">&gt;</span></div>
<div class="sourceLine" id="cb206-5" data-line-number="5"><span class="co">## 削除（個別）</span></div>
<div class="sourceLine" id="cb206-6" data-line-number="6"><span class="ex">tmux</span> kill-session -t <span class="op">&lt;</span>session<span class="op">&gt;</span></div>
<div class="sourceLine" id="cb206-7" data-line-number="7"><span class="co">## 削除（全て）</span></div>
<div class="sourceLine" id="cb206-8" data-line-number="8"><span class="ex">tmux</span> kill-server</div></code></pre>
<h2 id="pane">Pane</h2>
<p>ウインドウを分割する。</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Triger(Ctr+[b]…)</th>
<th style="text-align: left;">Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">“</td>
<td style="text-align: left;">上下に分割</td>
</tr>
<tr class="even">
<td style="text-align: left;">%</td>
<td style="text-align: left;">左右に分割</td>
</tr>
<tr class="odd">
<td style="text-align: left;">o</td>
<td style="text-align: left;">Pane を移動</td>
</tr>
<tr class="even">
<td style="text-align: left;">[SPC]</td>
<td style="text-align: left;">レイアウト切り替え</td>
</tr>
<tr class="odd">
<td style="text-align: left;">[Ctr]+[カーソル]</td>
<td style="text-align: left;">サイズ変更</td>
</tr>
<tr class="even">
<td style="text-align: left;">:set-window-option synchronize-panes on</td>
<td style="text-align: left;">各 Pain にキー入力をブロードキャストする</td>
</tr>
<tr class="odd">
<td style="text-align: left;">:set-window-option synchronize-panes off</td>
<td style="text-align: left;">各 Pain にキー入力をブロードキャストしない</td>
</tr>
</tbody>
</table>
<h1 id="git">GIT</h1>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-git',data:{label:''
,GIT_REPONAME: 'dir/name.git'
,GIT_ROOT    : '/var/lib/git'
,GIT_REMOTE  : '192.168.0.10'
,GIT_USER    : 'git'
,GIT_SSH     : '2203'
,GIT_COMMENT : 'テスト'
}});})</script>
<div id="app-git">
<form class="form-horizontal">
<varin label="REPO NAME" v-model="GIT_REPONAME"></varin> <varin label="ROOT" v-model="GIT_ROOT"></varin> <varin label="REMOTE" v-model="GIT_REMOTE"></varin> <varin label="USER" v-model="GIT_USER"></varin> <varin label="SSH" v-model="GIT_SSH"></varin> <varin label="COMMIT -m" v-model="GIT_COMMENT"></varin>
</form>
<h2 id="on-the-serverremote">on the SERVER(REMOTE)</h2>
<h3 id="create-remote-rep.">CREATE REMOTE REP.</h3>
<pre class="sourceCode bash" id="cb207"><code class="sourceCode bash"><div class="sourceLine" id="cb207-1" data-line-number="1"><span class="fu">sudo</span> mkdir -p <span class="dt">{{GIT_ROOT}}/{{GIT_REPONAME}}</span></div>
<div class="sourceLine" id="cb207-2" data-line-number="2"><span class="bu">cd</span> <span class="dt">{{GIT_ROOT}}/{{GIT_REPONAME}}</span></div>
<div class="sourceLine" id="cb207-3" data-line-number="3"><span class="fu">sudo</span> git init --bare --shared</div>
<div class="sourceLine" id="cb207-4" data-line-number="4"><span class="fu">sudo</span> chown -R root:git .</div>
<div class="sourceLine" id="cb207-5" data-line-number="5"><span class="fu">ls</span> -la</div></code></pre>
<h2 id="on-the-clientlocal">on the CLIENT(LOCAL)</h2>
<h3 id="create-local-rep.">CREATE LOCAL REP.</h3>
<pre class="sourceCode bash" id="cb208"><code class="sourceCode bash"><div class="sourceLine" id="cb208-1" data-line-number="1"><span class="fu">git</span> init</div>
<div class="sourceLine" id="cb208-2" data-line-number="2"><span class="fu">git</span> add .</div>
<div class="sourceLine" id="cb208-3" data-line-number="3"><span class="fu">git</span> commit -m <span class="st">&quot;1st&quot;</span></div></code></pre>
<h3 id="push-to-remote">PUSH to REMOTE</h3>
<pre class="sourceCode bash" id="cb209"><code class="sourceCode bash"><div class="sourceLine" id="cb209-1" data-line-number="1"><span class="fu">git</span> remote add origin ssh://<span class="dt">{{GIT_USER}}@{{GIT_REMOTE}}:{{GIT_SSH}}{{GIT_ROOT}}/{{GIT_REPONAME}}</span></div>
<div class="sourceLine" id="cb209-2" data-line-number="2"><span class="fu">git</span> push origin master</div></code></pre>
<h3 id="clone">CLONE</h3>
<pre class="sourceCode bash" id="cb210"><code class="sourceCode bash"><div class="sourceLine" id="cb210-1" data-line-number="1"><span class="fu">git</span> clone ssh://<span class="dt">{{GIT_USER}}@{{GIT_REMOTE}}:{{GIT_SSH}}{{GIT_ROOT}}/{{GIT_REPONAME}}</span></div></code></pre>
<h3 id="commit">COMMIT</h3>
<pre class="sourceCode bash" id="cb211"><code class="sourceCode bash"><div class="sourceLine" id="cb211-1" data-line-number="1"><span class="fu">git</span> add .</div>
<div class="sourceLine" id="cb211-2" data-line-number="2"><span class="fu">git</span> commit -a -m <span class="st">&quot;{{GIT_COMMENT}}&quot;</span></div></code></pre>
<h3 id="commit-log">COMMIT LOG</h3>
<pre class="sourceCode bash" id="cb212"><code class="sourceCode bash"><div class="sourceLine" id="cb212-1" data-line-number="1"><span class="fu">git</span> log</div></code></pre>
<h3 id="push">PUSH</h3>
<pre><code>git push origin master</code></pre>
<h3 id="pull">PULL</h3>
<pre class="sourceCode bash" id="cb214"><code class="sourceCode bash"><div class="sourceLine" id="cb214-1" data-line-number="1"><span class="fu">git</span> pull origin master</div></code></pre>
</div>
<h1 id="docker">DOCKER</h1>
<h2 id="setup-2">Setup</h2>
<h3 id="install-8">Install</h3>
<pre class="sourceCode bash" id="cb215"><code class="sourceCode bash"><div class="sourceLine" id="cb215-1" data-line-number="1"><span class="ex">brew</span> cask install docker</div></code></pre>
<h3 id="without-sudo">WITHOUT sudo</h3>
<pre class="sourceCode bash" id="cb216"><code class="sourceCode bash"><div class="sourceLine" id="cb216-1" data-line-number="1"><span class="co"># sudo groupadd docker</span></div>
<div class="sourceLine" id="cb216-2" data-line-number="2"><span class="fu">sudo</span> gpasswd -a <span class="va">${USER}</span> docker</div>
<div class="sourceLine" id="cb216-3" data-line-number="3"><span class="fu">sudo</span> service docker restart</div></code></pre>
<p>最ログインが必要！</p>
<h3 id="hello-world-1">Hello World</h3>
<pre class="sourceCode bash" id="cb217"><code class="sourceCode bash"><div class="sourceLine" id="cb217-1" data-line-number="1"><span class="ex">docker</span> run hello-world</div></code></pre>
<h2 id="docker-compose">docker-compose</h2>
<h4 id="docker-compose.yml">docker-compose.yml</h4>
<pre class="sourceCode yaml" id="cb218"><code class="sourceCode yaml"><div class="sourceLine" id="cb218-1" data-line-number="1"><span class="fu">centos:</span></div>
<div class="sourceLine" id="cb218-2" data-line-number="2">  <span class="fu">image:</span><span class="at"> centos:latest</span></div>
<div class="sourceLine" id="cb218-3" data-line-number="3">  <span class="fu">container_name:</span><span class="at"> centos7</span></div>
<div class="sourceLine" id="cb218-4" data-line-number="4">  <span class="fu">entrypoint:</span><span class="at"> tail -f /dev/null</span></div></code></pre>
<h3 id="updown">UP/DOWN</h3>
<pre class="sourceCode bash" id="cb219"><code class="sourceCode bash"><div class="sourceLine" id="cb219-1" data-line-number="1"><span class="ex">docker-compose</span> up</div></code></pre>
<pre class="sourceCode bash" id="cb220"><code class="sourceCode bash"><div class="sourceLine" id="cb220-1" data-line-number="1"><span class="ex">docker-compose</span> down</div></code></pre>
<h2 id="container">CONTAINER</h2>
<h3 id="list-6">LIST</h3>
<pre class="sourceCode bash" id="cb221"><code class="sourceCode bash"><div class="sourceLine" id="cb221-1" data-line-number="1"><span class="ex">docker</span> ps -a</div></code></pre>
<h3 id="run-stop">RUN &amp; STOP</h3>
<pre class="sourceCode bash" id="cb222"><code class="sourceCode bash"><div class="sourceLine" id="cb222-1" data-line-number="1"><span class="ex">docker</span> run -d -p 80:80 --name web nginx</div></code></pre>
<pre class="sourceCode bash" id="cb223"><code class="sourceCode bash"><div class="sourceLine" id="cb223-1" data-line-number="1"><span class="ex">docker</span> stop <span class="dt">{CONTAINER}</span></div></code></pre>
<h3 id="remove">REMOVE</h3>
<pre class="sourceCode bash" id="cb224"><code class="sourceCode bash"><div class="sourceLine" id="cb224-1" data-line-number="1"><span class="ex">docker</span> rm <span class="dt">{CONTAINER}</span></div></code></pre>
<h3 id="connect-1">CONNECT</h3>
<pre class="sourceCode bash" id="cb225"><code class="sourceCode bash"><div class="sourceLine" id="cb225-1" data-line-number="1"><span class="ex">docker</span> exec -it <span class="dt">{CONTAINER}</span> /bin/bash</div></code></pre>
<h2 id="image">IMAGE</h2>
<h3 id="list-7">LIST</h3>
<pre class="sourceCode bash" id="cb226"><code class="sourceCode bash"><div class="sourceLine" id="cb226-1" data-line-number="1"><span class="ex">docker</span> images</div></code></pre>
<h3 id="remove-1">REMOVE</h3>
<pre class="sourceCode bash" id="cb227"><code class="sourceCode bash"><div class="sourceLine" id="cb227-1" data-line-number="1"><span class="ex">docker</span> rmi <span class="dt">{IMAGE}</span></div></code></pre>
<pre class="sourceCode bash" id="cb228"><code class="sourceCode bash"><div class="sourceLine" id="cb228-1" data-line-number="1"><span class="ex">docker</span> rmi <span class="va">$(</span><span class="ex">docker</span> images -a <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;/^&lt;none&gt;/ { print $3 }&#39;</span><span class="va">)</span></div></code></pre>
<h1 id="docker.old">Docker.OLD</h1>
<h3 id="install-9">install</h3>
<pre class="sourceCode bash" id="cb229"><code class="sourceCode bash"><div class="sourceLine" id="cb229-1" data-line-number="1"><span class="ex">yum</span> install -y docker-io.x86_64</div></code></pre>
<h3 id="ps">PS</h3>
<pre class="sourceCode bash" id="cb230"><code class="sourceCode bash"><div class="sourceLine" id="cb230-1" data-line-number="1"><span class="ex">watch</span> -n 2 <span class="st">&#39;df -h; echo; free -m; echo; docker ps -a|head; echo; docker images -a&#39;</span></div></code></pre>
<h2 id="dockerfile">DOCKERFILE</h2>
<pre class="sourceCode bash" id="cb231"><code class="sourceCode bash"><div class="sourceLine" id="cb231-1" data-line-number="1"><span class="ex">FROM</span> centos:latest</div>
<div class="sourceLine" id="cb231-2" data-line-number="2"></div>
<div class="sourceLine" id="cb231-3" data-line-number="3"><span class="co"># EPEL</span></div>
<div class="sourceLine" id="cb231-4" data-line-number="4"><span class="ex">RUN</span> rpm -i http://ftp.riken.jp/Linux/fedora/epel/6/i386/epel-release-6-8.noarch.rpm</div>
<div class="sourceLine" id="cb231-5" data-line-number="5"><span class="ex">RUN</span> rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6</div>
<div class="sourceLine" id="cb231-6" data-line-number="6"><span class="ex">RUN</span> yum clean metadata</div>
<div class="sourceLine" id="cb231-7" data-line-number="7"></div>
<div class="sourceLine" id="cb231-8" data-line-number="8"><span class="co"># yum</span></div>
<div class="sourceLine" id="cb231-9" data-line-number="9"><span class="ex">RUN</span> yum --enablerepo=epel install -y \</div>
<div class="sourceLine" id="cb231-10" data-line-number="10">    make \</div>
<div class="sourceLine" id="cb231-11" data-line-number="11">    gcc \</div>
<div class="sourceLine" id="cb231-12" data-line-number="12">    zlib-devel \</div>
<div class="sourceLine" id="cb231-13" data-line-number="13">    openssl-devel \</div>
<div class="sourceLine" id="cb231-14" data-line-number="14">    readline-devel \</div>
<div class="sourceLine" id="cb231-15" data-line-number="15">    ncurses-devel \</div>
<div class="sourceLine" id="cb231-16" data-line-number="16">    gdbm-devel \</div>
<div class="sourceLine" id="cb231-17" data-line-number="17">    db4-devel \</div>
<div class="sourceLine" id="cb231-18" data-line-number="18">    libffi-devel \</div>
<div class="sourceLine" id="cb231-19" data-line-number="19">    tk-devel \</div>
<div class="sourceLine" id="cb231-20" data-line-number="20">    libyaml-devel \</div>
<div class="sourceLine" id="cb231-21" data-line-number="21">    tar \</div>
<div class="sourceLine" id="cb231-22" data-line-number="22">    git</div>
<div class="sourceLine" id="cb231-23" data-line-number="23"></div>
<div class="sourceLine" id="cb231-24" data-line-number="24"><span class="co"># Install ruby-build</span></div>
<div class="sourceLine" id="cb231-25" data-line-number="25"><span class="ex">RUN</span> git clone https://github.com/sstephenson/ruby-build.git .ruby-build</div>
<div class="sourceLine" id="cb231-26" data-line-number="26"><span class="ex">RUN</span> .ruby-build/install.sh</div>
<div class="sourceLine" id="cb231-27" data-line-number="27"><span class="ex">RUN</span> rm -fr .ruby-build</div>
<div class="sourceLine" id="cb231-28" data-line-number="28"></div>
<div class="sourceLine" id="cb231-29" data-line-number="29"><span class="co"># Install ruby</span></div>
<div class="sourceLine" id="cb231-30" data-line-number="30"><span class="ex">RUN</span> ruby-build 2.1.2 /usr/local</div>
<div class="sourceLine" id="cb231-31" data-line-number="31"></div>
<div class="sourceLine" id="cb231-32" data-line-number="32"><span class="co"># Install bundler</span></div>
<div class="sourceLine" id="cb231-33" data-line-number="33"><span class="ex">RUN</span> gem update --system</div>
<div class="sourceLine" id="cb231-34" data-line-number="34"><span class="ex">RUN</span> gem install bundler --no-rdoc --no-ri</div></code></pre>
<h2 id="command-graph-1">COMMAND GRAPH</h2>
<div id="docker_graph" style="width: 100%; height: 300px; border: 1px solid lightgray;">
<div id="graph-navigation_wrapper" style="position: absolute; width: 100%; height: 300px;">
<pre><code>&lt;div id=&quot;graph-navigation_zoomExtends&quot; class=&quot;graph-navigation zoomExtends&quot;&gt;
&lt;/div&gt;</code></pre>
</div>
<div class="graph-frame" style="position: relative; overflow: hidden; width: 100%; height: 100%;">
<pre><code>&lt;canvas style=&quot;position: relative; -webkit-user-select: none; -webkit-user-drag: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); width: 100%; height: 100%&quot;&gt;&lt;/canvas&gt;</code></pre>
</div>
</div>
<script type="text/javascript">
var container = document.getElementById('docker_graph');
var data = {dot: 'digraph { \
\
REGISTER   [shape=box,fontColor=white,color=red]; \
Dockerfile [shape=box,fontColor=white,color=red]; \
IMAGE      [shape=box]; \
CONTAINER  [shape=box]; \
Running    [shape=circle]; \
Stoped     [shape=circle]; \
SAVEFILE   [shape=box]; \
EXPORTFILE [shape=box]; \
\
Dockerfile -- build -> IMAGE; \
\
REGISTER -- pull -> IMAGE ; \
REGISTER -- login  ; \
REGISTER -- search ; \
REGISTER -- tag    ; \
\
IMAGE -- push -> REGISTER  ; \
IMAGE -- run  -> CONTAINER ; \
IMAGE -- save -> SAVEFILE -- LOAD -> IMAGE ; \
IMAGE -- history ; \
IMAGE -- images  ; \
IMAGE -- insert  ; \
IMAGE -- rmi     ; \
IMAGE -- load    ; \
IMAGE -- inspect ; \
\
CONTAINER -- commit -> IMAGE      ; \
CONTAINER -- export -> EXPORTFILE -- import -> IMAGE ; \
CONTAINER -- Running ; \
CONTAINER -- Stoped  ; \
CONTAINER -- inspect ; \
CONTAINER -- logs    ; \
CONTAINER -- port    ; \
CONTAINER -- ps      ; \
CONTAINER -- diff    ; \
\
Running  -- attach   ; \
Running  -- cp       ; \
Running  -- top      ; \
Running  -- stop     [dir = none, weight = 100]; \
Running  -- kill     ; \
Running  -- restart  ; \
Running  -- wait     ; \
\
Stoped -- start -> Running ; \
Stoped -- rm ;    \
\
}'};
var graph = new vis.Graph(container, data);
</script>
<h2 id="use">USE</h2>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-docker',data:{label:''
,DOCKER_TARG_REPO: 'ubuntu'
,DOCKER_TARG_TAG: 'ruby2'
,DOCKER_IMAGE_ID: '${IMAGE_ID}'
,DOCKER_CONTAINER_ID: '${CONTAINER_ID}'
}});})</script>
<div id="app-docker">
<form class="form-horizontal">
<varin label="REPO"         v-model="DOCKER_TARG_REPO"></varin> <varin label="TAG"          v-model="DOCKER_TARG_TAG"></varin> <varin label="IMAGE ID"     v-model="DOCKER_IMAGE_ID"></varin> <varin label="CONTAINER ID" v-model="DOCKER_CONTAINER_ID"></varin>
</form>
<h3 id="build-1">BUILD</h3>
<pre class="sourceCode bash" id="cb234"><code class="sourceCode bash"><div class="sourceLine" id="cb234-1" data-line-number="1"><span class="ex">docker</span> build -t <span class="dt">{{DOCKER_TARG_REPO}}:{{DOCKER_TARG_TAG}}</span> .</div></code></pre>
<pre class="sourceCode bash" id="cb235"><code class="sourceCode bash"><div class="sourceLine" id="cb235-1" data-line-number="1"><span class="ex">docker</span> build --rm=true -t <span class="dt">{{DOCKER_TARG_REPO}}:{{DOCKER_TARG_TAG}}</span> .</div></code></pre>
<h3 id="run-stop-1">RUN / STOP</h3>
<h4 id="run-1">RUN</h4>
<pre class="sourceCode bash" id="cb236"><code class="sourceCode bash"><div class="sourceLine" id="cb236-1" data-line-number="1"><span class="ex">docker</span> run -i -t <span class="dt">{{DOCKER_TARG_REPO}}:{{DOCKER_TARG_TAG}}</span> /bin/bash</div></code></pre>
<pre class="sourceCode bash" id="cb237"><code class="sourceCode bash"><div class="sourceLine" id="cb237-1" data-line-number="1"><span class="ex">docker</span> run -i -t <span class="dt">{{DOCKER_TARG_REPO}}:{{DOCKER_TARG_TAG}}</span> /usr/sbin/sshd -D</div></code></pre>
<h4 id="stop">STOP</h4>
<pre class="sourceCode bash" id="cb238"><code class="sourceCode bash"><div class="sourceLine" id="cb238-1" data-line-number="1"><span class="ex">docker</span> stop <span class="dt">{{DOCKER_CONTAINER_ID}}</span></div></code></pre>
<h4 id="all-stop">ALL STOP</h4>
<pre class="sourceCode bash" id="cb239"><code class="sourceCode bash"><div class="sourceLine" id="cb239-1" data-line-number="1"><span class="ex">docker</span> stop <span class="kw">`</span><span class="ex">docker</span> ps -aq<span class="kw">`</span></div></code></pre>
<h3 id="commit-1">COMMIT</h3>
<pre class="sourceCode bash" id="cb240"><code class="sourceCode bash"><div class="sourceLine" id="cb240-1" data-line-number="1"><span class="ex">docker</span> commit <span class="dt">{{DOCKER_CONTAINER_ID}}</span> <span class="dt">{{DOCKER_TARG_REPO}}:{{DOCKER_TARG_TAG}}</span></div></code></pre>
<h3 id="export-import">EXPORT / IMPORT</h3>
<p>差分統合される。</p>
<h4 id="export">EXPORT</h4>
<pre class="sourceCode bash" id="cb241"><code class="sourceCode bash"><div class="sourceLine" id="cb241-1" data-line-number="1"><span class="ex">docker</span> export <span class="dt">{{DOCKER_CONTAINER_ID}}</span> <span class="op">&gt;</span> <span class="dt">{{DOCKER_TARG_REPO}}:{{DOCKER_TARG_TAG}}</span>.export.tar</div></code></pre>
<h4 id="import">IMPORT</h4>
<pre class="sourceCode bash" id="cb242"><code class="sourceCode bash"><div class="sourceLine" id="cb242-1" data-line-number="1"><span class="fu">cat</span> <span class="dt">{{DOCKER_TARG_REPO}}:{{DOCKER_TARG_TAG}}</span>.export.tar <span class="kw">|</span> <span class="ex">docker</span> import - <span class="dt">{{DOCKER_TARG_REPO}}:{{DOCKER_TARG_TAG}}</span></div></code></pre>
<h3 id="save-load">SAVE / LOAD</h3>
<p>差分統合されない。</p>
<h4 id="save">SAVE</h4>
<pre class="sourceCode bash" id="cb243"><code class="sourceCode bash"><div class="sourceLine" id="cb243-1" data-line-number="1"><span class="ex">docker</span> save <span class="dt">{{DOCKER_TARG_REPO}}:{{DOCKER_TARG_TAG}}</span> <span class="op">&gt;</span> <span class="dt">{{DOCKER_TARG_REPO}}:{{DOCKER_TARG_TAG}}</span>.save.tar</div></code></pre>
<h4 id="load-1">LOAD</h4>
<pre class="sourceCode bash" id="cb244"><code class="sourceCode bash"><div class="sourceLine" id="cb244-1" data-line-number="1"><span class="ex">docker</span> load <span class="op">&lt;</span> <span class="dt">{{DOCKER_TARG_REPO}}:{{DOCKER_TARG_TAG}}</span>.save.tar</div></code></pre>
<h3 id="remove-all-container">REMOVE ALL CONTAINER</h3>
<pre class="sourceCode bash" id="cb245"><code class="sourceCode bash"><div class="sourceLine" id="cb245-1" data-line-number="1"><span class="ex">docker</span> rm <span class="kw">`</span><span class="ex">docker</span> ps -aq<span class="kw">`</span></div></code></pre>
<h3 id="images-tree">images tree</h3>
<p>-tree もうすぐなくなる…</p>
<pre class="sourceCode bash" id="cb246"><code class="sourceCode bash"><div class="sourceLine" id="cb246-1" data-line-number="1"><span class="ex">docker</span> images -tree</div></code></pre>
<h3 id="all-images-list">all images list</h3>
<pre class="sourceCode bash" id="cb247"><code class="sourceCode bash"><div class="sourceLine" id="cb247-1" data-line-number="1"><span class="ex">docker</span> images -a</div></code></pre>
<h3 id="remove-images">remove images</h3>
<pre class="sourceCode bash" id="cb248"><code class="sourceCode bash"><div class="sourceLine" id="cb248-1" data-line-number="1"><span class="ex">docker</span> rmi <span class="op">&lt;</span>IMAGE ID<span class="op">&gt;</span></div></code></pre>
<h3 id="remove-all-homeless-images">remove all homeless images</h3>
<p>消えないもの</p>
<ul>
<li>コミット済み image に依存されている？</li>
<li>コンテナが残っとる？</li>
<li>コンテナが動いとる？</li>
</ul>
<pre class="sourceCode bash" id="cb249"><code class="sourceCode bash"><div class="sourceLine" id="cb249-1" data-line-number="1"><span class="ex">docker</span> rmi <span class="va">$(</span><span class="ex">docker</span> images -a <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;/^&lt;none&gt;/ {print $3}&#39;</span><span class="va">)</span></div></code></pre>
<h3 id="all-clear">ALL CLEAR</h3>
<pre class="sourceCode bash" id="cb250"><code class="sourceCode bash"><div class="sourceLine" id="cb250-1" data-line-number="1"><span class="ex">docker</span> stop <span class="kw">`</span><span class="ex">docker</span> ps -aq<span class="kw">`</span></div>
<div class="sourceLine" id="cb250-2" data-line-number="2"><span class="ex">docker</span> rm <span class="kw">`</span><span class="ex">docker</span> ps -aq<span class="kw">`</span></div>
<div class="sourceLine" id="cb250-3" data-line-number="3"><span class="ex">docker</span> rmi <span class="va">$(</span><span class="ex">docker</span> images -a <span class="kw">|</span> <span class="fu">awk</span> <span class="st">&#39;{print $3}&#39;</span><span class="va">)</span></div></code></pre>
<p>docker rmi $(docker images -a | awk ‘{print $3}’)</p>
</div>
<h2 id="boot2docker">boot2docker</h2>
<h3 id="install-10">install</h3>
<pre class="sourceCode bash" id="cb251"><code class="sourceCode bash"><div class="sourceLine" id="cb251-1" data-line-number="1"><span class="ex">brew</span> install docker boot2docker</div></code></pre>
<h3 id="up">up</h3>
<pre class="sourceCode bash" id="cb252"><code class="sourceCode bash"><div class="sourceLine" id="cb252-1" data-line-number="1"><span class="ex">boot2docker</span> init</div>
<div class="sourceLine" id="cb252-2" data-line-number="2"><span class="ex">boot2docker</span> up</div></code></pre>
<h3 id="ssh">ssh</h3>
<p>password: tcuser</p>
<pre class="sourceCode bash" id="cb253"><code class="sourceCode bash"><div class="sourceLine" id="cb253-1" data-line-number="1"><span class="ex">boot2docker</span> ssh</div></code></pre>
<h3 id="docker_host">DOCKER_HOST</h3>
<pre class="sourceCode bash" id="cb254"><code class="sourceCode bash"><div class="sourceLine" id="cb254-1" data-line-number="1"><span class="bu">export</span> <span class="va">DOCKER_HOST=</span>tcp://localhost:4243</div></code></pre>
<h1 id="iptables">IPTABLES</h1>
<pre class="sourceCode bash" id="cb255"><code class="sourceCode bash"><div class="sourceLine" id="cb255-1" data-line-number="1">● 現在の設定の確認</div>
<div class="sourceLine" id="cb255-2" data-line-number="2"><span class="ex">iptables</span> -L</div>
<div class="sourceLine" id="cb255-3" data-line-number="3"></div>
<div class="sourceLine" id="cb255-4" data-line-number="4">● <span class="ex">FORWARD</span>は使わない</div>
<div class="sourceLine" id="cb255-5" data-line-number="5"><span class="ex">iptables</span> -P FORWARD DROP</div>
<div class="sourceLine" id="cb255-6" data-line-number="6"></div>
<div class="sourceLine" id="cb255-7" data-line-number="7">● まずは全許可に</div>
<div class="sourceLine" id="cb255-8" data-line-number="8"><span class="ex">iptables</span> -P INPUT ACCEPT</div>
<div class="sourceLine" id="cb255-9" data-line-number="9"></div>
<div class="sourceLine" id="cb255-10" data-line-number="10">● デフォルトのルールを全て削除</div>
<div class="sourceLine" id="cb255-11" data-line-number="11"><span class="ex">iptables</span> -F</div>
<div class="sourceLine" id="cb255-12" data-line-number="12"></div>
<div class="sourceLine" id="cb255-13" data-line-number="13">● 自分自身からのパケットは全許可</div>
<div class="sourceLine" id="cb255-14" data-line-number="14"><span class="ex">iptables</span> -A INPUT -i lo -j ACCEPT</div>
<div class="sourceLine" id="cb255-15" data-line-number="15"></div>
<div class="sourceLine" id="cb255-16" data-line-number="16">● <span class="ex">SSH</span>許可 or SSH自分(255.255.255.255)だけ許可</div>
<div class="sourceLine" id="cb255-17" data-line-number="17"><span class="ex">iptables</span> -A INPUT -p tcp --dport 22 -j ACCEPT</div>
<div class="sourceLine" id="cb255-18" data-line-number="18"> <span class="ex">or</span></div>
<div class="sourceLine" id="cb255-19" data-line-number="19"> <span class="ex">iptables</span> -A INPUT -s 255.255.255.255 -p tcp --dport 22 -j ACCEPT</div>
<div class="sourceLine" id="cb255-20" data-line-number="20"></div>
<div class="sourceLine" id="cb255-21" data-line-number="21">● <span class="ex">FTP</span>(20,21,4000-4029) の接続を許可</div>
<div class="sourceLine" id="cb255-22" data-line-number="22"><span class="ex">iptables</span> -A INPUT -p tcp --dport 20 -j ACCEPT</div>
<div class="sourceLine" id="cb255-23" data-line-number="23"><span class="ex">iptables</span> -A INPUT -p tcp --dport 21 -j ACCEPT</div>
<div class="sourceLine" id="cb255-24" data-line-number="24"><span class="ex">iptables</span> -A INPUT -p tcp --dport 4000:4029 -j ACCEPT</div>
<div class="sourceLine" id="cb255-25" data-line-number="25"></div>
<div class="sourceLine" id="cb255-26" data-line-number="26">● <span class="ex">http</span>, https の接続を許可</div>
<div class="sourceLine" id="cb255-27" data-line-number="27"><span class="ex">iptables</span> -A INPUT -p tcp --dport 80 -j ACCEPT</div>
<div class="sourceLine" id="cb255-28" data-line-number="28"><span class="ex">iptables</span> -A INPUT -p tcp --dport 443 -j ACCEPT</div>
<div class="sourceLine" id="cb255-29" data-line-number="29"></div>
<div class="sourceLine" id="cb255-30" data-line-number="30">● <span class="ex">POP</span>(受信メール)の許可</div>
<div class="sourceLine" id="cb255-31" data-line-number="31"><span class="ex">iptables</span> -A INPUT -p tcp --dport 110 -j ACCEPT</div>
<div class="sourceLine" id="cb255-32" data-line-number="32"></div>
<div class="sourceLine" id="cb255-33" data-line-number="33">● <span class="ex">SMTP</span>(送信メール)の許可【これをしないと世間からメールが来なくなる！】</div>
<div class="sourceLine" id="cb255-34" data-line-number="34"><span class="ex">iptables</span> -A INPUT -p tcp --dport 25 -j ACCEPT</div>
<div class="sourceLine" id="cb255-35" data-line-number="35"></div>
<div class="sourceLine" id="cb255-36" data-line-number="36">● <span class="ex">SUBMISSION</span> ポートを開放</div>
<div class="sourceLine" id="cb255-37" data-line-number="37"><span class="ex">iptables</span> -A INPUT -p tcp --dport 587 -j ACCEPT</div>
<div class="sourceLine" id="cb255-38" data-line-number="38"></div>
<div class="sourceLine" id="cb255-39" data-line-number="39">● <span class="ex">PostgreSQL</span>も外から使います</div>
<div class="sourceLine" id="cb255-40" data-line-number="40"><span class="ex">iptables</span> -A INPUT -p tcp --dport 5432 -j ACCEPT</div>
<div class="sourceLine" id="cb255-41" data-line-number="41"></div>
<div class="sourceLine" id="cb255-42" data-line-number="42">● <span class="ex">DNS</span>関係</div>
<div class="sourceLine" id="cb255-43" data-line-number="43"><span class="ex">iptables</span> -A INPUT -p tcp --dport 53 -j ACCEPT</div>
<div class="sourceLine" id="cb255-44" data-line-number="44"><span class="ex">iptables</span> -A INPUT -p udp --dport 53 -j ACCEPT</div>
<div class="sourceLine" id="cb255-45" data-line-number="45"></div>
<div class="sourceLine" id="cb255-46" data-line-number="46">● <span class="ex">PING</span>を許可</div>
<div class="sourceLine" id="cb255-47" data-line-number="47"><span class="ex">iptables</span> -A INPUT -p icmp -j ACCEPT</div>
<div class="sourceLine" id="cb255-48" data-line-number="48"></div>
<div class="sourceLine" id="cb255-49" data-line-number="49">● <span class="ex">TCP</span>の接続開始と応答、FTPデータなどを許可【これをしないと外にメールが飛ばなくなる】</div>
<div class="sourceLine" id="cb255-50" data-line-number="50"><span class="ex">iptables</span> -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</div>
<div class="sourceLine" id="cb255-51" data-line-number="51"></div>
<div class="sourceLine" id="cb255-52" data-line-number="52">● 設定したルール以外のパケットを拒否</div>
<div class="sourceLine" id="cb255-53" data-line-number="53"><span class="ex">iptables</span> -P INPUT DROP</div></code></pre>
<h3 id="port-forward">port forward</h3>
<h4 id="vsftpd">vsftpd</h4>
<pre class="sourceCode bash" id="cb256"><code class="sourceCode bash"><div class="sourceLine" id="cb256-1" data-line-number="1"><span class="va">pasv_enable=</span>YES</div>
<div class="sourceLine" id="cb256-2" data-line-number="2"><span class="va">pasv_min_port=</span>20</div>
<div class="sourceLine" id="cb256-3" data-line-number="3"><span class="va">pasv_max_port=</span>20</div>
<div class="sourceLine" id="cb256-4" data-line-number="4"><span class="va">pasv_address=</span><span class="dt">{global_ip_address}</span></div>
<div class="sourceLine" id="cb256-5" data-line-number="5"></div>
<div class="sourceLine" id="cb256-6" data-line-number="6"><span class="ex">iptables</span> -I FORWARD -p tcp --dport 20 -j ACCEPT</div></code></pre>
<h1 id="ansible">ANSIBLE</h1>
<h2 id="basics-2">BASICS</h2>
<h3 id="ping">ping</h3>
<p>実行前に接続できるか確認する。</p>
<pre class="sourceCode bash" id="cb257"><code class="sourceCode bash"><div class="sourceLine" id="cb257-1" data-line-number="1"><span class="ex">ansible</span> -i hosts all -m ping</div></code></pre>
<h3 id="run-playbook">run playbook</h3>
<pre class="sourceCode bash" id="cb258"><code class="sourceCode bash"><div class="sourceLine" id="cb258-1" data-line-number="1"><span class="ex">ansible-playbook</span> -i hosts site.yml</div></code></pre>
<h2 id="roll">roll</h2>
<h3 id="send-file">send file</h3>
<pre class="sourceCode yaml" id="cb259"><code class="sourceCode yaml"><div class="sourceLine" id="cb259-1" data-line-number="1"><span class="kw">-</span> <span class="fu">name:</span><span class="at"> copy CENTOS iso file 1</span></div>
<div class="sourceLine" id="cb259-2" data-line-number="2">  <span class="fu">copy:</span><span class="at"> src=CentOS-6.5-x86_64-bin-DVD1.iso dest=/mnt/ owner=root group=root mode=644</span></div></code></pre>
<h3 id="mkdir">mkdir</h3>
<pre class="sourceCode yaml" id="cb260"><code class="sourceCode yaml"><div class="sourceLine" id="cb260-1" data-line-number="1"><span class="kw">-</span> <span class="fu">name:</span><span class="at"> make mount position</span></div>
<div class="sourceLine" id="cb260-2" data-line-number="2">  <span class="fu">file:</span><span class="at"> path=/mnt/CentOS-6.5_1 owner=root group=root mode=644 state=directory</span></div></code></pre>
<h3 id="mod-file-line">mod file line</h3>
<pre class="sourceCode yaml" id="cb261"><code class="sourceCode yaml"><div class="sourceLine" id="cb261-1" data-line-number="1"><span class="kw">-</span> <span class="fu">name:</span><span class="at"> MODFILE &quot;yum.conf&quot;</span></div>
<div class="sourceLine" id="cb261-2" data-line-number="2">  <span class="fu">lineinfile:</span><span class="at"> dest=/etc/yum.conf  regexp=^keepcache  line=keepcache=1</span></div></code></pre>
<h3 id="yums">yums</h3>
<pre class="sourceCode yaml" id="cb262"><code class="sourceCode yaml"><div class="sourceLine" id="cb262-1" data-line-number="1"><span class="kw">-</span> <span class="fu">name:</span><span class="at"> yum install depend pkg</span></div>
<div class="sourceLine" id="cb262-2" data-line-number="2">  <span class="fu">yum:</span><span class="at"> name={{ item }} state=installed disablerepo=* enablerepo=c6-media</span></div>
<div class="sourceLine" id="cb262-3" data-line-number="3">  <span class="fu">with_items:</span></div>
<div class="sourceLine" id="cb262-4" data-line-number="4">    <span class="kw">-</span> compat-libstdc++-33</div>
<div class="sourceLine" id="cb262-5" data-line-number="5">    <span class="kw">-</span> elfutils-libelf-devel</div>
<div class="sourceLine" id="cb262-6" data-line-number="6">    <span class="kw">-</span> elfutils-libelf-devel-static</div>
<div class="sourceLine" id="cb262-7" data-line-number="7">    <span class="kw">-</span> gcc</div>
<div class="sourceLine" id="cb262-8" data-line-number="8">    <span class="kw">-</span> gcc-c++</div>
<div class="sourceLine" id="cb262-9" data-line-number="9">    <span class="kw">-</span> glibc-devel</div>
<div class="sourceLine" id="cb262-10" data-line-number="10">    <span class="kw">-</span> glibc-headers</div>
<div class="sourceLine" id="cb262-11" data-line-number="11">    <span class="kw">-</span> kernel-headers</div>
<div class="sourceLine" id="cb262-12" data-line-number="12">    <span class="kw">-</span> libaio-devel</div>
<div class="sourceLine" id="cb262-13" data-line-number="13">    <span class="kw">-</span> libgomp</div>
<div class="sourceLine" id="cb262-14" data-line-number="14">    <span class="kw">-</span> libstdc++-devel</div>
<div class="sourceLine" id="cb262-15" data-line-number="15">    <span class="kw">-</span> sysstat</div></code></pre>
<h3 id="add-group-user">add group &amp; user</h3>
<pre class="sourceCode yaml" id="cb263"><code class="sourceCode yaml"><div class="sourceLine" id="cb263-1" data-line-number="1"><span class="kw">-</span> <span class="fu">name:</span><span class="at"> create group</span></div>
<div class="sourceLine" id="cb263-2" data-line-number="2">  <span class="fu">group:</span><span class="at"> name={{item.name}} gid={{item.gid}} state=present</span></div>
<div class="sourceLine" id="cb263-3" data-line-number="3">  <span class="fu">with_items:</span></div>
<div class="sourceLine" id="cb263-4" data-line-number="4">    <span class="kw">-</span> <span class="kw">{</span> <span class="fu">name:</span><span class="at"> </span><span class="st">&quot;oinstall&quot;</span> <span class="kw">, </span><span class="fu">gid:</span><span class="at"> 701</span><span class="kw">}</span></div>
<div class="sourceLine" id="cb263-5" data-line-number="5">    <span class="kw">-</span> <span class="kw">{</span> <span class="fu">name:</span><span class="at"> </span><span class="st">&quot;dba&quot;</span>      <span class="kw">, </span><span class="fu">gid:</span><span class="at"> 702</span><span class="kw">}</span></div>
<div class="sourceLine" id="cb263-6" data-line-number="6">    <span class="kw">-</span> <span class="kw">{</span> <span class="fu">name:</span><span class="at"> </span><span class="st">&quot;oracle&quot;</span>   <span class="kw">, </span><span class="fu">gid:</span><span class="at"> 703</span><span class="kw">}</span></div>
<div class="sourceLine" id="cb263-7" data-line-number="7">    <span class="kw">-</span> <span class="kw">{</span> <span class="fu">name:</span><span class="at"> </span><span class="st">&quot;oper&quot;</span>     <span class="kw">, </span><span class="fu">gid:</span><span class="at"> 704</span><span class="kw">}</span></div>
<div class="sourceLine" id="cb263-8" data-line-number="8"></div>
<div class="sourceLine" id="cb263-9" data-line-number="9"><span class="kw">-</span> <span class="fu">name:</span><span class="at"> create user</span></div>
<div class="sourceLine" id="cb263-10" data-line-number="10">  <span class="fu">user:</span><span class="at"> name={{item.name}} uid={{item.uid}} password={{item.pass}} group=oinstall groups=dba,oper createhome=yes state=present</span></div>
<div class="sourceLine" id="cb263-11" data-line-number="11">  <span class="fu">with_items:</span></div>
<div class="sourceLine" id="cb263-12" data-line-number="12">    <span class="kw">-</span> <span class="kw">{</span> <span class="fu">name:</span><span class="at"> </span><span class="st">&quot;oracle&quot;</span> <span class="kw">, </span><span class="fu">uid:</span><span class="at"> 701</span><span class="kw">,</span> <span class="fu">pass:</span><span class="at"> </span><span class="st">&quot;$1$SomeSalt$c7SWNheGRHNaCLwuAG7Sa.&quot;</span> <span class="kw">}</span></div></code></pre>
<h4 id="make-password">make password</h4>
<pre class="sourceCode python" id="cb264"><code class="sourceCode python"><div class="sourceLine" id="cb264-1" data-line-number="1">python <span class="op">-</span>c <span class="st">&#39;import crypt; print crypt.crypt(&quot;REPLACE:username&quot;, &quot;$1$SomeSalt$&quot;)&#39;</span></div></code></pre>
<h4 id="exec-shell-command">exec shell command</h4>
<pre class="sourceCode yaml" id="cb265"><code class="sourceCode yaml"><div class="sourceLine" id="cb265-1" data-line-number="1"><span class="kw">-</span> <span class="fu">name:</span><span class="at"> yum install</span></div>
<div class="sourceLine" id="cb265-2" data-line-number="2">  <span class="fu">shell:</span><span class="at"> yum --disablerepo=\* -y localinstall /opt/rpm/*.rpm &gt; /opt/rpm/res.txt</span></div></code></pre>
<p>command もあるが、なんか違う。</p>
<h1 id="test-1">test</h1>
<h2 id="ファイルの有無">ファイルの有無</h2>
<pre class="sourceCode bash" id="cb266"><code class="sourceCode bash"><div class="sourceLine" id="cb266-1" data-line-number="1"><span class="bu">test</span> ! -e /vagrant/rpm/gitlab-7.3.2_omnibus-1.el6.x86_64.rpm<span class="kw">;</span> <span class="bu">echo</span> <span class="va">$?</span></div></code></pre>
<h1 id="cut">cut</h1>
<h2 id="列目だけ">1列目だけ</h2>
<pre><code>cut -d &#39; &#39; -f1</code></pre>
<h1 id="grep">grep</h1>
<h2 id="and">AND</h2>
<pre class="sourceCode bash" id="cb268"><code class="sourceCode bash"><div class="sourceLine" id="cb268-1" data-line-number="1"><span class="fu">grep</span> <span class="st">&#39;AAA&#39;</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="st">&#39;BBB&#39;</span></div></code></pre>
<pre class="sourceCode bash" id="cb269"><code class="sourceCode bash"><div class="sourceLine" id="cb269-1" data-line-number="1"><span class="fu">grep</span> <span class="st">&#39;AAA.*BBB&#39;</span></div></code></pre>
<h3 id="複数行">複数行</h3>
<pre class="sourceCode bash" id="cb270"><code class="sourceCode bash"><div class="sourceLine" id="cb270-1" data-line-number="1"><span class="fu">grep</span> -P <span class="st">&#39;AAA[\s\S]*?BBB&#39;</span></div></code></pre>
<h2 id="or">OR</h2>
<pre class="sourceCode bash" id="cb271"><code class="sourceCode bash"><div class="sourceLine" id="cb271-1" data-line-number="1"><span class="fu">grep</span> <span class="st">&#39;AAA\|BBB&#39;</span></div></code></pre>
<h2 id="not">NOT</h2>
<pre class="sourceCode bash" id="cb272"><code class="sourceCode bash"><div class="sourceLine" id="cb272-1" data-line-number="1"><span class="fu">grep</span> -v <span class="st">&#39;AAA&#39;</span></div></code></pre>
<h2 id="前後も表示">前後も表示</h2>
<ul>
<li>-B マッチ「前」の行数</li>
<li>-A マッチ「後」の行数</li>
</ul>
<pre class="sourceCode bash" id="cb273"><code class="sourceCode bash"><div class="sourceLine" id="cb273-1" data-line-number="1"><span class="fu">grep</span> -B 3 -A 3 <span class="st">&#39;xyz&#39;</span> *.txt</div></code></pre>
<h1 id="sed">sed</h1>
<h2 id="ファイルを直接置換え">ファイルを直接置換え</h2>
<pre class="sourceCode bash" id="cb274"><code class="sourceCode bash"><div class="sourceLine" id="cb274-1" data-line-number="1"><span class="fu">sed</span> -i -e <span class="st">&#39;s/AAA/ZZZ/g&#39;</span> FILENAME.txt</div></code></pre>
<h2 id="改行コード変換">改行コード変換</h2>
<pre class="sourceCode bash" id="cb275"><code class="sourceCode bash"><div class="sourceLine" id="cb275-1" data-line-number="1"><span class="fu">sed</span> <span class="st">&quot;s/\r//g&quot;</span> FILENAME.txt</div></code></pre>
<h1 id="echo">echo</h1>
<h2 id="改行しない">改行しない</h2>
<pre class="sourceCode bash" id="cb276"><code class="sourceCode bash"><div class="sourceLine" id="cb276-1" data-line-number="1"><span class="bu">echo</span> -n <span class="st">&#39;ZZZ...&#39;</span></div></code></pre>
<h2 id="colorstyle">COLOR/STYLE</h2>
<h3 id="green">GREEN</h3>
<pre class="sourceCode bash" id="cb277"><code class="sourceCode bash"><div class="sourceLine" id="cb277-1" data-line-number="1">          \<span class="ex">e</span>[32m  \e[m</div>
<div class="sourceLine" id="cb277-2" data-line-number="2">          <span class="op">&lt;</span><span class="ex">----</span><span class="op">&gt;</span>  <span class="op">&lt;</span>--<span class="op">&gt;</span></div>
<div class="sourceLine" id="cb277-3" data-line-number="3"><span class="bu">echo</span> -e <span class="st">&#39;[\e[32mOK\e[m]&#39;</span></div></code></pre>
<h3 id="red">RED</h3>
<pre class="sourceCode bash" id="cb278"><code class="sourceCode bash"><div class="sourceLine" id="cb278-1" data-line-number="1">          \<span class="ex">e</span>[31m  \e[m</div>
<div class="sourceLine" id="cb278-2" data-line-number="2">          <span class="op">&lt;</span><span class="ex">----</span><span class="op">&gt;</span>  <span class="op">&lt;</span>--<span class="op">&gt;</span></div>
<div class="sourceLine" id="cb278-3" data-line-number="3"><span class="bu">echo</span> -e <span class="st">&#39;[\e[31mNG\e[m]&#39;</span></div></code></pre>
<h3 id="bold">BOLD</h3>
<pre class="sourceCode bash" id="cb279"><code class="sourceCode bash"><div class="sourceLine" id="cb279-1" data-line-number="1">         \<span class="ex">e</span>[1m         \e[m</div>
<div class="sourceLine" id="cb279-2" data-line-number="2">         <span class="op">&lt;</span><span class="ex">---</span><span class="op">&gt;</span>         <span class="op">&lt;</span>--<span class="op">&gt;</span></div>
<div class="sourceLine" id="cb279-3" data-line-number="3"><span class="bu">echo</span> -e <span class="st">&#39;\e[1mI AM BOLD\e[m&#39;</span></div></code></pre>
<h3 id="red-bold">RED + BOLD</h3>
<pre class="sourceCode bash" id="cb280"><code class="sourceCode bash"><div class="sourceLine" id="cb280-1" data-line-number="1">            \<span class="ex">e</span>[1m\e[31m        \e[m</div>
<div class="sourceLine" id="cb280-2" data-line-number="2">            <span class="op">&lt;</span><span class="ex">---</span><span class="op">&gt;&lt;</span>----<span class="op">&gt;</span>        <span class="op">&lt;</span>--<span class="op">&gt;</span></div>
<div class="sourceLine" id="cb280-3" data-line-number="3"><span class="bu">echo</span> -e <span class="st">&#39;zzz\e[1m\e[31mRED+BOLD\e[mzzz&#39;</span></div></code></pre>
<h3 id="what-ever">What Ever</h3>
<pre class="sourceCode bash" id="cb281"><code class="sourceCode bash"><div class="sourceLine" id="cb281-1" data-line-number="1"><span class="bu">echo</span> -e <span class="st">&quot;</span></div>
<div class="sourceLine" id="cb281-2" data-line-number="2"><span class="st"># Attribute codes:</span></div>
<div class="sourceLine" id="cb281-3" data-line-number="3"><span class="st"># 00=none 01=bold 04=underscore 05=blink 07=reverse 08=concealed</span></div>
<div class="sourceLine" id="cb281-4" data-line-number="4"><span class="st"># Text color codes:</span></div>
<div class="sourceLine" id="cb281-5" data-line-number="5"><span class="st"># 30=black 31=red 32=green 33=yellow 34=blue 35=magenta 36=cyan 37=white</span></div>
<div class="sourceLine" id="cb281-6" data-line-number="6"><span class="st"># Background color codes:</span></div>
<div class="sourceLine" id="cb281-7" data-line-number="7"><span class="st"># 40=black 41=red 42=green 43=yellow 44=blue 45=magenta 46=cyan 47=white</span></div>
<div class="sourceLine" id="cb281-8" data-line-number="8"></div>
<div class="sourceLine" id="cb281-9" data-line-number="9"><span class="st">状態番号</span></div>
<div class="sourceLine" id="cb281-10" data-line-number="10"><span class="st">\033[00m デフォルト状態 00 \033[00m</span></div>
<div class="sourceLine" id="cb281-11" data-line-number="11"><span class="st">\033[01m 強調           01 \033[00m</span></div>
<div class="sourceLine" id="cb281-12" data-line-number="12"><span class="st">\033[04m 下線           04 \033[00m</span></div>
<div class="sourceLine" id="cb281-13" data-line-number="13"><span class="st">\033[05m 点滅           05 \033[00m</span></div>
<div class="sourceLine" id="cb281-14" data-line-number="14"><span class="st">\033[07m 色反転         07 \033[00m</span></div>
<div class="sourceLine" id="cb281-15" data-line-number="15"><span class="st">\033[08m 塗りつぶし     08 \033[00m(塗りつぶし 08)</span></div>
<div class="sourceLine" id="cb281-16" data-line-number="16"></div>
<div class="sourceLine" id="cb281-17" data-line-number="17"><span class="st">色番号</span></div>
<div class="sourceLine" id="cb281-18" data-line-number="18"><span class="st">\033[30m 黒               30 \033[00m \033[40m 40 \033[00m \033[31;40m 31;40 \033[00m \033[32;00;40m 32;00;40 \033[00m</span></div>
<div class="sourceLine" id="cb281-19" data-line-number="19"><span class="st">\033[31m 赤               31 \033[00m \033[41m 41 \033[00m \033[32;41m 32;41 \033[00m \033[33;01;41m 33;01;41 \033[00m</span></div>
<div class="sourceLine" id="cb281-20" data-line-number="20"><span class="st">\033[32m 緑               32 \033[00m \033[42m 42 \033[00m \033[33;42m 33;42 \033[00m \033[34;04;42m 34;04;42 \033[00m</span></div>
<div class="sourceLine" id="cb281-21" data-line-number="21"><span class="st">\033[33m 黄(または茶)     33 \033[00m \033[43m 43 \033[00m \033[34;43m 34;43 \033[00m \033[35;05;43m 35;05;43 \033[00m</span></div>
<div class="sourceLine" id="cb281-22" data-line-number="22"><span class="st">\033[34m 青               34 \033[00m \033[44m 44 \033[00m \033[35;44m 35;44 \033[00m \033[36;07;44m 36;07;44 \033[00m</span></div>
<div class="sourceLine" id="cb281-23" data-line-number="23"><span class="st">\033[35m 紫               35 \033[00m \033[45m 45 \033[00m \033[36;45m 36;45 \033[00m \033[37;00;45m 37;00;45 \033[00m</span></div>
<div class="sourceLine" id="cb281-24" data-line-number="24"><span class="st">\033[36m シアン           36 \033[00m \033[46m 46 \033[00m \033[37;46m 37;46 \033[00m \033[30;01;46m 30;01;46 \033[00m</span></div>
<div class="sourceLine" id="cb281-25" data-line-number="25"><span class="st">\033[37m 白(またはグレー) 37 \033[00m \033[47m 47 \033[00m \033[30;47m 30;47 \033[00m \033[31;04;47m 31;04;47 \033[00m</span></div>
<div class="sourceLine" id="cb281-26" data-line-number="26"><span class="st">&quot;</span></div></code></pre>
<h1 id="ファイルの内容置換">ファイルの内容置換</h1>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-cmdreplace',data:{label:''
,CMD_REPLACE_BEFOR    : 'BEFOR'
,CMD_REPLACE_AFTER    : 'AFTER'
,CMD_REPLACE_FILENAME : '*.html'
}});})</script>
<div id="app-cmdreplace">
<form class="form-horizontal">
<varin label="BEFOR" v-model="CMD_REPLACE_BEFOR"></varin> <varin label="AFTER" v-model="CMD_REPLACE_AFTER"></varin> <varin label="FILE"  v-model="CMD_REPLACE_FILENAME"></varin>
</form>
<pre class="sourceCode bash" id="cb282"><code class="sourceCode bash"><div class="sourceLine" id="cb282-1" data-line-number="1"><span class="fu">grep</span> -rl <span class="st">&quot;{{CMD_REPLACE_BEFOR}}&quot;</span> */<span class="dt">{{CMD_REPLACE_FILENAME}}</span></div>
<div class="sourceLine" id="cb282-2" data-line-number="2"><span class="fu">perl</span> -p -i.befor -e <span class="st">&#39;s/{{CMD_REPLACE_BEFOR}}/{{CMD_REPLACE_AFTER}}/g&#39;</span> <span class="dt">{{CMD_REPLACE_FILENAME}}</span></div></code></pre>
<p>OR</p>
<pre class="sourceCode bash" id="cb283"><code class="sourceCode bash"><div class="sourceLine" id="cb283-1" data-line-number="1"><span class="fu">find</span> . -name <span class="st">&#39;{{CMD_REPLACE_FILENAME}}&#39;</span> -type f -exec sed -i <span class="st">&#39;s/{{CMD_REPLACE_BEFOR}}/{{CMD_REPLACE_AFTER}}/g&#39;</span> <span class="dt">{}</span> <span class="dt">\;</span></div></code></pre>
</div>
<h1 id="date-1">date</h1>
<h2 id="設定">設定</h2>
<pre class="sourceCode bash" id="cb284"><code class="sourceCode bash"><div class="sourceLine" id="cb284-1" data-line-number="1"><span class="fu">date</span> --set <span class="st">&quot;2016/12/31 12:34:56&quot;</span></div></code></pre>
<h2 id="from-通算秒-to-日時">from 通算秒 to 日時</h2>
<pre class="sourceCode bash" id="cb285"><code class="sourceCode bash"><div class="sourceLine" id="cb285-1" data-line-number="1"><span class="fu">date</span> -d <span class="st">&quot;1970-01-01 UTC 4294967295 seconds&quot;</span> <span class="st">&#39;+%Y-%m-%d %H:%M:%S&#39;</span></div></code></pre>
<h2 id="from-日時-to-通算秒">from 日時 to 通算秒</h2>
<pre class="sourceCode bash" id="cb286"><code class="sourceCode bash"><div class="sourceLine" id="cb286-1" data-line-number="1"><span class="fu">date</span> -d <span class="st">&quot;2000-01-01 00:00:00&quot;</span> +%s</div></code></pre>
<h2 id="watch">WATCH</h2>
<pre class="sourceCode bash" id="cb287"><code class="sourceCode bash"><div class="sourceLine" id="cb287-1" data-line-number="1"><span class="ex">watch</span> -t -n 0.1 --no-title <span class="st">&quot;date  +&#39;%n +------------+%n | %Y-%m-%d |%n +------------+%n |  %H:%M:%S  |%n +------------+%n | %N0 |%n +------------+%n | %s |%n +------------+&#39;&quot;</span></div></code></pre>
<pre class="sourceCode bash" id="cb288"><code class="sourceCode bash"><div class="sourceLine" id="cb288-1" data-line-number="1"><span class="kw">while</span> <span class="fu">true</span><span class="kw">;do</span> <span class="fu">date</span> +<span class="st">&quot;%Y-%m-%d %H:%M:%S.%N&quot;</span><span class="kw">;</span><span class="fu">sleep</span> 1<span class="kw">;done</span></div></code></pre>
<h2 id="timer">TIMER</h2>
<pre class="sourceCode bash" id="cb289"><code class="sourceCode bash"><div class="sourceLine" id="cb289-1" data-line-number="1"><span class="ex">watch</span> -n 0.1 --no-title <span class="st">&#39;expr `date +%s -d &quot;2020-12-31 23:59:59&quot;` - `date +%s`&#39;</span></div></code></pre>
<h2 id="日時書式">日時書式</h2>
<pre class="sourceCode bash" id="cb290"><code class="sourceCode bash"><div class="sourceLine" id="cb290-1" data-line-number="1"><span class="fu">date</span></div>
<div class="sourceLine" id="cb290-2" data-line-number="2"><span class="fu">date</span> +<span class="st">&quot;%Y-%m-%d %H:%M:%S&quot;</span></div></code></pre>
<h2 id="offset">OFFSET</h2>
<pre class="sourceCode bash" id="cb291"><code class="sourceCode bash"><div class="sourceLine" id="cb291-1" data-line-number="1"><span class="fu">date</span></div>
<div class="sourceLine" id="cb291-2" data-line-number="2"><span class="fu">date</span> -d <span class="st">&quot;12 hours ago&quot;</span></div>
<div class="sourceLine" id="cb291-3" data-line-number="3"><span class="fu">date</span> -d <span class="st">&quot;12 hours&quot;</span></div></code></pre>
<h3 id="ファイル検索-コマンド実行">ファイル検索 &amp; コマンド実行</h3>
<pre class="sourceCode bash" id="cb292"><code class="sourceCode bash"><div class="sourceLine" id="cb292-1" data-line-number="1"><span class="fu">find</span> <span class="kw">|</span> <span class="fu">grep</span> <span class="op">&lt;</span>検索文字<span class="op">&gt;</span> <span class="kw">|</span> <span class="fu">xargs</span> <span class="op">&lt;</span>コマンド<span class="op">&gt;</span></div></code></pre>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-fileandfile',data:{label:''
,CMD_FILE1    : 'CMD_FILE1'
,CMD_FILE2    : 'CMD_FILE2'
}});})</script>
<div id="app-fileandfile">
<form class="form-horizontal">
<varin label="FILE-1" v-model="CMD_FILE1"></varin> <varin label="FILE-2" v-model="CMD_FILE2"></varin>
</form>
<h3 id="ナイスな-diff">ナイスな diff</h3>
<pre class="sourceCode bash" id="cb293"><code class="sourceCode bash"><div class="sourceLine" id="cb293-1" data-line-number="1"><span class="fu">diff</span> -y --suppress-common-lines <span class="dt">{{CMD_FILE1}}</span> <span class="dt">{{CMD_FILE2}}</span></div></code></pre>
<h3 id="ファイルの単純横結合">ファイルの単純横結合</h3>
<pre class="sourceCode bash" id="cb294"><code class="sourceCode bash"><div class="sourceLine" id="cb294-1" data-line-number="1"><span class="ex">paste</span>  <span class="dt">{{CMD_FILE1}}</span> <span class="dt">{{CMD_FILE2}}</span></div></code></pre>
</div>
<h3 id="プロンプト反転">プロンプト反転</h3>
<pre class="sourceCode bash" id="cb295"><code class="sourceCode bash"><div class="sourceLine" id="cb295-1" data-line-number="1"><span class="va">PS1=</span><span class="st">&quot;\[\033[07m\][\u@</span><span class="va">${HOSTNAME}</span><span class="st"> \W]</span><span class="dt">\\</span><span class="st">$\[\033[00m\] &quot;</span></div></code></pre>
<h3 id="pgrep">pgrep</h3>
<pre class="sourceCode bash" id="cb296"><code class="sourceCode bash"><div class="sourceLine" id="cb296-1" data-line-number="1"><span class="ex">pgrep</span> procname*</div></code></pre>
<h4 id="pkill-and-kill">pkill and kill</h4>
<pre class="sourceCode bash" id="cb297"><code class="sourceCode bash"><div class="sourceLine" id="cb297-1" data-line-number="1"><span class="ex">pgrep</span> procname* <span class="kw">|</span> <span class="fu">xargs</span> kill -9</div></code></pre>
<h3 id="exfat">exfat</h3>
<pre class="sourceCode bash" id="cb298"><code class="sourceCode bash"><div class="sourceLine" id="cb298-1" data-line-number="1"><span class="fu">sudo</span> mount -t exfat-fuse /dev/sde1 /media/exfat</div>
<div class="sourceLine" id="cb298-2" data-line-number="2"><span class="fu">umount</span> /media/exfat</div></code></pre>
<h3 id="lang">LANG</h3>
<pre class="sourceCode bash" id="cb299"><code class="sourceCode bash"><div class="sourceLine" id="cb299-1" data-line-number="1"><span class="bu">export</span> <span class="va">LANG=</span>en_US.UTF-8</div></code></pre>
<h3 id="scp">scp</h3>
<pre class="sourceCode bash" id="cb300"><code class="sourceCode bash"><div class="sourceLine" id="cb300-1" data-line-number="1"><span class="fu">scp</span> -P 22 -rq tcp/ username@192.168.33.32:/home/aaa/</div></code></pre>
<h1 id="vi">VI</h1>
<h2 id="edit">EDIT</h2>
<h3 id="置換え">置換え</h3>
<h4 id="確認あり">確認あり</h4>
<pre class="sourceCode bash" id="cb301"><code class="sourceCode bash"><div class="sourceLine" id="cb301-1" data-line-number="1">:<span class="ex">%s</span>/前/後<span class="ex">/gc</span></div></code></pre>
<h4 id="確認なし">確認なし</h4>
<pre class="sourceCode bash" id="cb302"><code class="sourceCode bash"><div class="sourceLine" id="cb302-1" data-line-number="1">:<span class="ex">%s</span>/前/後<span class="ex">/g</span></div></code></pre>
<h2 id="view-1">VIEW</h2>
<h3 id="カーソル移動-1">カーソル移動</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">key</th>
<th style="text-align: left;">move</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1G</td>
<td style="text-align: left;">1 行目のあたま</td>
</tr>
<tr class="even">
<td style="text-align: center;">G</td>
<td style="text-align: left;">最終行のケツ</td>
</tr>
<tr class="odd">
<td style="text-align: center;">~</td>
<td style="text-align: left;">今の行のあたま</td>
</tr>
<tr class="even">
<td style="text-align: center;">$</td>
<td style="text-align: left;">今の行のケツ</td>
</tr>
<tr class="odd">
<td style="text-align: center;">[CTR]+[b]</td>
<td style="text-align: left;">ページアップ</td>
</tr>
<tr class="even">
<td style="text-align: center;">[CTR]+[f]</td>
<td style="text-align: left;">ページダウン</td>
</tr>
</tbody>
</table>
<h1 id="windows-3">WINDOWS</h1>
<h2 id="disk-wipe">DISK WIPE</h2>
<pre><code>cipher /w:c:</code></pre>
<h2 id="network-1">NETWORK</h2>
<p>ドス窓は管理者権限で実行</p>
<h3 id="ip-アドレス設定">IP アドレス設定</h3>
<pre><code>netsh interface ipv4 set address name=&quot;ローカル エリア接続&quot; addr=192.2.56.111 mask=255.255.255.0 gateway=192.2.56.1</code></pre>
<h3 id="ip-アドレス追加">IP アドレス追加</h3>
<p>追加の場合は gateway 不要</p>
<pre><code>netsh interface ipv4 add address name=&quot;ローカル エリア接続&quot; addr=192.2.56.111 mask=255.255.255.0</code></pre>
<h3 id="ip-アドレス削除">IP アドレス削除</h3>
<pre><code>netsh interface ipv4 del address name=&quot;ローカル エリア接続&quot; addr=192.2.56.111</code></pre>
<h3 id="dns">DNS</h3>
<h4 id="display">display</h4>
<pre><code>ipconfig /displaydns</code></pre>
<h4 id="flush">flush</h4>
<pre><code>ipconfig /flushdns</code></pre>
<h3 id="各種情報収集">各種情報収集</h3>
<pre><code>mkdir .\%COMPUTERNAME%
cd .\%COMPUTERNAME%

echo &quot;&quot;        &gt; 10_SYSTEM
systeminfo     &gt; 11_SYSTEM__systeminfo.txt
msinfo32 /report 12_SYSTEM__msinfo32.txt

echo &quot;&quot;        &gt; 20_NETWORK
ipconfig /all  &gt; 21_NETWORK__ipconfig_all.txt
route print    &gt; 22_NETWORK__route_print.txt
netstat -sp    &gt; 23_NETWORK__netstat_sp.txt
netstat -e     &gt; 24_NETWORK__netstat_e.txt
net use        &gt; 25_NETWORK__net_use.txt

echo &quot;&quot;            &gt; 30_TASK
schtasks /query /V &gt; 31_TASK__shttasks.txt
tasklist           &gt; 32_TASK__tasklist.txt
tasklist /svc      &gt; 33_TASK__tasklist_svc.txt
tasklist /m        &gt; 34_TASK__tasklist_m.txt

echo &quot;&quot;                        &gt; 40_LOG
wevutil qe system      /f:TEXT &gt; 41_LOG__wevutil_qe_system.txt
wevutil qe Application /f:TEXT &gt; 42_LOG__wevutil_qe_application.txt</code></pre>
<h1 id="nxr120">NXR120</h1>
<h2 id="web">Web</h2>
<pre><code>http://IPADDRESS:880/
(admin/admin)</code></pre>
<h2 id="ssh-1">ssh</h2>
<h3 id="設定の確認">設定の確認</h3>
<pre><code>show config</code></pre>
<h3 id="default-gateway">default gateway</h3>
<pre><code>configure terminal
ip route 0.0.0.0/0 196.1.58.1
exit
save config</code></pre>
<h3 id="ip-masquerade">ip masquerade</h3>
<pre><code>configure terminal
   interface ethernet 1
      ip masquerade
   exit
exit
save config</code></pre>
<h3 id="speed">Speed</h3>
<pre><code>configure terminal
   interface ethernet 1
      speed 10M-full
   exit
exit
save config</code></pre>
<h3 id="ブリッジの設定方法">ブリッジの設定方法</h3>
<p>設定上は masquerade と共存が可能であるが、その場合 masquerade は機能しない（アドレス変換されない）。</p>
<pre><code>configure terminal
   interface bridge 0
      ip address 192.168.10.1/24
      bridge port 1 ethernet 0
      bridge port 2 ethernet 1
   exit
exit
save config</code></pre>
<h3 id="nat">1:1 NAT</h3>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-nxr120-nat',data:{label:''
,nxr_e0ip    : '192.168.0.1'
,NXR_RIP    : '192.168.0.10'
,nxr_e1ip    : '11.22.33.1'
,nxr_vip    : '11.22.33.10'
}});})</script>
<div id="app-nxr120-nat">
<form class="form-horizontal">
<varin label="ethernet0 IP" v-model="nxr_e0ip"></varin> <varin label="host IP"      v-model="NXR_RIP"></varin> <varin label="ethernet1 IP" v-model="nxr_e1ip"></varin> <varin label="host virtIP"  v-model="nxr_vip"></varin>
</form>
<pre class="sourceCode sh" id="cb316"><code class="sourceCode bash"><div class="sourceLine" id="cb316-1" data-line-number="1"><span class="ex">show</span> config</div>
<div class="sourceLine" id="cb316-2" data-line-number="2"><span class="ex">configure</span> terminal</div>
<div class="sourceLine" id="cb316-3" data-line-number="3"></div>
<div class="sourceLine" id="cb316-4" data-line-number="4"><span class="ex">system</span> dnat-group DNAT</div>
<div class="sourceLine" id="cb316-5" data-line-number="5"><span class="ex">system</span> snat-group SNAT</div>
<div class="sourceLine" id="cb316-6" data-line-number="6"><span class="ex">ip</span> dnat DNAT ip any <span class="dt">{{nxr_vip}}</span> <span class="dt">{{NXR_RIP}}</span></div>
<div class="sourceLine" id="cb316-7" data-line-number="7"><span class="ex">ip</span> snat SNAT ip <span class="dt">{{NXR_RIP}}</span> any <span class="dt">{{nxr_vip}}</span></div>
<div class="sourceLine" id="cb316-8" data-line-number="8"></div>
<div class="sourceLine" id="cb316-9" data-line-number="9"><span class="ex">interface</span> ethernet 0</div>
<div class="sourceLine" id="cb316-10" data-line-number="10"></div>
<div class="sourceLine" id="cb316-11" data-line-number="11">  <span class="ex">ip</span> address <span class="dt">{{nxr_e0ip}}</span>/24</div>
<div class="sourceLine" id="cb316-12" data-line-number="12">  <span class="ex">ip</span> snat-group SNAT</div>
<div class="sourceLine" id="cb316-13" data-line-number="13">  <span class="bu">exit</span></div>
<div class="sourceLine" id="cb316-14" data-line-number="14"></div>
<div class="sourceLine" id="cb316-15" data-line-number="15"><span class="ex">interface</span> ethernet 1</div>
<div class="sourceLine" id="cb316-16" data-line-number="16"></div>
<div class="sourceLine" id="cb316-17" data-line-number="17">  <span class="ex">ip</span> address <span class="dt">{{nxr_e1ip}}</span>/24</div>
<div class="sourceLine" id="cb316-18" data-line-number="18">  <span class="ex">ip</span> address <span class="dt">{{nxr_vip}}</span>/24 secondary</div>
<div class="sourceLine" id="cb316-19" data-line-number="19">  <span class="ex">ip</span> dnat-group DNAT</div>
<div class="sourceLine" id="cb316-20" data-line-number="20">  <span class="bu">exit</span></div>
<div class="sourceLine" id="cb316-21" data-line-number="21"></div>
<div class="sourceLine" id="cb316-22" data-line-number="22"><span class="bu">exit</span></div>
<div class="sourceLine" id="cb316-23" data-line-number="23"><span class="ex">save</span> config</div>
<div class="sourceLine" id="cb316-24" data-line-number="24"><span class="ex">restart</span></div></code></pre>
</div>
<h3 id="ip-filter">ip filter</h3>
<pre class="sourceCode sh" id="cb317"><code class="sourceCode bash"><div class="sourceLine" id="cb317-1" data-line-number="1"><span class="ex">configure</span> terminal</div>
<div class="sourceLine" id="cb317-2" data-line-number="2"></div>
<div class="sourceLine" id="cb317-3" data-line-number="3"><span class="ex">ip</span> access-list eth0_in permit 192.2.58.221/32 192.2.58.220/32 tcp any 22</div>
<div class="sourceLine" id="cb317-4" data-line-number="4"><span class="ex">ip</span> access-list eth0_in permit 192.2.58.221/32 192.2.58.220/32 tcp any 880</div>
<div class="sourceLine" id="cb317-5" data-line-number="5"><span class="ex">ip</span> access-list eth0_in permit any any icmp</div>
<div class="sourceLine" id="cb317-6" data-line-number="6"><span class="ex">ip</span> access-list eth0_in deny any any</div>
<div class="sourceLine" id="cb317-7" data-line-number="7"></div>
<div class="sourceLine" id="cb317-8" data-line-number="8"><span class="ex">ip</span> access-list eth1_in permit any any tcp any any</div>
<div class="sourceLine" id="cb317-9" data-line-number="9"><span class="ex">ip</span> access-list eth1_in permit 195.200.58.33/32 any tcp any 80</div>
<div class="sourceLine" id="cb317-10" data-line-number="10"><span class="ex">ip</span> access-list eth1_in permit 195.200.58.33/32 any tcp any range 1024 65535</div>
<div class="sourceLine" id="cb317-11" data-line-number="11"><span class="ex">ip</span> access-list eth1_in permit any any icmp</div>
<div class="sourceLine" id="cb317-12" data-line-number="12"><span class="ex">ip</span> access-list eth1_in deny any any</div>
<div class="sourceLine" id="cb317-13" data-line-number="13"></div>
<div class="sourceLine" id="cb317-14" data-line-number="14"><span class="ex">ip</span> access-list eth1_forward_in permit 195.200.58.33/32 any tcp any range 1024 65535</div>
<div class="sourceLine" id="cb317-15" data-line-number="15"><span class="ex">ip</span> access-list eth1_forward_in permit any any tcp any range 80 81</div>
<div class="sourceLine" id="cb317-16" data-line-number="16"><span class="ex">ip</span> access-list eth1_forward_in permit any any tcp any 8081</div>
<div class="sourceLine" id="cb317-17" data-line-number="17"><span class="ex">ip</span> access-list eth1_forward_in permit any any tcp any 8084</div>
<div class="sourceLine" id="cb317-18" data-line-number="18"><span class="ex">ip</span> access-list eth1_forward_in permit 196.2.58.221/32 any tcp any range 1024 65535</div>
<div class="sourceLine" id="cb317-19" data-line-number="19"><span class="ex">ip</span> access-list eth1_forward_in permit any any tcp range 80 81 any</div>
<div class="sourceLine" id="cb317-20" data-line-number="20"><span class="ex">ip</span> access-list eth1_forward_in permit any any tcp 8081 any</div>
<div class="sourceLine" id="cb317-21" data-line-number="21"><span class="ex">ip</span> access-list eth1_forward_in permit any any tcp 8084 any</div>
<div class="sourceLine" id="cb317-22" data-line-number="22"><span class="ex">ip</span> access-list eth1_forward_in permit 193.2.14.31/32 192.2.58.221/32 tcp any any</div>
<div class="sourceLine" id="cb317-23" data-line-number="23"><span class="ex">ip</span> access-list eth1_forward_in permit 193.3.15.31/32 192.2.58.221/32 tcp any any</div>
<div class="sourceLine" id="cb317-24" data-line-number="24"><span class="ex">ip</span> access-list eth1_forward_in permit 192.2.58.221/32 193.2.14.31/32 tcp any any</div>
<div class="sourceLine" id="cb317-25" data-line-number="25"><span class="ex">ip</span> access-list eth1_forward_in permit 192.2.58.221/32 193.3.15.31/32 tcp any any</div>
<div class="sourceLine" id="cb317-26" data-line-number="26"><span class="ex">ip</span> access-list eth1_forward_in permit any any icmp</div>
<div class="sourceLine" id="cb317-27" data-line-number="27"><span class="ex">ip</span> access-list eth1_forward_in deny any any</div>
<div class="sourceLine" id="cb317-28" data-line-number="28"></div>
<div class="sourceLine" id="cb317-29" data-line-number="29"></div>
<div class="sourceLine" id="cb317-30" data-line-number="30"><span class="ex">interface</span> ethernet 0</div>
<div class="sourceLine" id="cb317-31" data-line-number="31">   <span class="ex">ip</span> access-group in eth0_in</div>
<div class="sourceLine" id="cb317-32" data-line-number="32"><span class="bu">exit</span></div>
<div class="sourceLine" id="cb317-33" data-line-number="33"></div>
<div class="sourceLine" id="cb317-34" data-line-number="34"><span class="ex">interface</span> ethernet 1</div>
<div class="sourceLine" id="cb317-35" data-line-number="35">   <span class="ex">ip</span> access-group in eth1_in</div>
<div class="sourceLine" id="cb317-36" data-line-number="36">   <span class="ex">ip</span> access-group forward_in eth1_forward_in</div>
<div class="sourceLine" id="cb317-37" data-line-number="37"><span class="bu">exit</span></div>
<div class="sourceLine" id="cb317-38" data-line-number="38"></div>
<div class="sourceLine" id="cb317-39" data-line-number="39"><span class="ex">save</span> config</div>
<div class="sourceLine" id="cb317-40" data-line-number="40"></div>
<div class="sourceLine" id="cb317-41" data-line-number="41"><span class="ex">restart</span></div></code></pre>
<h3 id="設定の無効化">設定の無効化</h3>
<pre><code>頭に no をつける</code></pre>
<h1 id="ssh-2">SSH</h1>
<h2 id="no-pass-login">NO PASS LOGIN</h2>
<h3 id="on-local">on LOCAL</h3>
<h4 id="keygen">keygen</h4>
<pre class="sourceCode bash" id="cb319"><code class="sourceCode bash"><div class="sourceLine" id="cb319-1" data-line-number="1"><span class="fu">ssh-keygen</span></div>
<div class="sourceLine" id="cb319-2" data-line-number="2"><span class="fu">ssh-add</span> ./id_rsa...?</div>
<div class="sourceLine" id="cb319-3" data-line-number="3"><span class="fu">cat</span> ~/.ssh/id_rsa.pub</div></code></pre>
<h3 id="on-server">on SERVER</h3>
<h4 id="paste">paste</h4>
<pre class="sourceCode bash" id="cb320"><code class="sourceCode bash"><div class="sourceLine" id="cb320-1" data-line-number="1"><span class="ex">/home/USERNAME/.ssh/authorized_keys</span></div></code></pre>
<h1 id="centos">CENTOS</h1>
<h2 id="single-user-mode">single user mode</h2>
<ul>
<li>起動カウントダウン中に [ENTER] を押す。</li>
<li>karnel… の行を選んで [e] を押す。</li>
<li>起動オプションの末尾に [スペース]+single を追記して [ENTER] を押す。</li>
<li>karnel… の行を選んで [b] を押す。</li>
</ul>
<h2 id="selinux-1">SELINUX</h2>
<h3 id="状況確認">状況確認</h3>
<pre class="sourceCode bash" id="cb321"><code class="sourceCode bash"><div class="sourceLine" id="cb321-1" data-line-number="1"><span class="ex">getenforce</span></div></code></pre>
<h3 id="一時的な-off">一時的な OFF</h3>
<pre class="sourceCode bash" id="cb322"><code class="sourceCode bash"><div class="sourceLine" id="cb322-1" data-line-number="1"><span class="ex">setenforce</span> 0</div></code></pre>
<h3 id="恒久的な-off">恒久的な OFF</h3>
<h4 id="etcselinuxconfig">/etc/selinux/config</h4>
<pre class="sourceCode bash" id="cb323"><code class="sourceCode bash"><div class="sourceLine" id="cb323-1" data-line-number="1"><span class="va">SELINUX=</span>disabled</div></code></pre>
<h2 id="network-2">NETWORK</h2>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-eth',data:{label:''
,CENT_NET_IFNAME: 'eth0'
}});})</script>
<div id="app-eth">
<form class="form-horizontal">
<varin label="I/F NAME"  v-model="CENT_NET_IFNAME"></varin>
</form>
<h3 id="ip-アドレスリンクスピード固定化">IP アドレス・リンクスピード固定化</h3>
<h4 id="etcsysconfignetwork-scriptsifcfg-eth0">/etc/sysconfig/network-scripts/ifcfg-eth0</h4>
<pre class="sourceCode bash" id="cb324"><code class="sourceCode bash"><div class="sourceLine" id="cb324-1" data-line-number="1"><span class="va">HWADDR=</span>XX:XX:XX:XX:XX:XX</div>
<div class="sourceLine" id="cb324-2" data-line-number="2"><span class="va">DEVICE=</span><span class="dt">{{CENT_NET_IFNAME}}</span></div>
<div class="sourceLine" id="cb324-3" data-line-number="3"><span class="va">BOOTPROTO=</span>none</div>
<div class="sourceLine" id="cb324-4" data-line-number="4"><span class="va">ONBOOT=</span>yes</div>
<div class="sourceLine" id="cb324-5" data-line-number="5"><span class="va">USERCTL=</span>no</div>
<div class="sourceLine" id="cb324-6" data-line-number="6"><span class="va">IPV6INIT=</span>no</div>
<div class="sourceLine" id="cb324-7" data-line-number="7"><span class="va">PEERDNS=</span>no</div>
<div class="sourceLine" id="cb324-8" data-line-number="8"><span class="va">TYPE=</span>Ethernet</div>
<div class="sourceLine" id="cb324-9" data-line-number="9"><span class="va">IPADDR=</span>192.168.1.10</div>
<div class="sourceLine" id="cb324-10" data-line-number="10"><span class="va">NETMASK=</span>255.255.255.0</div>
<div class="sourceLine" id="cb324-11" data-line-number="11"><span class="va">ETHTOOL_OPTS=</span><span class="st">&quot;autoneg off speed 10 duplex full&quot;</span></div></code></pre>
<h4 id="sudo">sudo</h4>
<pre class="sourceCode bash" id="cb325"><code class="sourceCode bash"><div class="sourceLine" id="cb325-1" data-line-number="1"><span class="ex">service</span> network restart</div></code></pre>
<h3 id="ip-エイリアス">IP エイリアス</h3>
<h4 id="sudo-1">sudo</h4>
<pre class="sourceCode bash" id="cb326"><code class="sourceCode bash"><div class="sourceLine" id="cb326-1" data-line-number="1"><span class="bu">cd</span> /etc/sysconfig/network-scripts</div>
<div class="sourceLine" id="cb326-2" data-line-number="2"><span class="fu">cp</span> ifcfg-<span class="dt">{{CENT_NET_IFNAME}}</span> ifcfg-<span class="dt">{{CENT_NET_IFNAME}}</span>:1</div></code></pre>
<h4 id="etcsysconfignetwork-scriptsifcfg-cent_net_ifname1">/etc/sysconfig/network-scripts/ifcfg-{{CENT_NET_IFNAME}}:1</h4>
<pre class="sourceCode bash" id="cb327"><code class="sourceCode bash"><div class="sourceLine" id="cb327-1" data-line-number="1"><span class="va">HWADDR=</span>XX:XX:XX:XX:XX:XX</div>
<div class="sourceLine" id="cb327-2" data-line-number="2"><span class="va">DEVICE=</span><span class="dt">{{CENT_NET_IFNAME}}</span>:1</div>
<div class="sourceLine" id="cb327-3" data-line-number="3"><span class="va">BOOTPROTO=</span>none</div>
<div class="sourceLine" id="cb327-4" data-line-number="4"><span class="va">ONBOOT=</span>yes</div>
<div class="sourceLine" id="cb327-5" data-line-number="5"><span class="va">USERCTL=</span>no</div>
<div class="sourceLine" id="cb327-6" data-line-number="6"><span class="va">IPV6INIT=</span>no</div>
<div class="sourceLine" id="cb327-7" data-line-number="7"><span class="va">PEERDNS=</span>no</div>
<div class="sourceLine" id="cb327-8" data-line-number="8"><span class="va">TYPE=</span>Ethernet</div>
<div class="sourceLine" id="cb327-9" data-line-number="9"><span class="va">IPADDR=</span>192.168.1.10</div>
<div class="sourceLine" id="cb327-10" data-line-number="10"><span class="va">NETMASK=</span>255.255.255.0</div>
<div class="sourceLine" id="cb327-11" data-line-number="11"><span class="va">ETHTOOL_OPTS=</span><span class="st">&quot;autoneg off speed 10 duplex full&quot;</span></div></code></pre>
<pre class="sourceCode bash" id="cb328"><code class="sourceCode bash"><div class="sourceLine" id="cb328-1" data-line-number="1"><span class="ex">service</span> network restart</div></code></pre>
<h3 id="スタティックルート">スタティックルート</h3>
<h4 id="etcsysconfigstatic-routes">/etc/sysconfig/static-routes</h4>
<pre class="sourceCode bash" id="cb329"><code class="sourceCode bash"><div class="sourceLine" id="cb329-1" data-line-number="1"><span class="ex">any</span> net 123.1.2.0 netmask 255.255.255.0 gw 192.168.0.201</div></code></pre>
<h4 id="sudo-2">sudo</h4>
<pre class="sourceCode bash" id="cb330"><code class="sourceCode bash"><div class="sourceLine" id="cb330-1" data-line-number="1"><span class="ex">service</span> network restart</div></code></pre>
<h3 id="デフォルトゲートウェイホスト名">デフォルトゲートウェイ・ホスト名</h3>
<h4 id="etcsysconfignetwork">/etc/sysconfig/network</h4>
<pre class="sourceCode bash" id="cb331"><code class="sourceCode bash"><div class="sourceLine" id="cb331-1" data-line-number="1"><span class="va">NETWORKING=</span>yes</div>
<div class="sourceLine" id="cb331-2" data-line-number="2"><span class="va">NETWORKING_IPV6=</span>no</div>
<div class="sourceLine" id="cb331-3" data-line-number="3"><span class="va">HOSTNAME=</span>SERVERNAME</div>
<div class="sourceLine" id="cb331-4" data-line-number="4"><span class="va">GATEWAY=</span>192.168.0.123</div></code></pre>
<pre class="sourceCode bash" id="cb332"><code class="sourceCode bash"><div class="sourceLine" id="cb332-1" data-line-number="1"><span class="ex">service</span> network restart</div></code></pre>
</div>
<h1 id="yum-1">YUM</h1>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-yum',data:{label:''
,YUM_PKG: 'httpd'
,YUM_OPT: 'YUM_OPT="--disablerepo=\\* --enablerepo=c6-media"'
}});})</script>
<div id="app-yum">
<form class="form-horizontal">
<varin label="PKG NAME"  v-model="YUM_PKG"></varin> <varin label="OPT"       v-model="YUM_OPT"></varin>
</form>
<h2 id="repo">REPO</h2>
<h3 id="files-1">FILES</h3>
<pre class="sourceCode bash" id="cb333"><code class="sourceCode bash"><div class="sourceLine" id="cb333-1" data-line-number="1"><span class="ex">/etc/yum.repos.d</span></div></code></pre>
<h3 id="add-1">ADD</h3>
<h4 id="epel">EPEL</h4>
<pre class="sourceCode bash" id="cb334"><code class="sourceCode bash"><div class="sourceLine" id="cb334-1" data-line-number="1"><span class="ex">yum</span> install epel-release</div></code></pre>
<pre class="sourceCode bash" id="cb335"><code class="sourceCode bash"><div class="sourceLine" id="cb335-1" data-line-number="1"><span class="ex">curl</span> http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6 \</div>
<div class="sourceLine" id="cb335-2" data-line-number="2">  -o <span class="va">$RPMDIR</span>/RPM-GPG-KEY-EPEL-6</div>
<div class="sourceLine" id="cb335-3" data-line-number="3"><span class="ex">curl</span> http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm \</div>
<div class="sourceLine" id="cb335-4" data-line-number="4">  -o <span class="va">$RPMDIR</span>/epel-release-6-8.noarch.rpm</div>
<div class="sourceLine" id="cb335-5" data-line-number="5"></div>
<div class="sourceLine" id="cb335-6" data-line-number="6"><span class="fu">sudo</span> rpm --import file://<span class="va">$RPMDIR</span>/RPM-GPG-KEY-EPEL-6</div>
<div class="sourceLine" id="cb335-7" data-line-number="7"><span class="fu">sudo</span> rpm -ihv file://<span class="va">$RPMDIR</span>/epel-release-6-8.noarch.rpm</div></code></pre>
<h3 id="onoff-repo">ON/OFF REPO</h3>
<pre class="sourceCode bash" id="cb336"><code class="sourceCode bash"><div class="sourceLine" id="cb336-1" data-line-number="1"><span class="ex">yum</span> --disablerepo=<span class="dt">\*</span> --enablerepo=c6-media ...</div></code></pre>
<h2 id="package">PACKAGE</h2>
<h3 id="dependencies">dependencies</h3>
<pre class="sourceCode bash" id="cb337"><code class="sourceCode bash"><div class="sourceLine" id="cb337-1" data-line-number="1"><span class="ex">yum</span> deplist <span class="dt">{{YUM_PKG}}</span> <span class="dt">{{YUM_OPT}}</span></div></code></pre>
<pre class="sourceCode bash" id="cb338"><code class="sourceCode bash"><div class="sourceLine" id="cb338-1" data-line-number="1"><span class="ex">yum</span> deplist <span class="dt">{{YUM_PKG}}</span> <span class="dt">{{YUM_OPT}}</span> <span class="kw">|</span> <span class="fu">grep</span> provider</div></code></pre>
<h3 id="download">DOWNLOAD</h3>
<pre class="sourceCode bash" id="cb339"><code class="sourceCode bash"><div class="sourceLine" id="cb339-1" data-line-number="1"><span class="ex">yumdownloader</span> --resolve <span class="dt">{{YUM_PKG}}</span></div></code></pre>
<h3 id="install-from-local-rpm">INSTALL from LOCAL RPM</h3>
<pre class="sourceCode bash" id="cb340"><code class="sourceCode bash"><div class="sourceLine" id="cb340-1" data-line-number="1"><span class="ex">yum</span> --disablerepo=<span class="dt">\*</span> -y localinstall ./*.rpm</div></code></pre>
<h3 id="list-8">LIST</h3>
<pre class="sourceCode bash" id="cb341"><code class="sourceCode bash"><div class="sourceLine" id="cb341-1" data-line-number="1"><span class="ex">yum</span> <span class="dt">{{YUM_OPT}}</span> list</div></code></pre>
<h3 id="create-local-repos.">CREATE LOCAL REPOS.</h3>
<pre class="sourceCode bash" id="cb342"><code class="sourceCode bash"><div class="sourceLine" id="cb342-1" data-line-number="1"><span class="co">#!/bin/bash</span></div>
<div class="sourceLine" id="cb342-2" data-line-number="2"></div>
<div class="sourceLine" id="cb342-3" data-line-number="3"><span class="kw">function</span><span class="fu"> download_yum</span> <span class="kw">{</span></div>
<div class="sourceLine" id="cb342-4" data-line-number="4">    <span class="kw">if</span><span class="bu"> [</span> <span class="ot">!</span> <span class="ot">-e</span> <span class="va">${YUMDIR}</span>/repodata/repomd.xml<span class="bu"> ]</span> ; <span class="kw">then</span></div>
<div class="sourceLine" id="cb342-5" data-line-number="5">    <span class="fu">sudo</span> yum install -y yum-plugin-downloadonly createrepo</div>
<div class="sourceLine" id="cb342-6" data-line-number="6">    <span class="fu">sudo</span> yum install -y --downloadonly --downloaddir=<span class="va">${YUMDIR}</span> <span class="va">${YUMPKGS}</span></div>
<div class="sourceLine" id="cb342-7" data-line-number="7">    <span class="fu">sudo</span> createrepo -v <span class="va">${YUMDIR}</span></div>
<div class="sourceLine" id="cb342-8" data-line-number="8">    <span class="fu">sudo</span> yum clean all</div>
<div class="sourceLine" id="cb342-9" data-line-number="9">    <span class="kw">fi</span></div>
<div class="sourceLine" id="cb342-10" data-line-number="10"><span class="kw">}</span></div>
<div class="sourceLine" id="cb342-11" data-line-number="11"></div>
<div class="sourceLine" id="cb342-12" data-line-number="12"><span class="kw">function</span><span class="fu"> mk_repofile</span> <span class="kw">{</span></div>
<div class="sourceLine" id="cb342-13" data-line-number="13">    <span class="fu">sudo</span> chmod 777 /etc/yum.repos.d</div>
<div class="sourceLine" id="cb342-14" data-line-number="14">    <span class="co"># sudo rm -f /etc/yum.repos.d/*</span></div>
<div class="sourceLine" id="cb342-15" data-line-number="15">    <span class="va">REPOFILE=</span>/etc/yum.repos.d/<span class="va">${REPONAME}</span>.repo</div>
<div class="sourceLine" id="cb342-16" data-line-number="16">    <span class="bu">echo</span> [<span class="va">${REPONAME}</span>]             <span class="op">&gt;</span>  <span class="va">${REPOFILE}</span></div>
<div class="sourceLine" id="cb342-17" data-line-number="17">    <span class="bu">echo</span> gpgcheck=0                <span class="op">&gt;&gt;</span> <span class="va">${REPOFILE}</span></div>
<div class="sourceLine" id="cb342-18" data-line-number="18">    <span class="bu">echo</span> name=<span class="va">${REPONAME}</span>          <span class="op">&gt;&gt;</span> <span class="va">${REPOFILE}</span></div>
<div class="sourceLine" id="cb342-19" data-line-number="19">    <span class="bu">echo</span> baseurl=file://<span class="va">${YUMDIR}</span>/ <span class="op">&gt;&gt;</span> <span class="va">${REPOFILE}</span></div>
<div class="sourceLine" id="cb342-20" data-line-number="20">    <span class="bu">echo</span> enabled=1                 <span class="op">&gt;&gt;</span> <span class="va">${REPOFILE}</span></div>
<div class="sourceLine" id="cb342-21" data-line-number="21">    <span class="fu">sudo</span> chmod 755 /etc/yum.repos.d</div>
<div class="sourceLine" id="cb342-22" data-line-number="22">    <span class="fu">sudo</span> yum clean all</div>
<div class="sourceLine" id="cb342-23" data-line-number="23"><span class="kw">}</span></div>
<div class="sourceLine" id="cb342-24" data-line-number="24"></div>
<div class="sourceLine" id="cb342-25" data-line-number="25"><span class="kw">function</span><span class="fu"> download_etc</span> <span class="kw">{</span></div>
<div class="sourceLine" id="cb342-26" data-line-number="26">    <span class="kw">for</span> <span class="ex">url</span> in <span class="va">${ETCFILES}</span><span class="kw">;</span> <span class="kw">do</span></div>
<div class="sourceLine" id="cb342-27" data-line-number="27">    <span class="va">savefile=${ETCDIR}</span>/<span class="va">$(</span><span class="fu">basename</span> <span class="va">${url})</span></div>
<div class="sourceLine" id="cb342-28" data-line-number="28">    <span class="kw">if</span><span class="bu"> [</span> <span class="ot">!</span> <span class="ot">-e</span> <span class="va">${savefile}</span><span class="bu"> ]</span>; <span class="kw">then</span></div>
<div class="sourceLine" id="cb342-29" data-line-number="29">        <span class="fu">sudo</span> curl <span class="va">${url}</span> -o <span class="va">${savefile}</span></div>
<div class="sourceLine" id="cb342-30" data-line-number="30">    <span class="kw">fi</span></div>
<div class="sourceLine" id="cb342-31" data-line-number="31">    <span class="kw">done</span></div>
<div class="sourceLine" id="cb342-32" data-line-number="32"><span class="kw">}</span></div>
<div class="sourceLine" id="cb342-33" data-line-number="33"></div>
<div class="sourceLine" id="cb342-34" data-line-number="34"><span class="kw">function</span><span class="fu"> main</span> <span class="kw">{</span></div>
<div class="sourceLine" id="cb342-35" data-line-number="35">    <span class="va">SHAREDDIR=</span>/vagrant</div>
<div class="sourceLine" id="cb342-36" data-line-number="36">    <span class="va">DOWNLOADDIR=${SHAREDDIR}</span>/download</div>
<div class="sourceLine" id="cb342-37" data-line-number="37"></div>
<div class="sourceLine" id="cb342-38" data-line-number="38">    <span class="va">REPONAME=</span>localhost</div>
<div class="sourceLine" id="cb342-39" data-line-number="39">    <span class="va">YUMDIR=${DOWNLOADDIR}</span>/yum ; <span class="fu">sudo</span> mkdir -p <span class="va">${YUMDIR}</span></div>
<div class="sourceLine" id="cb342-40" data-line-number="40">    <span class="va">YUMPKGS=</span><span class="st">&quot;ansible git&quot;</span></div>
<div class="sourceLine" id="cb342-41" data-line-number="41"></div>
<div class="sourceLine" id="cb342-42" data-line-number="42">    <span class="va">ETCDIR=${DOWNLOADDIR}</span>/etc ; <span class="fu">sudo</span> mkdir -p <span class="va">${ETCDIR}</span></div>
<div class="sourceLine" id="cb342-43" data-line-number="43">    <span class="va">ETCFILES=</span><span class="st">&quot;</span></div>
<div class="sourceLine" id="cb342-44" data-line-number="44"><span class="st">http://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6</span></div>
<div class="sourceLine" id="cb342-45" data-line-number="45"><span class="st">http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</span></div>
<div class="sourceLine" id="cb342-46" data-line-number="46"><span class="st">&quot;</span></div>
<div class="sourceLine" id="cb342-47" data-line-number="47"></div>
<div class="sourceLine" id="cb342-48" data-line-number="48">    <span class="ex">download_etc</span></div>
<div class="sourceLine" id="cb342-49" data-line-number="49">    <span class="fu">sudo</span> rpm --import file://<span class="va">${ETCDIR}</span>/RPM-GPG-KEY-EPEL-6</div>
<div class="sourceLine" id="cb342-50" data-line-number="50">    <span class="fu">sudo</span> rpm -ihv file://<span class="va">${ETCDIR}</span>/epel-release-6-8.noarch.rpm</div>
<div class="sourceLine" id="cb342-51" data-line-number="51"></div>
<div class="sourceLine" id="cb342-52" data-line-number="52">    <span class="ex">download_yum</span></div>
<div class="sourceLine" id="cb342-53" data-line-number="53">    <span class="ex">mk_repofile</span></div>
<div class="sourceLine" id="cb342-54" data-line-number="54">    <span class="fu">sudo</span> yum install -y --disablerepo=* --enablerepo=<span class="va">${REPONAME}</span> <span class="va">${YUMPKGS}</span></div>
<div class="sourceLine" id="cb342-55" data-line-number="55"></div>
<div class="sourceLine" id="cb342-56" data-line-number="56"><span class="kw">}</span></div>
<div class="sourceLine" id="cb342-57" data-line-number="57"></div>
<div class="sourceLine" id="cb342-58" data-line-number="58"><span class="ex">main</span></div></code></pre>
</div>
<h1 id="chef">CHEF</h1>
<h2 id="misc">MISC</h2>
<h3 id="create-cookbok">CREATE cookbok</h3>
<pre class="sourceCode bash" id="cb343"><code class="sourceCode bash"><div class="sourceLine" id="cb343-1" data-line-number="1"><span class="ex">knife</span> cookbook create app -o site-cookbooks</div></code></pre>
<h1 id="virualbox">VirualBox</h1>
<h2 id="image-1">image</h2>
<h3 id="from-vmware">from vmware</h3>
<pre class="sourceCode bash" id="cb344"><code class="sourceCode bash"><div class="sourceLine" id="cb344-1" data-line-number="1"><span class="ex">VBoxManage</span> clonehd --format VDI cyua.vmdk cyua.vdi</div></code></pre>
<h1 id="vagrant">VAGRANT</h1>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-vagrant',data:{label:''
,VAG_BOX_FILE: './package.box'
,VAG_BOX_NAME: 'centos65-x86_64-20131205'
,VAG_VM_NAME: 'vm1'
,VAG_VM_IP: 'VAG_VM_IP'
,VAG_SSH_PORT: 'VAG_SSH_PORT=\'2205\''
}});})</script>
<div id="app-vagrant">
<form class="form-horizontal">
<varin label="BOX FILE"     v-model="VAG_BOX_FILE"></varin> <varin label="BOX NAME"     v-model="VAG_BOX_NAME"></varin> <varin label="VM NAME"      v-model="VAG_VM_NAME"></varin> <varin label="VM STATIC IP" v-model="VAG_VM_IP"></varin> <varin label="VM SSH PORT"  v-model="VAG_SSH_PORT"></varin>
</form>
<h2 id="box">BOX</h2>
<h3 id="add-2">ADD</h3>
<pre class="sourceCode bash" id="cb345"><code class="sourceCode bash"><div class="sourceLine" id="cb345-1" data-line-number="1"><span class="ex">vagrant</span> box add <span class="dt">{{VAG_BOX_NAME}}</span> <span class="dt">{{VAG_BOX_FILE}}</span></div>
<div class="sourceLine" id="cb345-2" data-line-number="2"><span class="ex">vagrant</span> box list</div></code></pre>
<h3 id="vms-status">VMs STATUS</h3>
<pre class="sourceCode bash" id="cb346"><code class="sourceCode bash"><div class="sourceLine" id="cb346-1" data-line-number="1"><span class="ex">vagrant</span> global-status</div></code></pre>
<h2 id="vagrantfile-1">Vagrantfile</h2>
<pre class="sourceCode ruby" id="cb347"><code class="sourceCode ruby"><div class="sourceLine" id="cb347-1" data-line-number="1"><span class="co"># -*- mode: ruby -*-</span></div>
<div class="sourceLine" id="cb347-2" data-line-number="2"><span class="co"># vi: set ft=ruby :</span></div>
<div class="sourceLine" id="cb347-3" data-line-number="3"></div>
<div class="sourceLine" id="cb347-4" data-line-number="4"><span class="dt">VAGRANTFILE_API_VERSION</span> = <span class="st">&quot;2&quot;</span></div>
<div class="sourceLine" id="cb347-5" data-line-number="5"></div>
<div class="sourceLine" id="cb347-6" data-line-number="6"><span class="dt">NUM_INSTANCES</span> = <span class="dv">2</span></div>
<div class="sourceLine" id="cb347-7" data-line-number="7"><span class="dt">BASE_IP_ADDR</span>  = <span class="dt">ENV</span>[<span class="st">&#39;BASE_IP_ADDR&#39;</span>] || <span class="st">&quot;192.168.100&quot;</span></div>
<div class="sourceLine" id="cb347-8" data-line-number="8"></div>
<div class="sourceLine" id="cb347-9" data-line-number="9"></div>
<div class="sourceLine" id="cb347-10" data-line-number="10"><span class="dt">Vagrant</span>.configure(<span class="dt">VAGRANTFILE_API_VERSION</span>) <span class="kw">do</span> |config|</div>
<div class="sourceLine" id="cb347-11" data-line-number="11"></div>
<div class="sourceLine" id="cb347-12" data-line-number="12">  config.vm.box = <span class="st">&quot;chef/centos-6.5&quot;</span></div>
<div class="sourceLine" id="cb347-13" data-line-number="13">  config.vm.synced_folder <span class="st">&quot;~/src/&quot;</span>, <span class="st">&quot;/vagrant/src&quot;</span></div>
<div class="sourceLine" id="cb347-14" data-line-number="14">  config.ssh.insert_key = <span class="dv">false</span></div>
<div class="sourceLine" id="cb347-15" data-line-number="15"></div>
<div class="sourceLine" id="cb347-16" data-line-number="16">  (<span class="dv">1</span>..<span class="dt">NUM_INSTANCES</span>).each <span class="kw">do</span> |i|</div>
<div class="sourceLine" id="cb347-17" data-line-number="17"></div>
<div class="sourceLine" id="cb347-18" data-line-number="18">    config.vm.define <span class="st">&quot;dummy-</span><span class="ot">#{</span>i<span class="ot">}</span><span class="st">&quot;</span> <span class="kw">do</span> |dummy|</div>
<div class="sourceLine" id="cb347-19" data-line-number="19">      dummy.vm.box_check_update = <span class="dv">false</span></div>
<div class="sourceLine" id="cb347-20" data-line-number="20">      dummy.vm.hostname = <span class="st">&quot;dummy-</span><span class="ot">#{</span>i<span class="ot">}</span><span class="st">&quot;</span></div>
<div class="sourceLine" id="cb347-21" data-line-number="21">      dummy.vm.network <span class="st">:private_network</span>, <span class="st">ip: &quot;</span><span class="ot">#{</span><span class="dt">BASE_IP_ADDR</span><span class="ot">}</span><span class="st">.</span><span class="ot">#{</span>i<span class="ot">}</span><span class="st">&quot;</span></div>
<div class="sourceLine" id="cb347-22" data-line-number="22">    <span class="kw">end</span></div>
<div class="sourceLine" id="cb347-23" data-line-number="23"></div>
<div class="sourceLine" id="cb347-24" data-line-number="24">    config.vm.provider <span class="st">&quot;virtualbox&quot;</span> <span class="kw">do</span> |vbox|</div>
<div class="sourceLine" id="cb347-25" data-line-number="25">      vbox.gui = <span class="dv">false</span></div>
<div class="sourceLine" id="cb347-26" data-line-number="26">      vbox.customize [<span class="st">&quot;modifyvm&quot;</span>, <span class="st">:id</span>, <span class="st">&quot;--memory&quot;</span>, <span class="st">&quot;1000&quot;</span>]</div>
<div class="sourceLine" id="cb347-27" data-line-number="27">      <span class="co"># centos 6.5 slow network fix</span></div>
<div class="sourceLine" id="cb347-28" data-line-number="28">      vbox.customize [<span class="st">&quot;modifyvm&quot;</span>, <span class="st">:id</span>, <span class="st">&quot;--natdnsproxy1&quot;</span>, <span class="st">&quot;on&quot;</span>]</div>
<div class="sourceLine" id="cb347-29" data-line-number="29">      vbox.customize [<span class="st">&quot;modifyvm&quot;</span>, <span class="st">:id</span>, <span class="st">&quot;--natdnshostresolver1&quot;</span>, <span class="st">&quot;on&quot;</span>]</div>
<div class="sourceLine" id="cb347-30" data-line-number="30">    <span class="kw">end</span></div>
<div class="sourceLine" id="cb347-31" data-line-number="31"></div>
<div class="sourceLine" id="cb347-32" data-line-number="32">  <span class="kw">end</span></div>
<div class="sourceLine" id="cb347-33" data-line-number="33"></div>
<div class="sourceLine" id="cb347-34" data-line-number="34"><span class="kw">end</span></div></code></pre>
<h2 id="ssh-3">ssh</h2>
<h3 id="ssh-config">ssh config</h3>
<pre class="sourceCode bash" id="cb348"><code class="sourceCode bash"><div class="sourceLine" id="cb348-1" data-line-number="1"><span class="ex">vagrant</span> up</div>
<div class="sourceLine" id="cb348-2" data-line-number="2"><span class="ex">vagrant</span> ssh-config vm1  <span class="op">&gt;&gt;</span> ~/.ssh/config</div>
<div class="sourceLine" id="cb348-3" data-line-number="3"><span class="ex">vagrant</span> ssh-config vm2 <span class="op">&gt;&gt;</span> ~/.ssh/config</div>
<div class="sourceLine" id="cb348-4" data-line-number="4"><span class="fu">cat</span> ~/.ssh/config</div></code></pre>
<h2 id="provision">provision</h2>
<h3 id="with-chef">with chef</h3>
<pre class="sourceCode bash" id="cb349"><code class="sourceCode bash"><div class="sourceLine" id="cb349-1" data-line-number="1"><span class="ex">vagrant</span> halt</div>
<div class="sourceLine" id="cb349-2" data-line-number="2"><span class="ex">vagrant</span> sandbox on</div>
<div class="sourceLine" id="cb349-3" data-line-number="3"><span class="ex">vagrant</span> up</div>
<div class="sourceLine" id="cb349-4" data-line-number="4"></div>
<div class="sourceLine" id="cb349-5" data-line-number="5"><span class="bu">echo</span> vm1 vm2 <span class="kw">|</span> <span class="fu">xargs</span> -n 1 knife solo prepare</div>
<div class="sourceLine" id="cb349-6" data-line-number="6"></div>
<div class="sourceLine" id="cb349-7" data-line-number="7"><span class="ex">vagrant</span> halt</div>
<div class="sourceLine" id="cb349-8" data-line-number="8"><span class="ex">vagrant</span> sandbox commit</div>
<div class="sourceLine" id="cb349-9" data-line-number="9"><span class="ex">vagrant</span> up</div>
<div class="sourceLine" id="cb349-10" data-line-number="10"></div>
<div class="sourceLine" id="cb349-11" data-line-number="11"><span class="bu">echo</span> vm1 vm2 <span class="kw">|</span> <span class="fu">xargs</span> -n 1 knife solo cook</div></code></pre>
<h2 id="plug-in">PLUG-IN</h2>
<h3 id="sandbox">sandbox</h3>
<h4 id="sandboxモード開始">sandboxモード開始</h4>
<pre class="sourceCode bash" id="cb350"><code class="sourceCode bash"><div class="sourceLine" id="cb350-1" data-line-number="1"><span class="ex">vagrant</span> sandbox on</div></code></pre>
<h4 id="変更を決定する">変更を決定する</h4>
<pre class="sourceCode bash" id="cb351"><code class="sourceCode bash"><div class="sourceLine" id="cb351-1" data-line-number="1"><span class="ex">vagrant</span> sandbox commit</div></code></pre>
<h4 id="変更を破棄しロールバックする">変更を破棄し、ロールバックする</h4>
<pre class="sourceCode bash" id="cb352"><code class="sourceCode bash"><div class="sourceLine" id="cb352-1" data-line-number="1"><span class="ex">vagrant</span> sandbox rollback</div></code></pre>
<h4 id="sandboxモード終了commitしていないものは破棄される">sandboxモード終了（commitしていないものは破棄される）</h4>
<pre class="sourceCode bash" id="cb353"><code class="sourceCode bash"><div class="sourceLine" id="cb353-1" data-line-number="1"><span class="ex">vagrant</span> sandbox off</div></code></pre>
<h4 id="現在sandboxモードかどうかの確認">現在sandboxモードかどうかの確認</h4>
<pre class="sourceCode bash" id="cb354"><code class="sourceCode bash"><div class="sourceLine" id="cb354-1" data-line-number="1"><span class="ex">vagrant</span> sandbox status</div></code></pre>
</div>
<h1 id="oracle">ORACLE</h1>
<h2 id="data-pump">DATA PUMP</h2>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-oradp',data:{label:''
,DP_SID: 'sid'
,DP_DMP: 'filename.dmp'
}});})</script>
<div id="app-oradp">
<form class="form-horizontal">
<varin label="SID"   v-model="DP_SID"></varin> <varin label="FILENAME"  v-model="DP_DMP"></varin>
</form>
<h3 id="export-1">EXPORT</h3>
<pre class="sourceCode bash" id="cb355"><code class="sourceCode bash"><div class="sourceLine" id="cb355-1" data-line-number="1"><span class="ex">expdp</span> \</div>
<div class="sourceLine" id="cb355-2" data-line-number="2">    system/manager@<span class="dt">{{DP_SID}}</span> \</div>
<div class="sourceLine" id="cb355-3" data-line-number="3">    dumpfile=<span class="dt">{{DP_DMP}}</span> \</div>
<div class="sourceLine" id="cb355-4" data-line-number="4">    full=Y \</div>
<div class="sourceLine" id="cb355-5" data-line-number="5">    content=metadata_only \</div>
<div class="sourceLine" id="cb355-6" data-line-number="6"></div>
<div class="sourceLine" id="cb355-7" data-line-number="7">    <span class="ex">SCHEMAS</span> \</div>
<div class="sourceLine" id="cb355-8" data-line-number="8">    TABLES \</div>
<div class="sourceLine" id="cb355-9" data-line-number="9">    STATUS=30 \</div>
<div class="sourceLine" id="cb355-10" data-line-number="10">    dumpfile=dir_punp:<span class="dt">{{DP_DMP}}</span> \</div></code></pre>
<p>DIR なければ、~oracle/admin/{{DP_SID}}/dpdump に落ちる</p>
<h3 id="import-1">IMPORT</h3>
<pre class="sourceCode bash" id="cb356"><code class="sourceCode bash"><div class="sourceLine" id="cb356-1" data-line-number="1"><span class="ex">impdp</span> \</div>
<div class="sourceLine" id="cb356-2" data-line-number="2">    system/manager@<span class="dt">{{DP_SID}}</span> \</div>
<div class="sourceLine" id="cb356-3" data-line-number="3">    dumpfile=<span class="dt">{{DP_SID}}</span> \</div>
<div class="sourceLine" id="cb356-4" data-line-number="4">    STATUS=30 \</div>
<div class="sourceLine" id="cb356-5" data-line-number="5">    table_exists_action=<span class="st">&#39;TRUNCATE&#39;</span> \</div>
<div class="sourceLine" id="cb356-6" data-line-number="6">    Parallel=2 \</div>
<div class="sourceLine" id="cb356-7" data-line-number="7">    INCLUDE=SCHEMA:<span class="st">&quot;KY,KX,REPADMIN,EQP,MNG&quot;</span></div>
<div class="sourceLine" id="cb356-8" data-line-number="8"></div>
<div class="sourceLine" id="cb356-9" data-line-number="9">    <span class="va">INCLUDE=</span>SCHEMA:<span class="st">&quot;=&#39;in(&#39;KY&#39;,&#39;KX&#39;,&#39;EQP&#39;,&#39;REPADMIN&#39;,&#39;MNG&#39;)&#39;&quot;</span></div>
<div class="sourceLine" id="cb356-10" data-line-number="10"></div>
<div class="sourceLine" id="cb356-11" data-line-number="11"></div>
<div class="sourceLine" id="cb356-12" data-line-number="12">    <span class="va">FULL=</span>N <span class="kw">\</span></div>
<div class="sourceLine" id="cb356-13" data-line-number="13"></div>
<div class="sourceLine" id="cb356-14" data-line-number="14">    <span class="va">sqlfile=</span>kx.sql <span class="kw">\</span></div>
<div class="sourceLine" id="cb356-15" data-line-number="15">    <span class="va">directory=</span>dir_punp <span class="kw">\</span></div>
<div class="sourceLine" id="cb356-16" data-line-number="16">    <span class="va">EXCLUDE=</span>SCHEMA:<span class="st">&quot;=&#39;HR&#39;&quot;</span></div></code></pre>
<h3 id="mkdir-1">MKDIR</h3>
<p>DIR なければ、${ORACLE_HOME}/rdbms/log を探す。</p>
<pre class="sourceCode sql" id="cb357"><code class="sourceCode sql"><div class="sourceLine" id="cb357-1" data-line-number="1"><span class="kw">create</span> <span class="kw">or</span> <span class="kw">replace</span> <span class="kw">directory</span> dir_punp <span class="kw">as</span> <span class="st">&#39;/usr1/oradba/pump&#39;</span>;</div>
<div class="sourceLine" id="cb357-2" data-line-number="2"><span class="co">-- grant read,write on directory dir_punp to ORAUSERNAME;</span></div>
<div class="sourceLine" id="cb357-3" data-line-number="3"><span class="co">-- commit;</span></div>
<div class="sourceLine" id="cb357-4" data-line-number="4"><span class="co">-- drop directory dir_punp</span></div></code></pre>
</div>
<h2 id="schema">SCHEMA</h2>
<pre class="sourceCode bash" id="cb358"><code class="sourceCode bash"><div class="sourceLine" id="cb358-1" data-line-number="1"><span class="ex">sqlplus</span> /nolog</div></code></pre>
<h3 id="select-all">select all</h3>
<pre class="sourceCode sql" id="cb359"><code class="sourceCode sql"><div class="sourceLine" id="cb359-1" data-line-number="1">conn system/manager@DBNAME <span class="kw">as</span> <span class="kw">sysdba</span></div>
<div class="sourceLine" id="cb359-2" data-line-number="2"><span class="co">--</span></div>
<div class="sourceLine" id="cb359-3" data-line-number="3"><span class="kw">select</span> username <span class="kw">from</span> dba_users;</div></code></pre>
<h3 id="not-defaults">NOT DEFAULTS</h3>
<p>たぶん</p>
<pre class="sourceCode sql" id="cb360"><code class="sourceCode sql"><div class="sourceLine" id="cb360-1" data-line-number="1">conn system/manager@DBNAME <span class="kw">as</span> <span class="kw">sysdba</span></div>
<div class="sourceLine" id="cb360-2" data-line-number="2"><span class="co">--</span></div>
<div class="sourceLine" id="cb360-3" data-line-number="3"><span class="kw">select</span> username <span class="kw">from</span> DBA_USERS</div>
<div class="sourceLine" id="cb360-4" data-line-number="4"><span class="kw">where</span></div>
<div class="sourceLine" id="cb360-5" data-line-number="5">    initial_rsrc_consumer_group != <span class="st">&#39;SYS_GROUP&#39;</span></div>
<div class="sourceLine" id="cb360-6" data-line-number="6"><span class="kw">and</span> default_tablespace <span class="kw">not</span> <span class="kw">like</span> <span class="st">&#39;SYS%&#39;</span></div>
<div class="sourceLine" id="cb360-7" data-line-number="7"><span class="kw">and</span> account_status = <span class="st">&#39;OPEN&#39;</span>;</div></code></pre>
<h2 id="names">NAMES</h2>
<h3 id="global-db">global db</h3>
<pre class="sourceCode sql" id="cb361"><code class="sourceCode sql"><div class="sourceLine" id="cb361-1" data-line-number="1"><span class="kw">select</span> * <span class="kw">from</span> <span class="kw">global_name</span>;</div></code></pre>
<h3 id="db">DB</h3>
<pre class="sourceCode sql" id="cb362"><code class="sourceCode sql"><div class="sourceLine" id="cb362-1" data-line-number="1"><span class="kw">select</span> <span class="fu">sys_context</span>(<span class="st">&#39;USERENV&#39;</span>,<span class="st">&#39;db_name&#39;</span>) <span class="kw">from</span> dual;</div></code></pre>
<h3 id="instance">instance</h3>
<pre class="sourceCode sql" id="cb363"><code class="sourceCode sql"><div class="sourceLine" id="cb363-1" data-line-number="1"><span class="kw">select</span> <span class="fu">sys_context</span>(<span class="st">&#39;USERENV&#39;</span>,<span class="st">&#39;instance_name&#39;</span>) <span class="kw">from</span> dual;</div></code></pre>
<h3 id="current-user">current user</h3>
<pre class="sourceCode sql" id="cb364"><code class="sourceCode sql"><div class="sourceLine" id="cb364-1" data-line-number="1"><span class="kw">select</span> <span class="fu">user</span> <span class="kw">from</span> dual;</div></code></pre>
<h2 id="proc">PROC</h2>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">PROC</th>
<th style="text-align: left;">NAME</th>
<th style="text-align: center;">WHAT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ora_j</td>
<td style="text-align: left;">?</td>
<td style="text-align: center;">ジョブ関連</td>
</tr>
<tr class="even">
<td style="text-align: left;">ora_smon</td>
<td style="text-align: left;">システムモニタ</td>
<td style="text-align: center;">インスタンス回復、デフラグ</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ora_dbw</td>
<td style="text-align: left;">?</td>
<td style="text-align: center;">バッファ・キャッシュからデータファイルへの書込み</td>
</tr>
<tr class="even">
<td style="text-align: left;">ora_lsm</td>
<td style="text-align: left;">?</td>
<td style="text-align: center;">?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ora_mmon</td>
<td style="text-align: left;">管理モニタ?</td>
<td style="text-align: center;">?</td>
</tr>
<tr class="even">
<td style="text-align: left;">ora_cjq</td>
<td style="text-align: left;">?</td>
<td style="text-align: center;">?</td>
</tr>
</tbody>
</table>
<h2 id="setting">SETTING</h2>
<h3 id="tnsnames.ora">TNSNAMES.ORA</h3>
<pre class="sourceCode bash" id="cb365"><code class="sourceCode bash"><div class="sourceLine" id="cb365-1" data-line-number="1"><span class="fu">cat</span> <span class="va">$ORACLE_HOME</span>/network/admin/tnsnames.ora</div></code></pre>
<h3 id="tnsnames.ora-listener.ora">TNSNAMES.ora, LISTENER.ora</h3>
<pre class="sourceCode bash" id="cb366"><code class="sourceCode bash"><div class="sourceLine" id="cb366-1" data-line-number="1"><span class="bu">cd</span> <span class="va">$ORACLE_HOME</span>/network/admin</div></code></pre>
<h3 id="stop-start-restart">STOP, START, RESTART</h3>
<pre class="sourceCode bash" id="cb367"><code class="sourceCode bash"><div class="sourceLine" id="cb367-1" data-line-number="1"><span class="ex">service</span> dbora stop</div>
<div class="sourceLine" id="cb367-2" data-line-number="2"><span class="ex">service</span> dbora start</div>
<div class="sourceLine" id="cb367-3" data-line-number="3"><span class="ex">service</span> dbora restart</div></code></pre>
<h2 id="sqlplus">SQLPLUS</h2>
<h3 id="exec-.sql">exec *.sql</h3>
<pre class="sourceCode bash" id="cb368"><code class="sourceCode bash"><div class="sourceLine" id="cb368-1" data-line-number="1"><span class="ex">sqlplus</span> <span class="op">&lt;</span>USER<span class="op">&gt;</span>/<span class="op">&lt;</span>PASS<span class="op">&gt;</span>@<span class="op">&lt;</span>TNSNAME<span class="op">&gt;</span> @<span class="op">&lt;</span>FILE<span class="op">&gt;</span></div></code></pre>
<pre class="sourceCode bash" id="cb369"><code class="sourceCode bash"><div class="sourceLine" id="cb369-1" data-line-number="1"><span class="ex">sqlplus</span> <span class="op">&lt;</span>USER<span class="op">&gt;</span>/<span class="op">&lt;</span>PASS<span class="op">&gt;</span>@<span class="op">&lt;</span>SID<span class="op">&gt;</span> @<span class="op">&lt;</span>FILE<span class="op">&gt;</span></div></code></pre>
<h3 id="csv">CSV</h3>
<pre class="sourceCode sql" id="cb370"><code class="sourceCode sql"><div class="sourceLine" id="cb370-1" data-line-number="1"><span class="kw">set</span> colsep <span class="st">&#39;,&#39;</span></div>
<div class="sourceLine" id="cb370-2" data-line-number="2"><span class="kw">set</span> pagesize <span class="dv">0</span></div>
<div class="sourceLine" id="cb370-3" data-line-number="3"><span class="kw">set</span> trimspool <span class="kw">off</span></div>
<div class="sourceLine" id="cb370-4" data-line-number="4"><span class="kw">set</span> headsep <span class="kw">off</span></div>
<div class="sourceLine" id="cb370-5" data-line-number="5"><span class="kw">set</span> linesize <span class="dv">32767</span></div>
<div class="sourceLine" id="cb370-6" data-line-number="6"><span class="kw">set</span> feedback <span class="kw">off</span></div>
<div class="sourceLine" id="cb370-7" data-line-number="7"><span class="co">-- set numw X</span></div></code></pre>
<h2 id="enterprise-manager">Enterprise Manager</h2>
<h3 id="updown-1">UP/DOWN</h3>
<pre class="sourceCode bash" id="cb371"><code class="sourceCode bash"><div class="sourceLine" id="cb371-1" data-line-number="1"><span class="ex">emctl</span> start dbconsole</div>
<div class="sourceLine" id="cb371-2" data-line-number="2"><span class="ex">emctl</span> stop dbconsole</div></code></pre>
<pre class="sourceCode bash" id="cb372"><code class="sourceCode bash"><div class="sourceLine" id="cb372-1" data-line-number="1"><span class="va">ORACLE_UNQNAME=</span>KX <span class="ex">emctl</span> start dbconsole</div></code></pre>
<h2 id="sql">SQL</h2>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-sql',data:{label:''
,ORA_TAB_NAME: 'TABNAME'
}});})</script>
<div id="app-sql">
<form class="form-horizontal">
<varin label="TAB NAME"     v-model="ORA_TAB_NAME"></varin>
</form>
<h3 id="insert">insert</h3>
<pre class="sourceCode sql" id="cb373"><code class="sourceCode sql"><div class="sourceLine" id="cb373-1" data-line-number="1"><span class="kw">insert</span> <span class="kw">into</span> {{ORA_TAB_NAME}} (&lt;COL1&gt; ,&lt;COL2&gt;) <span class="kw">values</span> (&lt;COL1VAL&gt;,&lt;COL2VAL&gt;);</div></code></pre>
<h3 id="update">update</h3>
<pre class="sourceCode sql" id="cb374"><code class="sourceCode sql"><div class="sourceLine" id="cb374-1" data-line-number="1"><span class="kw">update</span> {{ORA_TAB_NAME}} <span class="kw">set</span> &lt;COL1&gt;=<span class="st">&#39;AAA&#39;</span> , &lt;COL2&gt;=<span class="st">&#39;BBB&#39;</span> <span class="kw">where</span> &lt;COL3&gt;=<span class="st">&#39;ZZZ&#39;</span>;</div></code></pre>
<h3 id="prime">PRIME?</h3>
<pre class="sourceCode sql" id="cb375"><code class="sourceCode sql"><div class="sourceLine" id="cb375-1" data-line-number="1"><span class="kw">select</span> column_name <span class="kw">from</span> user_cons_columns</div>
<div class="sourceLine" id="cb375-2" data-line-number="2"><span class="kw">where</span> constraint_name = (</div>
<div class="sourceLine" id="cb375-3" data-line-number="3">      <span class="kw">select</span> constraint_name <span class="kw">from</span> user_constraints</div>
<div class="sourceLine" id="cb375-4" data-line-number="4">      <span class="kw">where</span> table_name = <span class="st">&#39;&quot; + {{ORA_TAB_NAME}} + &quot;&#39;</span> <span class="kw">and</span> constraint_type = <span class="st">&#39;P&#39;</span></div>
<div class="sourceLine" id="cb375-5" data-line-number="5">)</div></code></pre>
</div>
<h3 id="get-instance-name">get instance name</h3>
<pre class="sourceCode sql" id="cb376"><code class="sourceCode sql"><div class="sourceLine" id="cb376-1" data-line-number="1"><span class="kw">select</span> <span class="fu">sys_context</span>(<span class="st">&#39;USERENV&#39;</span>, <span class="st">&#39;instance_name&#39;</span>) <span class="kw">from</span> dual;</div></code></pre>
<h3 id="db-link">DB Link</h3>
<h4 id="connect-2">connect</h4>
<pre class="sourceCode bash" id="cb377"><code class="sourceCode bash"><div class="sourceLine" id="cb377-1" data-line-number="1"><span class="ex">sqlplus</span> sys/manager@<span class="op">&lt;</span>db<span class="op">&gt;</span> as sysdba</div></code></pre>
<h4 id="show-status">show status</h4>
<pre class="sourceCode sql" id="cb378"><code class="sourceCode sql"><div class="sourceLine" id="cb378-1" data-line-number="1"><span class="kw">set</span> linesize <span class="dv">100</span></div>
<div class="sourceLine" id="cb378-2" data-line-number="2">col OWNER    format a10</div>
<div class="sourceLine" id="cb378-3" data-line-number="3">col DB_LINK  format a20</div>
<div class="sourceLine" id="cb378-4" data-line-number="4">col USERNAME format a10</div>
<div class="sourceLine" id="cb378-5" data-line-number="5">col HOST     format a15</div>
<div class="sourceLine" id="cb378-6" data-line-number="6">col CREATED  format a20</div>
<div class="sourceLine" id="cb378-7" data-line-number="7">col <span class="kw">PASSWORD</span> format a20</div>
<div class="sourceLine" id="cb378-8" data-line-number="8"><span class="kw">select</span> * <span class="kw">from</span> dba_db_links;</div></code></pre>
<h4 id="create-3">create</h4>
<pre class="sourceCode sql" id="cb379"><code class="sourceCode sql"><div class="sourceLine" id="cb379-1" data-line-number="1"><span class="kw">CREATE</span> <span class="kw">PUBLIC</span> <span class="kw">DATABASE</span> <span class="kw">LINK</span> &lt;LINKNAME&gt;</div>
<div class="sourceLine" id="cb379-2" data-line-number="2"><span class="kw">connect</span> <span class="kw">to</span> &lt;USER&gt; <span class="kw">identified</span> <span class="kw">by</span> &lt;PASS&gt;</div>
<div class="sourceLine" id="cb379-3" data-line-number="3"><span class="kw">using</span> <span class="st">&#39;&lt;DB&gt;&#39;</span>;</div></code></pre>
<h3 id="get-object-source">get object source</h3>
<pre class="sourceCode sql" id="cb380"><code class="sourceCode sql"><div class="sourceLine" id="cb380-1" data-line-number="1"><span class="kw">select</span></div>
<div class="sourceLine" id="cb380-2" data-line-number="2">  dbms_metadata.get_ddl (</div>
<div class="sourceLine" id="cb380-3" data-line-number="3">     &lt;OBJECT_TYPE&gt;</div>
<div class="sourceLine" id="cb380-4" data-line-number="4">   , &lt;OBJECT_NAME&gt;</div>
<div class="sourceLine" id="cb380-5" data-line-number="5">   , &lt;OWNER&gt;</div>
<div class="sourceLine" id="cb380-6" data-line-number="6">  )</div>
<div class="sourceLine" id="cb380-7" data-line-number="7"><span class="kw">from</span></div>
<div class="sourceLine" id="cb380-8" data-line-number="8">  dual</div>
<div class="sourceLine" id="cb380-9" data-line-number="9">;</div>
<div class="sourceLine" id="cb380-10" data-line-number="10"></div>
<div class="sourceLine" id="cb380-11" data-line-number="11"><span class="co">-- database link</span></div>
<div class="sourceLine" id="cb380-12" data-line-number="12"><span class="kw">select</span></div>
<div class="sourceLine" id="cb380-13" data-line-number="13">  dbms_metadata.get_ddl (</div>
<div class="sourceLine" id="cb380-14" data-line-number="14">     <span class="st">&#39;db_link&#39;</span></div>
<div class="sourceLine" id="cb380-15" data-line-number="15">   , &lt;OBJECT_NAME&gt;</div>
<div class="sourceLine" id="cb380-16" data-line-number="16">   , <span class="st">&#39;public&#39;</span></div>
<div class="sourceLine" id="cb380-17" data-line-number="17">  )</div>
<div class="sourceLine" id="cb380-18" data-line-number="18"><span class="kw">from</span></div>
<div class="sourceLine" id="cb380-19" data-line-number="19">  dual</div>
<div class="sourceLine" id="cb380-20" data-line-number="20">;</div></code></pre>
<pre class="sourceCode sql" id="cb381"><code class="sourceCode sql"><div class="sourceLine" id="cb381-1" data-line-number="1"><span class="kw">CONNECT</span> sys/manager@DBNAME <span class="kw">AS</span> <span class="kw">SYSDBA</span></div>
<div class="sourceLine" id="cb381-2" data-line-number="2"><span class="kw">SET</span> ECHO <span class="kw">ON</span></div>
<div class="sourceLine" id="cb381-3" data-line-number="3"><span class="kw">SET</span> SERVEROUTPUT <span class="kw">ON</span></div>
<div class="sourceLine" id="cb381-4" data-line-number="4"><span class="kw">BEGIN</span></div>
<div class="sourceLine" id="cb381-5" data-line-number="5"><span class="kw">for</span> obj <span class="kw">in</span> (<span class="kw">select</span> <span class="kw">replace</span>(OBJECT_TYPE,<span class="st">&#39; &#39;</span>, <span class="st">&#39;_&#39;</span>) <span class="kw">as</span> OBJECT_TYPE, OBJECT_NAME, OWNER <span class="kw">from</span> dba_objects <span class="kw">where</span> OWNER=<span class="st">&#39;OWNNAME&#39;</span> <span class="kw">and</span> OBJECT_TYPE != <span class="st">&#39;DATABASE LINK&#39;</span>) <span class="kw">loop</span></div>
<div class="sourceLine" id="cb381-6" data-line-number="6">    DBMS_OUTPUT.PUT_LINE(<span class="st">&#39;{TYPE:&#39;</span> || obj.OBJECT_TYPE || <span class="st">&#39; ,NAME:&#39;</span> || obj.OBJECT_NAME || <span class="st">&#39;, OWNER:&#39;</span> || obj.OWNER || <span class="st">&#39;}&#39;</span>);</div>
<div class="sourceLine" id="cb381-7" data-line-number="7">    <span class="kw">for</span> rec <span class="kw">in</span> (<span class="kw">select</span> dbms_metadata.get_ddl(obj.OBJECT_TYPE, obj.OBJECT_NAME, obj.OWNER) <span class="kw">as</span> <span class="kw">ddl</span> <span class="kw">from</span> dual) <span class="kw">loop</span></div>
<div class="sourceLine" id="cb381-8" data-line-number="8">        DBMS_OUTPUT.PUT_LINE(rec.ddl);</div>
<div class="sourceLine" id="cb381-9" data-line-number="9">    <span class="kw">end</span> <span class="kw">loop</span>;</div>
<div class="sourceLine" id="cb381-10" data-line-number="10"><span class="kw">end</span> <span class="kw">loop</span>;</div>
<div class="sourceLine" id="cb381-11" data-line-number="11"><span class="kw">END</span>;</div>
<div class="sourceLine" id="cb381-12" data-line-number="12">/</div>
<div class="sourceLine" id="cb381-13" data-line-number="13">exit</div></code></pre>
<h2 id="multi-master-replication">MULTI MASTER REPLICATION</h2>
<script>window.addEventListener('load', function () {
new Vue({el:'#app-ora-mmr',data:{label:''
,ORA_REPSITE_A: 'AAA'
,ORA_REPSITE_B: 'BBB'
,ORA_REPTNSNAME: 'DB'
,ORA_REP_TABNAME: 'TABLENAME'
}});})</script>
<div id="app-ora-mmr">
<form class="form-horizontal">
<varin label="SITE A"  v-model="ORA_REPSITE_A"></varin> <varin label="SITE B"  v-model="ORA_REPSITE_B"></varin> <varin label="TNS"     v-model="ORA_REPTNSNAME"></varin> <varin label="TABLE"   v-model="ORA_REP_TABNAME"></varin>
</form>
<h3 id="sqlplus-1">SQLPLUS</h3>
<pre class="sourceCode bash" id="cb382"><code class="sourceCode bash"><div class="sourceLine" id="cb382-1" data-line-number="1"><span class="ex">sqlplus</span> /nolog</div></code></pre>
<h3 id="create-repadmin">CREATE REPADMIN</h3>
<h4 id="ora_repsite_a">{{ORA_REPSITE_A}}</h4>
<pre class="sourceCode sql" id="cb383"><code class="sourceCode sql"><div class="sourceLine" id="cb383-1" data-line-number="1">conn sys/manager@{{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}} <span class="kw">as</span> <span class="kw">sysdba</span></div>
<div class="sourceLine" id="cb383-2" data-line-number="2"></div>
<div class="sourceLine" id="cb383-3" data-line-number="3"><span class="kw">CREATE</span> <span class="fu">USER</span> repadmin <span class="kw">IDENTIFIED</span> <span class="kw">BY</span> repadmin;</div>
<div class="sourceLine" id="cb383-4" data-line-number="4"><span class="kw">GRANT</span> <span class="kw">COMMENT</span> <span class="kw">ANY</span> <span class="kw">TABLE</span> <span class="kw">TO</span> repadmin;</div>
<div class="sourceLine" id="cb383-5" data-line-number="5"><span class="kw">GRANT</span> <span class="kw">LOCK</span> <span class="kw">ANY</span> <span class="kw">TABLE</span> <span class="kw">TO</span> repadmin;</div>
<div class="sourceLine" id="cb383-6" data-line-number="6"><span class="kw">GRANT</span> <span class="kw">SELECT</span> <span class="kw">ANY</span> <span class="kw">DICTIONARY</span> <span class="kw">TO</span> repadmin;</div>
<div class="sourceLine" id="cb383-7" data-line-number="7"><span class="kw">GRANT</span> <span class="kw">EXECUTE</span> <span class="kw">ANY</span> <span class="kw">PROCEDURE</span> <span class="kw">TO</span> repadmin;</div>
<div class="sourceLine" id="cb383-8" data-line-number="8"><span class="kw">EXEC</span> Dbms_Repcat_Admin.Grant_Admin_Any_Repgroup(<span class="st">&#39;repadmin&#39;</span>);</div>
<div class="sourceLine" id="cb383-9" data-line-number="9"><span class="kw">EXEC</span> Dbms_Repcat_Admin.Grant_Admin_Any_Schema (username =&gt; <span class="st">&#39;repadmin&#39;</span>);</div>
<div class="sourceLine" id="cb383-10" data-line-number="10"></div>
<div class="sourceLine" id="cb383-11" data-line-number="11"><span class="co">-- プロパゲータ（送信者ロール）を登録</span></div>
<div class="sourceLine" id="cb383-12" data-line-number="12"><span class="kw">EXEC</span> DBMS_DEFER_SYS.REGISTER_PROPAGATOR(<span class="st">&#39;repadmin&#39;</span>);</div>
<div class="sourceLine" id="cb383-13" data-line-number="13"></div>
<div class="sourceLine" id="cb383-14" data-line-number="14"><span class="co">-- 受信者（ロール）を登録</span></div>
<div class="sourceLine" id="cb383-15" data-line-number="15"><span class="kw">BEGIN</span></div>
<div class="sourceLine" id="cb383-16" data-line-number="16">   DBMS_REPCAT_ADMIN.REGISTER_USER_REPGROUP (</div>
<div class="sourceLine" id="cb383-17" data-line-number="17">      username       =&gt; <span class="st">&#39;repadmin&#39;</span>,</div>
<div class="sourceLine" id="cb383-18" data-line-number="18">      privilege_type =&gt; <span class="st">&#39;receiver&#39;</span>,</div>
<div class="sourceLine" id="cb383-19" data-line-number="19">      list_of_gnames =&gt; <span class="kw">NULL</span>);</div>
<div class="sourceLine" id="cb383-20" data-line-number="20"><span class="kw">END</span>;</div>
<div class="sourceLine" id="cb383-21" data-line-number="21">/</div></code></pre>
<h4 id="ora_repsite_b">{{ORA_REPSITE_B}}</h4>
<pre class="sourceCode sql" id="cb384"><code class="sourceCode sql"><div class="sourceLine" id="cb384-1" data-line-number="1">conn sys/manager@{{ORA_REPSITE_B}}_{{ORA_REPTNSNAME}} <span class="kw">as</span> <span class="kw">sysdba</span></div>
<div class="sourceLine" id="cb384-2" data-line-number="2"></div>
<div class="sourceLine" id="cb384-3" data-line-number="3"><span class="co">--</span></div>
<div class="sourceLine" id="cb384-4" data-line-number="4"><span class="co">-- same {{ORA_REPSITE_A}}</span></div>
<div class="sourceLine" id="cb384-5" data-line-number="5"><span class="co">--</span></div></code></pre>
<h3 id="create-database-link">CREATE DATABASE LINK</h3>
<h4 id="ora_repsite_a-1">{{ORA_REPSITE_A}}</h4>
<pre class="sourceCode sql" id="cb385"><code class="sourceCode sql"><div class="sourceLine" id="cb385-1" data-line-number="1">conn sys/manager@{{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}} <span class="kw">as</span> <span class="kw">sysdba</span></div>
<div class="sourceLine" id="cb385-2" data-line-number="2"></div>
<div class="sourceLine" id="cb385-3" data-line-number="3"><span class="kw">CREATE</span> <span class="kw">PUBLIC</span> <span class="kw">DATABASE</span> <span class="kw">LINK</span> {{ORA_REPSITE_B}}_{{ORA_REPTNSNAME}} <span class="kw">USING</span> <span class="st">&#39;{{ORA_REPSITE_B}}_{{ORA_REPTNSNAME}}&#39;</span>;</div></code></pre>
<pre class="sourceCode sql" id="cb386"><code class="sourceCode sql"><div class="sourceLine" id="cb386-1" data-line-number="1">conn repadmin/repadmin@{{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}}</div>
<div class="sourceLine" id="cb386-2" data-line-number="2"></div>
<div class="sourceLine" id="cb386-3" data-line-number="3"><span class="kw">CREATE</span> <span class="kw">DATABASE</span> <span class="kw">LINK</span> {{ORA_REPSITE_B}}_{{ORA_REPTNSNAME}}</div>
<div class="sourceLine" id="cb386-4" data-line-number="4"><span class="kw">CONNECT</span> <span class="kw">TO</span> repadmin <span class="kw">IDENTIFIED</span> <span class="kw">BY</span> repadmin <span class="kw">using</span> <span class="st">&#39;{{ORA_REPSITE_B}}_{{ORA_REPTNSNAME}}&#39;</span>;</div></code></pre>
<h4 id="ora_repsite_b-1">{{ORA_REPSITE_B}}</h4>
<pre class="sourceCode sql" id="cb387"><code class="sourceCode sql"><div class="sourceLine" id="cb387-1" data-line-number="1">conn sys/manager@{{ORA_REPSITE_B}}_{{ORA_REPTNSNAME}} <span class="kw">as</span> <span class="kw">sysdba</span> <span class="kw">as</span> <span class="kw">sysdba</span></div>
<div class="sourceLine" id="cb387-2" data-line-number="2"></div>
<div class="sourceLine" id="cb387-3" data-line-number="3"><span class="kw">CREATE</span> <span class="kw">PUBLIC</span> <span class="kw">DATABASE</span> <span class="kw">LINK</span> {{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}} <span class="kw">USING</span> <span class="st">&#39;{{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}}&#39;</span>;</div></code></pre>
<pre class="sourceCode sql" id="cb388"><code class="sourceCode sql"><div class="sourceLine" id="cb388-1" data-line-number="1">conn repadmin/repadmin@{{ORA_REPSITE_B}}_{{ORA_REPTNSNAME}}</div>
<div class="sourceLine" id="cb388-2" data-line-number="2"></div>
<div class="sourceLine" id="cb388-3" data-line-number="3"><span class="kw">CREATE</span> <span class="kw">DATABASE</span> <span class="kw">LINK</span> {{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}}</div>
<div class="sourceLine" id="cb388-4" data-line-number="4"><span class="kw">CONNECT</span> <span class="kw">TO</span> repadmin <span class="kw">IDENTIFIED</span> <span class="kw">BY</span> repadmin <span class="kw">using</span> <span class="st">&#39;{{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}}&#39;</span>;</div></code></pre>
<h3 id="create-job">CREATE JOB</h3>
<h4 id="ora_repsite_a-2">{{ORA_REPSITE_A}}</h4>
<pre class="sourceCode sql" id="cb389"><code class="sourceCode sql"><div class="sourceLine" id="cb389-1" data-line-number="1">conn repadmin/repadmin@{{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}}</div>
<div class="sourceLine" id="cb389-2" data-line-number="2"></div>
<div class="sourceLine" id="cb389-3" data-line-number="3"><span class="kw">BEGIN</span></div>
<div class="sourceLine" id="cb389-4" data-line-number="4">   DBMS_DEFER_SYS.SCHEDULE_PURGE (</div>
<div class="sourceLine" id="cb389-5" data-line-number="5">      next_date =&gt; <span class="fu">SYSDATE</span> + (<span class="dv">1</span>/<span class="dv">24</span>),</div>
<div class="sourceLine" id="cb389-6" data-line-number="6">      <span class="dt">interval</span> =&gt; <span class="st">&#39;SYSDATE + (1/24)&#39;</span>,</div>
<div class="sourceLine" id="cb389-7" data-line-number="7">      delay_seconds =&gt; <span class="dv">0</span>,</div>
<div class="sourceLine" id="cb389-8" data-line-number="8">      rollback_segment =&gt; <span class="st">&#39;&#39;</span></div>
<div class="sourceLine" id="cb389-9" data-line-number="9">   );</div>
<div class="sourceLine" id="cb389-10" data-line-number="10"><span class="kw">END</span>;</div>
<div class="sourceLine" id="cb389-11" data-line-number="11">/</div>
<div class="sourceLine" id="cb389-12" data-line-number="12"><span class="co">-- 1/24 = １時間</span></div>
<div class="sourceLine" id="cb389-13" data-line-number="13"></div>
<div class="sourceLine" id="cb389-14" data-line-number="14"><span class="kw">BEGIN</span></div>
<div class="sourceLine" id="cb389-15" data-line-number="15">   DBMS_DEFER_SYS.SCHEDULE_PUSH(</div>
<div class="sourceLine" id="cb389-16" data-line-number="16">      destination =&gt; <span class="st">&#39;{{ORA_REPSITE_B}}_{{ORA_REPTNSNAME}}.WORLD&#39;</span>,</div>
<div class="sourceLine" id="cb389-17" data-line-number="17">      next_date =&gt; <span class="fu">SYSDATE</span> + (<span class="dv">1</span>/<span class="dv">8640</span>),</div>
<div class="sourceLine" id="cb389-18" data-line-number="18">      <span class="dt">interval</span>  =&gt; <span class="st">&#39;SYSDATE + (1/8640)&#39;</span>,</div>
<div class="sourceLine" id="cb389-19" data-line-number="19">      parallelism =&gt; <span class="dv">1</span>,</div>
<div class="sourceLine" id="cb389-20" data-line-number="20">      delay_seconds =&gt; <span class="dv">0</span></div>
<div class="sourceLine" id="cb389-21" data-line-number="21">   );</div>
<div class="sourceLine" id="cb389-22" data-line-number="22"><span class="kw">END</span>;</div>
<div class="sourceLine" id="cb389-23" data-line-number="23">/</div>
<div class="sourceLine" id="cb389-24" data-line-number="24"><span class="co">-- 1/8640 = 10sec</span></div></code></pre>
<h4 id="ora_repsite_b-2">{{ORA_REPSITE_B}}</h4>
<pre class="sourceCode sql" id="cb390"><code class="sourceCode sql"><div class="sourceLine" id="cb390-1" data-line-number="1">conn repadmin/repadmin@{{ORA_REPSITE_B}}_{{ORA_REPTNSNAME}}</div>
<div class="sourceLine" id="cb390-2" data-line-number="2"></div>
<div class="sourceLine" id="cb390-3" data-line-number="3"><span class="kw">BEGIN</span></div>
<div class="sourceLine" id="cb390-4" data-line-number="4">   DBMS_DEFER_SYS.SCHEDULE_PURGE (</div>
<div class="sourceLine" id="cb390-5" data-line-number="5">      next_date =&gt; <span class="fu">SYSDATE</span> + (<span class="dv">1</span>/<span class="dv">24</span>),</div>
<div class="sourceLine" id="cb390-6" data-line-number="6">      <span class="dt">interval</span> =&gt; <span class="st">&#39;SYSDATE + (1/24)&#39;</span>,</div>
<div class="sourceLine" id="cb390-7" data-line-number="7">      delay_seconds =&gt; <span class="dv">0</span>,</div>
<div class="sourceLine" id="cb390-8" data-line-number="8">      rollback_segment =&gt; <span class="st">&#39;&#39;</span></div>
<div class="sourceLine" id="cb390-9" data-line-number="9">   );</div>
<div class="sourceLine" id="cb390-10" data-line-number="10"><span class="kw">END</span>;</div>
<div class="sourceLine" id="cb390-11" data-line-number="11">/</div>
<div class="sourceLine" id="cb390-12" data-line-number="12"><span class="co">-- 1/24 = １時間</span></div>
<div class="sourceLine" id="cb390-13" data-line-number="13"></div>
<div class="sourceLine" id="cb390-14" data-line-number="14"><span class="kw">BEGIN</span></div>
<div class="sourceLine" id="cb390-15" data-line-number="15">   DBMS_DEFER_SYS.SCHEDULE_PUSH(</div>
<div class="sourceLine" id="cb390-16" data-line-number="16">      destination =&gt; <span class="st">&#39;{{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}}.WORLD&#39;</span>,</div>
<div class="sourceLine" id="cb390-17" data-line-number="17">      next_date =&gt; <span class="fu">SYSDATE</span> + (<span class="dv">1</span>/<span class="dv">8640</span>),</div>
<div class="sourceLine" id="cb390-18" data-line-number="18">      <span class="dt">interval</span>  =&gt; <span class="st">&#39;SYSDATE + (1/8640)&#39;</span>,</div>
<div class="sourceLine" id="cb390-19" data-line-number="19">      parallelism =&gt; <span class="dv">1</span>,</div>
<div class="sourceLine" id="cb390-20" data-line-number="20">      delay_seconds =&gt; <span class="dv">0</span></div>
<div class="sourceLine" id="cb390-21" data-line-number="21">   );</div>
<div class="sourceLine" id="cb390-22" data-line-number="22"><span class="kw">END</span>;</div>
<div class="sourceLine" id="cb390-23" data-line-number="23">/</div>
<div class="sourceLine" id="cb390-24" data-line-number="24"><span class="co">-- 1/8640 = 10sec</span></div></code></pre>
<h4 id="check-1">Check</h4>
<pre class="sourceCode sql" id="cb391"><code class="sourceCode sql"><div class="sourceLine" id="cb391-1" data-line-number="1"><span class="co">-- conn repadmin/repadmin@{{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}}</span></div>
<div class="sourceLine" id="cb391-2" data-line-number="2"></div>
<div class="sourceLine" id="cb391-3" data-line-number="3"><span class="kw">set</span> linesize <span class="dv">150</span></div>
<div class="sourceLine" id="cb391-4" data-line-number="4">col job    format <span class="st">&#39;00000&#39;</span></div>
<div class="sourceLine" id="cb391-5" data-line-number="5">col what  format a65</div>
<div class="sourceLine" id="cb391-6" data-line-number="6">col SCHEMA_USER format a10</div>
<div class="sourceLine" id="cb391-7" data-line-number="7">col LAST_DATE format a10</div>
<div class="sourceLine" id="cb391-8" data-line-number="8">col THIS_DATE format a10</div>
<div class="sourceLine" id="cb391-9" data-line-number="9">col NEXT_DATE format a10</div>
<div class="sourceLine" id="cb391-10" data-line-number="10">col <span class="dt">INTERVAL</span> format a10</div>
<div class="sourceLine" id="cb391-11" data-line-number="11"><span class="kw">select</span> job,BROKEN,SCHEMA_USER,LAST_DATE,THIS_DATE,NEXT_DATE,</div>
<div class="sourceLine" id="cb391-12" data-line-number="12"> <span class="dt">INTERVAL</span>, what <span class="kw">from</span> user_jobs;</div></code></pre>
<h3 id="create-replication-group">CREATE REPLICATION GROUP</h3>
<h4 id="ora_repsite_a-only">{{ORA_REPSITE_A}} ONLY!</h4>
<pre class="sourceCode sql" id="cb392"><code class="sourceCode sql"><div class="sourceLine" id="cb392-1" data-line-number="1">conn repadmin/repadmin@{{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}}</div>
<div class="sourceLine" id="cb392-2" data-line-number="2"></div>
<div class="sourceLine" id="cb392-3" data-line-number="3"><span class="kw">EXEC</span> DBMS_REPCAT.CREATE_MASTER_REPGROUP(<span class="st">&#39;{{ORA_REPTNSNAME}}_REPG&#39;</span>);</div>
<div class="sourceLine" id="cb392-4" data-line-number="4"></div>
<div class="sourceLine" id="cb392-5" data-line-number="5"><span class="kw">BEGIN</span></div>
<div class="sourceLine" id="cb392-6" data-line-number="6">   DBMS_REPCAT.ADD_MASTER_DATABASE (</div>
<div class="sourceLine" id="cb392-7" data-line-number="7">      gname     =&gt; <span class="st">&#39;{{ORA_REPTNSNAME}}_REPG&#39;</span>,</div>
<div class="sourceLine" id="cb392-8" data-line-number="8">      <span class="kw">master</span>    =&gt; <span class="st">&#39;{{ORA_REPSITE_B}}_{{ORA_REPTNSNAME}}&#39;</span>,</div>
<div class="sourceLine" id="cb392-9" data-line-number="9">      use_existing_objects =&gt; <span class="kw">TRUE</span>,</div>
<div class="sourceLine" id="cb392-10" data-line-number="10">      copy_rows =&gt; <span class="kw">FALSE</span>,</div>
<div class="sourceLine" id="cb392-11" data-line-number="11">      propagation_mode =&gt; <span class="st">&#39;ASYNCHRONOUS&#39;</span></div>
<div class="sourceLine" id="cb392-12" data-line-number="12">   );</div>
<div class="sourceLine" id="cb392-13" data-line-number="13"><span class="kw">END</span>;</div>
<div class="sourceLine" id="cb392-14" data-line-number="14">/</div></code></pre>
<h3 id="add-object">ADD OBJECT</h3>
<h4 id="ora_repsite_a-only-1">{{ORA_REPSITE_A}} ONLY!</h4>
<pre class="sourceCode sql" id="cb393"><code class="sourceCode sql"><div class="sourceLine" id="cb393-1" data-line-number="1">conn repadmin/repadmin@{{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}}</div>
<div class="sourceLine" id="cb393-2" data-line-number="2"></div>
<div class="sourceLine" id="cb393-3" data-line-number="3"><span class="kw">begin</span> DBMS_REPCAT.CREATE_MASTER_REPOBJECT (</div>
<div class="sourceLine" id="cb393-4" data-line-number="4">  gname =&gt; <span class="st">&#39;{{ORA_REPTNSNAME}}_REPG&#39;</span></div>
<div class="sourceLine" id="cb393-5" data-line-number="5">, <span class="kw">type</span> =&gt; <span class="st">&#39;TABLE&#39;</span></div>
<div class="sourceLine" id="cb393-6" data-line-number="6">, oname =&gt; <span class="st">&#39;{{ORA_REP_TABNAME}}&#39;</span></div>
<div class="sourceLine" id="cb393-7" data-line-number="7">, sname =&gt; <span class="st">&#39;{{ORA_REPTNSNAME}}&#39;</span></div>
<div class="sourceLine" id="cb393-8" data-line-number="8">, use_existing_object =&gt; <span class="kw">TRUE</span>  <span class="co">-- 既存のオブジェクトを使用</span></div>
<div class="sourceLine" id="cb393-9" data-line-number="9">, copy_rows =&gt; <span class="kw">FALSE</span>           <span class="co">-- データのコピー</span></div>
<div class="sourceLine" id="cb393-10" data-line-number="10">);</div>
<div class="sourceLine" id="cb393-11" data-line-number="11"><span class="kw">end</span>;</div>
<div class="sourceLine" id="cb393-12" data-line-number="12">/</div>
<div class="sourceLine" id="cb393-13" data-line-number="13"></div>
<div class="sourceLine" id="cb393-14" data-line-number="14"><span class="co">--（対象テーブル全部を登録する）</span></div></code></pre>
<h3 id="generate-replication-support">GENERATE REPLICATION SUPPORT</h3>
<h4 id="ora_repsite_a-only-2">{{ORA_REPSITE_A}} ONLY!</h4>
<pre class="sourceCode sql" id="cb394"><code class="sourceCode sql"><div class="sourceLine" id="cb394-1" data-line-number="1">conn repadmin/repadmin@{{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}}</div>
<div class="sourceLine" id="cb394-2" data-line-number="2"></div>
<div class="sourceLine" id="cb394-3" data-line-number="3"><span class="kw">begin</span> DBMS_REPCAT.GENERATE_REPLICATION_SUPPORT (</div>
<div class="sourceLine" id="cb394-4" data-line-number="4">  sname =&gt; <span class="st">&#39;{{ORA_REPTNSNAME}}&#39;</span></div>
<div class="sourceLine" id="cb394-5" data-line-number="5">, oname =&gt; <span class="st">&#39;{{ORA_REP_TABNAME}}&#39;</span></div>
<div class="sourceLine" id="cb394-6" data-line-number="6">, <span class="kw">type</span> =&gt; <span class="st">&#39;TABLE&#39;</span></div>
<div class="sourceLine" id="cb394-7" data-line-number="7">, min_communication =&gt; <span class="kw">TRUE</span>);</div>
<div class="sourceLine" id="cb394-8" data-line-number="8"><span class="kw">end</span>;</div>
<div class="sourceLine" id="cb394-9" data-line-number="9">/</div></code></pre>
<h3 id="start-replication">START REPLICATION</h3>
<h4 id="ora_repsite_a-only-3">{{ORA_REPSITE_A}} ONLY!</h4>
<pre class="sourceCode sql" id="cb395"><code class="sourceCode sql"><div class="sourceLine" id="cb395-1" data-line-number="1">conn repadmin/repadmin@{{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}}</div>
<div class="sourceLine" id="cb395-2" data-line-number="2"></div>
<div class="sourceLine" id="cb395-3" data-line-number="3"><span class="kw">exec</span> dbms_repcat.resume_master_activity(gname =&gt; <span class="st">&#39;{{ORA_REPTNSNAME}}_REPG&#39;</span>);</div></code></pre>
<h3 id="stop-replication">STOP REPLICATION</h3>
<h4 id="ora_repsite_a-only-4">{{ORA_REPSITE_A}} ONLY!</h4>
<pre class="sourceCode sql" id="cb396"><code class="sourceCode sql"><div class="sourceLine" id="cb396-1" data-line-number="1">conn repadmin/repadmin@{{ORA_REPSITE_A}}_{{ORA_REPTNSNAME}}</div>
<div class="sourceLine" id="cb396-2" data-line-number="2"></div>
<div class="sourceLine" id="cb396-3" data-line-number="3"><span class="kw">exec</span> dbms_repcat.suspend_master_activity(gname=&gt;<span class="st">&#39;{{ORA_REPTNSNAME}}_REPG&#39;</span>);</div></code></pre>
</div>
<script src="asset/vue.min.js"></script>
<script src="js/memo.js"></script>
<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
</body>
</html>
